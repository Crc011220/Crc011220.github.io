"use strict";(self.webpackChunkpersonalweb=self.webpackChunkpersonalweb||[]).push([[8775],{66262:(i,s)=>{s.A=(i,s)=>{const t=i.__vccOpts||i;for(const[i,n]of s)t[i]=n;return t}},77624:(i,s,t)=>{t.r(s),t.d(s,{comp:()=>e,data:()=>l});var n=t(20641);const a={},e=(0,t(66262).A)(a,[["render",function(i,s){return(0,n.uX)(),(0,n.CE)("div",null,s[0]||(s[0]=[(0,n.Fv)('<h1 id="jvm-调优" tabindex="-1"><a class="header-anchor" href="#jvm-调优"><span>JVM 调优</span></a></h1><h2 id="一、调优目标-先明确再动手" tabindex="-1"><a class="header-anchor" href="#一、调优目标-先明确再动手"><span>一、调优目标（先明确再动手）</span></a></h2><ul><li><strong>吞吐量型</strong>：批处理、离线任务，追求单位时间内完成任务数量</li><li><strong>低延迟型</strong>：Web 服务、API、交易系统，追求 GC 停顿时间短</li><li><strong>内存受限型</strong>：容器、云环境，堆大小受限，需避免 OOM</li></ul><h2 id="二、常用-jvm-参数-以-jdk-8-为例" tabindex="-1"><a class="header-anchor" href="#二、常用-jvm-参数-以-jdk-8-为例"><span>二、常用 JVM 参数（以 JDK 8 为例）</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 堆内存</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-Xms4g</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -Xmx4g</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                      # 初始堆=最大堆，避免运行时扩容</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-Xmn2g</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                              # 年轻代，一般约为堆的 1/3～1/2</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># GC 选择</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-XX:+UseG1GC</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">                       # G1 适合大多数企业场景</span></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 或 -XX:+UseZGC（JDK15+，超低延迟）</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># GC 日志（JDK 9+）</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-Xlog:gc*:file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=gc.log:time,uptime:filecount=5,filesize=100m</span></span>\n<span class="line"></span>\n<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># OOM 时 dump</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">-XX:+HeapDumpOnOutOfMemoryError</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -XX:HeapDumpPath=/path/to/dumps/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="三、常见问题与诊断思路" tabindex="-1"><a class="header-anchor" href="#三、常见问题与诊断思路"><span>三、常见问题与诊断思路</span></a></h2><table><thead><tr><th>现象</th><th>可能原因</th><th>调整方向</th></tr></thead><tbody><tr><td>Full GC 频繁</td><td>老年代空间不足、元空间膨胀</td><td>增大堆/老年代、检查元空间、排查大对象泄漏</td></tr><tr><td>Young GC 频繁</td><td>年轻代过小、晋升过快</td><td>增大 -Xmn、调整晋升年龄</td></tr><tr><td>GC 停顿时间长</td><td>堆过大、STW 时间长</td><td>考虑 ZGC/Shenandoah，或缩小堆、优化对象分配</td></tr><tr><td>OOM</td><td>内存泄漏或堆太小</td><td>分析 dump、排查泄漏、适当增大堆</td></tr></tbody></table><h2 id="四、企业实践经验" tabindex="-1"><a class="header-anchor" href="#四、企业实践经验"><span>四、企业实践经验</span></a></h2><ol><li><strong>-Xms 与 -Xmx 设成相同</strong>：避免运行期堆动态扩容，减少 GC 抖动</li><li><strong>生产环境务必开启 GC 日志</strong>：至少保留数天，便于事后排查</li><li><strong>容器环境</strong>：使用 <code>-XX:+UseContainerSupport</code> 和 <code>-XX:MaxRAMPercentage</code>，让 JVM 感知容器限制</li><li><strong>压测 + 监控</strong>：用 JMeter 等压测，结合 Prometheus + Grafana 观察 GC、CPU、内存曲线</li><li><strong>先看 GC 日志再调参</strong>：根据 GC 频率、停顿、晋升情况决定是否调 -Xmn、Survivor 等</li><li><strong>OOM 必做 HeapDump 分析</strong>：用 MAT、VisualVM 等分析 dump，定位大对象和引用链</li></ol><h2 id="五、不同-jdk-版本的-gc-选型" tabindex="-1"><a class="header-anchor" href="#五、不同-jdk-版本的-gc-选型"><span>五、不同 JDK 版本的 GC 选型</span></a></h2><ul><li><strong>JDK 8</strong>：<strong>G1GC</strong> 为主流，兼顾吞吐和停顿，适合多数 Web 服务</li><li><strong>JDK 11+</strong>：G1 更成熟，可开始尝试 <strong>ZGC</strong> 追求超低延迟</li><li><strong>JDK 17+</strong>：<strong>ZGC</strong>、<strong>Shenandoah</strong> 可用于生产，追求亚毫秒级停顿</li></ul>',11)]))}]]),l=JSON.parse('{"path":"/zh/posts/cmb/jvm.html","title":"JVM 调优","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2026-02-07T00:00:00.000Z","category":["Job Notes"],"tag":["China Merchant Bank"],"description":"JVM 调优 一、调优目标（先明确再动手） 吞吐量型：批处理、离线任务，追求单位时间内完成任务数量 低延迟型：Web 服务、API、交易系统，追求 GC 停顿时间短 内存受限型：容器、云环境，堆大小受限，需避免 OOM 二、常用 JVM 参数（以 JDK 8 为例） 三、常见问题与诊断思路 四、企业实践经验 -Xms 与 -Xmx 设成相同：避免运行期...","head":[["meta",{"property":"og:url","content":"https://crc011220.github.io/zh/posts/cmb/jvm.html"}],["meta",{"property":"og:site_name","content":"Ruochen Chen"}],["meta",{"property":"og:title","content":"JVM 调优"}],["meta",{"property":"og:description","content":"JVM 调优 一、调优目标（先明确再动手） 吞吐量型：批处理、离线任务，追求单位时间内完成任务数量 低延迟型：Web 服务、API、交易系统，追求 GC 停顿时间短 内存受限型：容器、云环境，堆大小受限，需避免 OOM 二、常用 JVM 参数（以 JDK 8 为例） 三、常见问题与诊断思路 四、企业实践经验 -Xms 与 -Xmx 设成相同：避免运行期..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-07T03:16:22.000Z"}],["meta",{"property":"article:tag","content":"China Merchant Bank"}],["meta",{"property":"article:published_time","content":"2026-02-07T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-07T03:16:22.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"JVM 调优\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2026-02-07T00:00:00.000Z\\",\\"dateModified\\":\\"2026-02-07T03:16:22.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Ruochen Chen\\"}]}"]]},"headers":[{"level":2,"title":"一、调优目标（先明确再动手）","slug":"一、调优目标-先明确再动手","link":"#一、调优目标-先明确再动手","children":[]},{"level":2,"title":"二、常用 JVM 参数（以 JDK 8 为例）","slug":"二、常用-jvm-参数-以-jdk-8-为例","link":"#二、常用-jvm-参数-以-jdk-8-为例","children":[]},{"level":2,"title":"三、常见问题与诊断思路","slug":"三、常见问题与诊断思路","link":"#三、常见问题与诊断思路","children":[]},{"level":2,"title":"四、企业实践经验","slug":"四、企业实践经验","link":"#四、企业实践经验","children":[]},{"level":2,"title":"五、不同 JDK 版本的 GC 选型","slug":"五、不同-jdk-版本的-gc-选型","link":"#五、不同-jdk-版本的-gc-选型","children":[]}],"git":{"createdTime":1770434182000,"updatedTime":1770434182000,"contributors":[{"name":"Ruochen Chen","email":"ruocchen1220@gmail.com","commits":1}]},"readingTime":{"minutes":1.72,"words":516},"filePathRelative":"zh/posts/cmb/jvm.md","localizedDate":"2026年2月7日","excerpt":"\\n<h2>一、调优目标（先明确再动手）</h2>\\n<ul>\\n<li><strong>吞吐量型</strong>：批处理、离线任务，追求单位时间内完成任务数量</li>\\n<li><strong>低延迟型</strong>：Web 服务、API、交易系统，追求 GC 停顿时间短</li>\\n<li><strong>内存受限型</strong>：容器、云环境，堆大小受限，需避免 OOM</li>\\n</ul>\\n<h2>二、常用 JVM 参数（以 JDK 8 为例）</h2>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 堆内存</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">-Xms4g</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -Xmx4g</span><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                      # 初始堆=最大堆，避免运行时扩容</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">-Xmn2g</span><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                              # 年轻代，一般约为堆的 1/3～1/2</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># GC 选择</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">-XX:+UseG1GC</span><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\">                       # G1 适合大多数企业场景</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># 或 -XX:+UseZGC（JDK15+，超低延迟）</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># GC 日志（JDK 9+）</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">-Xlog:gc*:file</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\">=gc.log:time,uptime:filecount=5,filesize=100m</span></span>\\n<span class=\\"line\\"></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic\\"># OOM 时 dump</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">-XX:+HeapDumpOnOutOfMemoryError</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -XX:HeapDumpPath=/path/to/dumps/</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}')}}]);