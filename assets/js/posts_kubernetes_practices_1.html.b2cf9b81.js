"use strict";(self.webpackChunkpersonalweb=self.webpackChunkpersonalweb||[]).push([[4365],{2423:(e,s,t)=>{t.r(s),t.d(s,{comp:()=>o,data:()=>r});var n=t(641);const i=t.p+"assets/img/kubeClusterConfig.119ee3d2.png",a={},o=(0,t(6262).A)(a,[["render",function(e,s){return(0,n.uX)(),(0,n.CE)("div",null,s[0]||(s[0]=[(0,n.Fv)('<h1 id="setting-up-k3s-cluster-on-centos-9" tabindex="-1"><a class="header-anchor" href="#setting-up-k3s-cluster-on-centos-9"><span>Setting up K3s Cluster on CentOS 9</span></a></h1><h3 id="download-mirror-iso-file-on-https-www-centos-org-download-and-use-vmware-fusion-to-set-up-3-different-centos-9" tabindex="-1"><a class="header-anchor" href="#download-mirror-iso-file-on-https-www-centos-org-download-and-use-vmware-fusion-to-set-up-3-different-centos-9"><span>Download mirror iso file on &#39;https://www.centos.org/download/&#39;, and use VMWare Fusion to set up 3 different CentOS 9.</span></a></h3><h4 id="this-guide-will-walk-you-through-setting-up-a-k3s-cluster-with-1-master-node-and-2-worker-nodes-on-centos-9-the-master-node-s-ip-is-172-16-217-137-worker-nodes-ips-are-172-16-217-138-and-172-16-217-139" tabindex="-1"><a class="header-anchor" href="#this-guide-will-walk-you-through-setting-up-a-k3s-cluster-with-1-master-node-and-2-worker-nodes-on-centos-9-the-master-node-s-ip-is-172-16-217-137-worker-nodes-ips-are-172-16-217-138-and-172-16-217-139"><span>This guide will walk you through setting up a K3s cluster with 1 master node and 2 worker nodes on CentOS 9. The master node&#39;s IP is <code>172.16.217.137</code>, worker nodes&#39; IPs are <code>172.16.217.138</code> and <code>172.16.217.139</code>.</span></a></h4><h2 id="key-kubernetes-components" tabindex="-1"><a class="header-anchor" href="#key-kubernetes-components"><span>Key Kubernetes Components</span></a></h2><h3 id="_1-kubeadm-cluster-initialization-tool" tabindex="-1"><a class="header-anchor" href="#_1-kubeadm-cluster-initialization-tool"><span>1. <code>kubeadm</code> - Cluster Initialization Tool</span></a></h3><ul><li><strong>Purpose</strong>: <code>kubeadm</code> is designed for setting up and configuring a Kubernetes cluster. It helps users quickly establish a standardized Kubernetes environment.</li><li><strong>Functions</strong>: <ul><li>Initializes the main cluster components, such as the API server, scheduler, and controllers.</li><li>Generates configuration files and certificates, enabling secure communication within the cluster.</li><li>Configures network plugins for inter-Pod communication.</li><li>Manages node addition and removal within the cluster.</li></ul></li><li><strong>Use Case</strong>: <code>kubeadm</code> is ideal for initializing and joining multiple nodes to create a production or development Kubernetes cluster.</li></ul><h3 id="_2-kubectl-cluster-management-tool" tabindex="-1"><a class="header-anchor" href="#_2-kubectl-cluster-management-tool"><span>2. <code>kubectl</code> - Cluster Management Tool</span></a></h3><ul><li><strong>Purpose</strong>: <code>kubectl</code> is the command-line tool for interacting with Kubernetes, allowing users to manage and operate cluster resources.</li><li><strong>Functions</strong>: <ul><li>Manages Kubernetes resources, including creating, updating, and deleting Pods, Services, Deployments, and more.</li><li>Provides real-time cluster insights and retrieves node and container status information.</li><li>Configures and manages Kubernetes resources like scheduling, volumes, and networking.</li><li>Supports debugging and logging with commands to view container logs or access container shells.</li></ul></li><li><strong>Use Case</strong>: <code>kubectl</code> is essential for administrators and developers for managing and controlling Kubernetes resources within a cluster.</li></ul><h3 id="_3-kubelet-core-node-agent" tabindex="-1"><a class="header-anchor" href="#_3-kubelet-core-node-agent"><span>3. <code>kubelet</code> - Core Node Agent</span></a></h3><ul><li><strong>Purpose</strong>: <code>kubelet</code> is a crucial component that runs on each node, responsible for managing the lifecycle of containers and Pods on that node.</li><li><strong>Functions</strong>: <ul><li>Communicates with the Kubernetes API server to receive Pod assignments for the node.</li><li>Manages container lifecycle through container runtimes (e.g., Docker or containerd).</li><li>Regularly reports node and container status to the API server, ensuring the cluster has up-to-date resource information.</li><li>Oversees node health and resources, monitoring and reporting resource usage.</li></ul></li><li><strong>Use Case</strong>: <code>kubelet</code> is the core process ensuring that Pods assigned to a node operate reliably, making it essential for resource scheduling and container management.</li></ul><h2 id="why-using-k3s" tabindex="-1"><a class="header-anchor" href="#why-using-k3s"><span>Why using K3s?</span></a></h2><h2 id="k3s-lightweight-kubernetes-distribution" tabindex="-1"><a class="header-anchor" href="#k3s-lightweight-kubernetes-distribution"><span>K3s - Lightweight Kubernetes Distribution</span></a></h2><p>K3s is a simplified and lightweight distribution of Kubernetes that incorporates the core functionalities of <code>kubeadm</code>, <code>kubectl</code>, and <code>kubelet</code>. Developed for resource-constrained environments and edge computing, K3s significantly reduces the complexity of installing and maintaining a Kubernetes cluster.</p><h3 id="key-benefits-of-k3s" tabindex="-1"><a class="header-anchor" href="#key-benefits-of-k3s"><span>Key Benefits of K3s:</span></a></h3><ul><li><strong>Integrated Core Features</strong>: K3s includes the essential features of <code>kubeadm</code>, <code>kubectl</code>, and <code>kubelet</code>, providing a streamlined installation process.</li><li><strong>Lightweight and Resource-Efficient</strong>: Designed to run on resource-limited devices (e.g., ARM64, Raspberry Pi), K3s is ideal for edge computing, IoT, and minimal hardware environments.</li><li><strong>Reduced Overhead</strong>: With built-in networking, container runtimes, and streamlined configuration, K3s simplifies Kubernetes setup and management, making it easy to deploy clusters in constrained environments.</li></ul><h3 id="summary" tabindex="-1"><a class="header-anchor" href="#summary"><span>Summary</span></a></h3><ul><li><strong><code>kubeadm</code></strong>: Initializes and configures clusters, facilitating node addition.</li><li><strong><code>kubectl</code></strong>: Manages and operates Kubernetes resources.</li><li><strong><code>kubelet</code></strong>: Manages container lifecycle on each node, ensuring Pods function correctly.</li></ul><p>K3s integrates the essential functions of these tools, providing a lightweight and accessible Kubernetes solution suitable for environments with limited resources.</p><h2 id="_1-install-k3s-on-master-node" tabindex="-1"><a class="header-anchor" href="#_1-install-k3s-on-master-node"><span>1. Install K3s on Master Node</span></a></h2><h3 id="on-the-master-node-172-16-217-137-run-the-following-command-to-install-k3s" tabindex="-1"><a class="header-anchor" href="#on-the-master-node-172-16-217-137-run-the-following-command-to-install-k3s"><span>On the master node (<code>172.16.217.137</code>), run the following command to install K3s:</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -sfL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://get.k3s.io</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="once-k3s-is-installed-configure-the-kubeconfig-file-to-allow-access-to-the-kubernetes-cluster-from-your-local-machine" tabindex="-1"><a class="header-anchor" href="#once-k3s-is-installed-configure-the-kubeconfig-file-to-allow-access-to-the-kubernetes-cluster-from-your-local-machine"><span>Once K3s is installed, configure the kubeconfig file to allow access to the Kubernetes cluster from your local machine:</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">mkdir</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -p</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $HOME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/.kube</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cp</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /etc/rancher/k3s/k3s.yaml</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> $HOME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/.kube/config</span></span>\n<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> chown</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> $(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">id</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -u</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">$(</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">id</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -g</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$HOME</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/.kube/config</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-get-the-k3s-join-token" tabindex="-1"><a class="header-anchor" href="#_2-get-the-k3s-join-token"><span>2. Get the K3s Join Token</span></a></h2><h3 id="to-add-worker-nodes-to-the-cluster-you-need-the-k3s-join-token-on-the-master-node-run" tabindex="-1"><a class="header-anchor" href="#to-add-worker-nodes-to-the-cluster-you-need-the-k3s-join-token-on-the-master-node-run"><span>To add worker nodes to the cluster, you need the K3s join token. On the master node, run:</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> cat</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /var/lib/rancher/k3s/server/node-token</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="copy-the-output-token-for-use-on-the-worker-nodes" tabindex="-1"><a class="header-anchor" href="#copy-the-output-token-for-use-on-the-worker-nodes"><span>Copy the output token for use on the worker nodes.</span></a></h3><h2 id="_3-install-k3s-on-worker-nodes" tabindex="-1"><a class="header-anchor" href="#_3-install-k3s-on-worker-nodes"><span>3. Install K3s on Worker Nodes</span></a></h2><h3 id="on-each-worker-node-172-16-217-138-and-172-16-217-139-run-the-following-command-to-install-k3s-and-join-the-cluster" tabindex="-1"><a class="header-anchor" href="#on-each-worker-node-172-16-217-138-and-172-16-217-139-run-the-following-command-to-install-k3s-and-join-the-cluster"><span>On each worker node (172.16.217.138 and 172.16.217.139), run the following command to install K3s and join the cluster:</span></a></h3><h3 id="for-node1-172-16-217-138" tabindex="-1"><a class="header-anchor" href="#for-node1-172-16-217-138"><span>For Node1 (172.16.217.138):</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -sfL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://get.k3s.io</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">K3S_URL</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">https://172.16.217.138:6443</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> K3S_TOKEN</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MASTER_NODE_TOKEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="for-node2-172-16-217-139" tabindex="-1"><a class="header-anchor" href="#for-node2-172-16-217-139"><span>For Node2 (172.16.217.139):</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">curl</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -sfL</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> https://get.k3s.io</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> | </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">K3S_URL</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">https://172.16.217.139:6443</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> K3S_TOKEN</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">MASTER_NODE_TOKEN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sh</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> -</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="make-sure-to-replace-master-node-token-with-the-token-obtained-from-the-master-node" tabindex="-1"><a class="header-anchor" href="#make-sure-to-replace-master-node-token-with-the-token-obtained-from-the-master-node"><span>Make sure to replace &lt;MASTER_NODE_TOKEN&gt; with the token obtained from the master node.</span></a></h3><h2 id="_4-verify-cluster-status" tabindex="-1"><a class="header-anchor" href="#_4-verify-cluster-status"><span>4. Verify Cluster Status</span></a></h2><h3 id="back-on-the-master-node-verify-that-the-worker-nodes-have-successfully-joined-the-cluster" tabindex="-1"><a class="header-anchor" href="#back-on-the-master-node-verify-that-the-worker-nodes-have-successfully-joined-the-cluster"><span>Back on the master node, verify that the worker nodes have successfully joined the cluster:</span></a></h3><h3 id="kubectl-get-nodes" tabindex="-1"><a class="header-anchor" href="#kubectl-get-nodes"><span>kubectl get nodes</span></a></h3><h3 id="you-should-see-output-similar-to" tabindex="-1"><a class="header-anchor" href="#you-should-see-output-similar-to"><span>You should see output similar to:</span></a></h3><figure><img src="'+i+'" alt="kubeClusterConfig.png" tabindex="0" loading="lazy"><figcaption>kubeClusterConfig.png</figcaption></figure><h2 id="summary-1" tabindex="-1"><a class="header-anchor" href="#summary-1"><span>Summary</span></a></h2><h3 id="install-k3s-on-master-node-run-curl-sfl-https-get-k3s-io-sh-to-install-k3s-and-configure-kubeconfig" tabindex="-1"><a class="header-anchor" href="#install-k3s-on-master-node-run-curl-sfl-https-get-k3s-io-sh-to-install-k3s-and-configure-kubeconfig"><span>Install K3s on Master Node: Run curl -sfL https://get.k3s.io | sh - to install K3s and configure kubeconfig.</span></a></h3><h3 id="get-the-join-token-retrieve-the-token-on-the-master-node-using-cat-var-lib-rancher-k3s-server-node-token" tabindex="-1"><a class="header-anchor" href="#get-the-join-token-retrieve-the-token-on-the-master-node-using-cat-var-lib-rancher-k3s-server-node-token"><span>Get the Join Token: Retrieve the token on the master node using cat /var/lib/rancher/k3s/server/node-token.</span></a></h3><h3 id="install-k3s-on-worker-nodes-use-the-master-node-s-ip-and-token-to-install-k3s-on-worker-nodes" tabindex="-1"><a class="header-anchor" href="#install-k3s-on-worker-nodes-use-the-master-node-s-ip-and-token-to-install-k3s-on-worker-nodes"><span>Install K3s on Worker Nodes: Use the master node&#39;s IP and token to install K3s on worker nodes.</span></a></h3><h3 id="verify-cluster-status-use-kubectl-get-nodes-to-ensure-all-nodes-are-in-ready-state" tabindex="-1"><a class="header-anchor" href="#verify-cluster-status-use-kubectl-get-nodes-to-ensure-all-nodes-are-in-ready-state"><span>Verify Cluster Status: Use kubectl get nodes to ensure all nodes are in Ready state.</span></a></h3><h3 id="by-following-these-steps-you-will-have-successfully-set-up-a-k3s-cluster-with-one-master-node-and-two-worker-nodes" tabindex="-1"><a class="header-anchor" href="#by-following-these-steps-you-will-have-successfully-set-up-a-k3s-cluster-with-one-master-node-and-two-worker-nodes"><span>By following these steps, you will have successfully set up a K3s cluster with one master node and two worker nodes</span></a></h3>',45)]))}]]),r=JSON.parse('{"path":"/posts/kubernetes/practices/1.html","title":"Setting up K3s Cluster on CentOS 9","lang":"en-US","frontmatter":{"icon":"pen-to-square","date":"2024-11-07T00:00:00.000Z","category":["Learning Records"],"tag":["Kubernetes"],"description":"Setting up K3s Cluster on CentOS 9 Download mirror iso file on \'https://www.centos.org/download/\', and use VMWare Fusion to set up 3 different CentOS 9. This guide will walk you...","head":[["meta",{"property":"og:url","content":"https://crc011220.github.io/personalweb/personalweb/posts/kubernetes/practices/1.html"}],["meta",{"property":"og:site_name","content":"Richard Chen"}],["meta",{"property":"og:title","content":"Setting up K3s Cluster on CentOS 9"}],["meta",{"property":"og:description","content":"Setting up K3s Cluster on CentOS 9 Download mirror iso file on \'https://www.centos.org/download/\', and use VMWare Fusion to set up 3 different CentOS 9. This guide will walk you..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2024-11-12T11:17:10.000Z"}],["meta",{"property":"article:tag","content":"Kubernetes"}],["meta",{"property":"article:published_time","content":"2024-11-07T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-11-12T11:17:10.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Setting up K3s Cluster on CentOS 9\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2024-11-07T00:00:00.000Z\\",\\"dateModified\\":\\"2024-11-12T11:17:10.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Richard Chen\\"}]}"]]},"headers":[{"level":3,"title":"Download mirror iso file on \'https://www.centos.org/download/\', and use VMWare Fusion to set up 3 different CentOS 9.","slug":"download-mirror-iso-file-on-https-www-centos-org-download-and-use-vmware-fusion-to-set-up-3-different-centos-9","link":"#download-mirror-iso-file-on-https-www-centos-org-download-and-use-vmware-fusion-to-set-up-3-different-centos-9","children":[]},{"level":2,"title":"Key Kubernetes Components","slug":"key-kubernetes-components","link":"#key-kubernetes-components","children":[{"level":3,"title":"1. kubeadm - Cluster Initialization Tool","slug":"_1-kubeadm-cluster-initialization-tool","link":"#_1-kubeadm-cluster-initialization-tool","children":[]},{"level":3,"title":"2. kubectl - Cluster Management Tool","slug":"_2-kubectl-cluster-management-tool","link":"#_2-kubectl-cluster-management-tool","children":[]},{"level":3,"title":"3. kubelet - Core Node Agent","slug":"_3-kubelet-core-node-agent","link":"#_3-kubelet-core-node-agent","children":[]}]},{"level":2,"title":"Why using K3s?","slug":"why-using-k3s","link":"#why-using-k3s","children":[]},{"level":2,"title":"K3s - Lightweight Kubernetes Distribution","slug":"k3s-lightweight-kubernetes-distribution","link":"#k3s-lightweight-kubernetes-distribution","children":[{"level":3,"title":"Key Benefits of K3s:","slug":"key-benefits-of-k3s","link":"#key-benefits-of-k3s","children":[]},{"level":3,"title":"Summary","slug":"summary","link":"#summary","children":[]}]},{"level":2,"title":"1. Install K3s on Master Node","slug":"_1-install-k3s-on-master-node","link":"#_1-install-k3s-on-master-node","children":[{"level":3,"title":"On the master node (172.16.217.137), run the following command to install K3s:","slug":"on-the-master-node-172-16-217-137-run-the-following-command-to-install-k3s","link":"#on-the-master-node-172-16-217-137-run-the-following-command-to-install-k3s","children":[]},{"level":3,"title":"Once K3s is installed, configure the kubeconfig file to allow access to the Kubernetes cluster from your local machine:","slug":"once-k3s-is-installed-configure-the-kubeconfig-file-to-allow-access-to-the-kubernetes-cluster-from-your-local-machine","link":"#once-k3s-is-installed-configure-the-kubeconfig-file-to-allow-access-to-the-kubernetes-cluster-from-your-local-machine","children":[]}]},{"level":2,"title":"2. Get the K3s Join Token","slug":"_2-get-the-k3s-join-token","link":"#_2-get-the-k3s-join-token","children":[{"level":3,"title":"To add worker nodes to the cluster, you need the K3s join token. On the master node, run:","slug":"to-add-worker-nodes-to-the-cluster-you-need-the-k3s-join-token-on-the-master-node-run","link":"#to-add-worker-nodes-to-the-cluster-you-need-the-k3s-join-token-on-the-master-node-run","children":[]},{"level":3,"title":"Copy the output token for use on the worker nodes.","slug":"copy-the-output-token-for-use-on-the-worker-nodes","link":"#copy-the-output-token-for-use-on-the-worker-nodes","children":[]}]},{"level":2,"title":"3. Install K3s on Worker Nodes","slug":"_3-install-k3s-on-worker-nodes","link":"#_3-install-k3s-on-worker-nodes","children":[{"level":3,"title":"On each worker node (172.16.217.138 and 172.16.217.139), run the following command to install K3s and join the cluster:","slug":"on-each-worker-node-172-16-217-138-and-172-16-217-139-run-the-following-command-to-install-k3s-and-join-the-cluster","link":"#on-each-worker-node-172-16-217-138-and-172-16-217-139-run-the-following-command-to-install-k3s-and-join-the-cluster","children":[]},{"level":3,"title":"For Node1 (172.16.217.138):","slug":"for-node1-172-16-217-138","link":"#for-node1-172-16-217-138","children":[]},{"level":3,"title":"For Node2 (172.16.217.139):","slug":"for-node2-172-16-217-139","link":"#for-node2-172-16-217-139","children":[]},{"level":3,"title":"Make sure to replace <MASTER_NODE_TOKEN> with the token obtained from the master node.","slug":"make-sure-to-replace-master-node-token-with-the-token-obtained-from-the-master-node","link":"#make-sure-to-replace-master-node-token-with-the-token-obtained-from-the-master-node","children":[]}]},{"level":2,"title":"4. Verify Cluster Status","slug":"_4-verify-cluster-status","link":"#_4-verify-cluster-status","children":[{"level":3,"title":"Back on the master node, verify that the worker nodes have successfully joined the cluster:","slug":"back-on-the-master-node-verify-that-the-worker-nodes-have-successfully-joined-the-cluster","link":"#back-on-the-master-node-verify-that-the-worker-nodes-have-successfully-joined-the-cluster","children":[]},{"level":3,"title":"kubectl get nodes","slug":"kubectl-get-nodes","link":"#kubectl-get-nodes","children":[]},{"level":3,"title":"You should see output similar to:","slug":"you-should-see-output-similar-to","link":"#you-should-see-output-similar-to","children":[]}]},{"level":2,"title":"Summary","slug":"summary-1","link":"#summary-1","children":[{"level":3,"title":"Install K3s on Master Node: Run curl -sfL https://get.k3s.io | sh - to install K3s and configure kubeconfig.","slug":"install-k3s-on-master-node-run-curl-sfl-https-get-k3s-io-sh-to-install-k3s-and-configure-kubeconfig","link":"#install-k3s-on-master-node-run-curl-sfl-https-get-k3s-io-sh-to-install-k3s-and-configure-kubeconfig","children":[]},{"level":3,"title":"Get the Join Token: Retrieve the token on the master node using cat /var/lib/rancher/k3s/server/node-token.","slug":"get-the-join-token-retrieve-the-token-on-the-master-node-using-cat-var-lib-rancher-k3s-server-node-token","link":"#get-the-join-token-retrieve-the-token-on-the-master-node-using-cat-var-lib-rancher-k3s-server-node-token","children":[]},{"level":3,"title":"Install K3s on Worker Nodes: Use the master node\'s IP and token to install K3s on worker nodes.","slug":"install-k3s-on-worker-nodes-use-the-master-node-s-ip-and-token-to-install-k3s-on-worker-nodes","link":"#install-k3s-on-worker-nodes-use-the-master-node-s-ip-and-token-to-install-k3s-on-worker-nodes","children":[]},{"level":3,"title":"Verify Cluster Status: Use kubectl get nodes to ensure all nodes are in Ready state.","slug":"verify-cluster-status-use-kubectl-get-nodes-to-ensure-all-nodes-are-in-ready-state","link":"#verify-cluster-status-use-kubectl-get-nodes-to-ensure-all-nodes-are-in-ready-state","children":[]},{"level":3,"title":"By following these steps, you will have successfully set up a K3s cluster with one master node and two worker nodes","slug":"by-following-these-steps-you-will-have-successfully-set-up-a-k3s-cluster-with-one-master-node-and-two-worker-nodes","link":"#by-following-these-steps-you-will-have-successfully-set-up-a-k3s-cluster-with-one-master-node-and-two-worker-nodes","children":[]}]}],"git":{"createdTime":1730976593000,"updatedTime":1731410230000,"contributors":[{"name":"Ruochen Chen","email":"ruocchen1220@gmail.com","commits":2}]},"readingTime":{"minutes":2.71,"words":813},"filePathRelative":"posts/kubernetes/practices/1.md","localizedDate":"November 7, 2024","excerpt":"\\n<h3>Download mirror iso file on \'https://www.centos.org/download/\', and use VMWare Fusion to set up 3 different CentOS 9.</h3>\\n<h4>This guide will walk you through setting up a K3s cluster with 1 master node and 2 worker nodes on CentOS 9. The master node\'s IP is <code>172.16.217.137</code>, worker nodes\' IPs are <code>172.16.217.138</code> and <code>172.16.217.139</code>.</h4>","autoDesc":true}')},6262:(e,s)=>{s.A=(e,s)=>{const t=e.__vccOpts||e;for(const[e,n]of s)t[e]=n;return t}}}]);