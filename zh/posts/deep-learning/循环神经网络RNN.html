<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://crc011220.github.io/zh/posts/deep-learning/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN.html"><meta property="og:site_name" content="Ruochen Chen"><meta property="og:title" content="å¾ªç¯ç¥ç»ç½‘ç»œRNN"><meta property="og:description" content="å¾ªç¯ç¥ç»ç½‘ç»œRNN RNNä»‹ç» RNNæ¦‚å¿µ å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Network, RNNï¼‰æ˜¯ä¸€ç§ä¸“é—¨å¤„ç†åºåˆ—æ•°æ®çš„ç¥ç»ç½‘ç»œã€‚ä¸ä¼ ç»Ÿçš„å‰é¦ˆç¥ç»ç½‘ç»œä¸åŒï¼ŒRNNå…·æœ‰â€œå¾ªç¯â€ç»“æ„ï¼Œèƒ½å¤Ÿå¤„ç†å’Œè®°ä½å‰é¢æ—¶é—´æ­¥çš„ä¿¡æ¯ï¼Œä½¿å…¶ç‰¹åˆ«é€‚ç”¨äºæ—¶é—´åºåˆ—æ•°æ®æˆ–æœ‰æ—¶åºä¾èµ–çš„ä»»åŠ¡ã€‚ æˆ‘ä»¬è¦æ˜ç¡®ä»€ä¹ˆæ˜¯åºåˆ—æ•°æ®ï¼Œæ—¶é—´åºåˆ—æ•°æ®æ˜¯æŒ‡åœ¨ä¸åŒæ—¶é—´ç‚¹ä¸Šæ”¶é›†åˆ°çš„æ•°æ®ï¼Œè¿™..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-12-16T06:46:11.000Z"><meta property="article:tag" content="Deep Learning"><meta property="article:published_time" content="2025-12-15T00:00:00.000Z"><meta property="article:modified_time" content="2025-12-16T06:46:11.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"å¾ªç¯ç¥ç»ç½‘ç»œRNN","image":[""],"datePublished":"2025-12-15T00:00:00.000Z","dateModified":"2025-12-16T06:46:11.000Z","author":[{"@type":"Person","name":"Ruochen Chen"}]}</script><link rel="icon" href="/mac.ico"><title>å¾ªç¯ç¥ç»ç½‘ç»œRNN | Ruochen Chen</title><meta name="description" content="å¾ªç¯ç¥ç»ç½‘ç»œRNN RNNä»‹ç» RNNæ¦‚å¿µ å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Network, RNNï¼‰æ˜¯ä¸€ç§ä¸“é—¨å¤„ç†åºåˆ—æ•°æ®çš„ç¥ç»ç½‘ç»œã€‚ä¸ä¼ ç»Ÿçš„å‰é¦ˆç¥ç»ç½‘ç»œä¸åŒï¼ŒRNNå…·æœ‰â€œå¾ªç¯â€ç»“æ„ï¼Œèƒ½å¤Ÿå¤„ç†å’Œè®°ä½å‰é¢æ—¶é—´æ­¥çš„ä¿¡æ¯ï¼Œä½¿å…¶ç‰¹åˆ«é€‚ç”¨äºæ—¶é—´åºåˆ—æ•°æ®æˆ–æœ‰æ—¶åºä¾èµ–çš„ä»»åŠ¡ã€‚ æˆ‘ä»¬è¦æ˜ç¡®ä»€ä¹ˆæ˜¯åºåˆ—æ•°æ®ï¼Œæ—¶é—´åºåˆ—æ•°æ®æ˜¯æŒ‡åœ¨ä¸åŒæ—¶é—´ç‚¹ä¸Šæ”¶é›†åˆ°çš„æ•°æ®ï¼Œè¿™...">
    <link rel="stylesheet" href="/assets/css/styles.563fed46.css">
    <link rel="preload" href="/assets/js/runtime~app.ffeb7043.js" as="script"><link rel="preload" href="/assets/css/styles.563fed46.css" as="style"><link rel="preload" href="/assets/js/6312.34f20d6c.js" as="script"><link rel="preload" href="/assets/js/app.1d1569fd.js" as="script">
    <link rel="prefetch" href="/assets/js/zh_posts_declarative_haskell.html.8c87b5f2.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_java8_å‡½æ•°å¼ç¼–ç¨‹.html.40d1660d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_Netty01-nio.html.6b030cf9.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_Netty04-ä¼˜åŒ–ä¸æºç .html.a06bcb3d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_Netty03-è¿›é˜¶.html.10e8bde8.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_åŠ¨æ€è§„åˆ’.html.f8a6083b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_æ•°ç»„.html.8af35e83.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_Netty02-intro.html.17d2ad2a.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_äºŒå‰æ ‘.html.0252c56b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nginx_1.html.c3c98206.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_å…¶ä»–é—®é¢˜.html.1275958b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_é¢è¯•è¦ç‚¹.html.1c7f13b2.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_declarative_prolog.html.3a954dea.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_é“¾è¡¨.html.b1dfdd7a.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å…¶ä»–.html.80e868f3.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_COMP90024.html.45f38ae1.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å›¾.html.69b9a845.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_4.html.fd9ffcf6.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_å·ç§¯ç¥ç»ç½‘ç»œCNN.html.47996a3b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_æ ˆå’Œé˜Ÿåˆ—.html.af497ee4.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_hive_Hive-SQLè¯­æ³•å¤§å…¨.html.f759f418.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_5.html.76bc5477.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_14.html.9aaba6e1.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_declarative_haskellé€Ÿè®°.html.ef4f7d84.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å›æº¯.html.ecd8e9b5.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_å¾ªç¯ç¥ç»ç½‘ç»œRNN.html.27d1b54f.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_COMP90049.html.f2fdd90a.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_COMP90050.html.d392f89b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_1.html.c99a1c9b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_æ•°æ®ç»“æ„.html.4979e774.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_2.html.4f5247a4.js" as="script"><link rel="prefetch" href="/assets/js/posts_note_Coin-exchange-project-note.html.b25a336f.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_3.html.e770d362.js" as="script"><link rel="prefetch" href="/assets/js/posts_tailwind_summary.html.12cdb2f0.js" as="script"><link rel="prefetch" href="/assets/js/2664.86a91f7e.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_è®¡ç®—æœºç½‘ç»œ.html.696d6361.js" as="script"><link rel="prefetch" href="/assets/js/posts_typescript_1.html.5dc7387d.js" as="script"><link rel="prefetch" href="/assets/js/posts_typescript_2.html.bceb6a75.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_è´ªå¿ƒ.html.c6b34afe.js" as="script"><link rel="prefetch" href="/assets/js/posts_aws-saa_1.html.177e1f79.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_ml.html.788cf46b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_æ•°æ®åº“.html.38294ea6.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_æ“ä½œç³»ç»Ÿ.html.2e1d2bbb.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nlp_1.html.91b39bb8.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_COMP90048.html.5bc76c43.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_è®¡ç®—æœºç»„æˆåŸç†.html.ccb41d2c.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_1.html.c5da541d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_declarative_prologé€Ÿè®°.html.c0c75089.js" as="script"><link rel="prefetch" href="/assets/js/8300.14894ef4.js" as="script"><link rel="prefetch" href="/assets/js/posts_mybatis_2.html.db75dcd2.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_åŒæŒ‡é’ˆ.html.dcbf74cb.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_7.html.75cd7a1b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_4.html.7b61713b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_5.html.4e640a94.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å“ˆå¸Œ.html.7191fba9.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nlp_2.html.7e627558.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_8.html.2a069622.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_2.html.28e1dffb.js" as="script"><link rel="prefetch" href="/assets/js/posts_aws-saa_3.html.982df5d0.js" as="script"><link rel="prefetch" href="/assets/js/posts_nginx_1.html.0a9ef4e3.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_SWEN90016.html.91bb292c.js" as="script"><link rel="prefetch" href="/assets/js/posts_spark_Spark-Core.html.05cb9b15.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_11.html.970906ea.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_14.html.45fbc6bb.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_8.html.002dcc85.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_4.html.ba6c0782.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_ä¿¡æ¯æ–°æŠ€æœ¯.html.be677525.js" as="script"><link rel="prefetch" href="/assets/js/posts_spark_Spark-Sql.html.0a30b882.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_21.html.4496521a.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_11.html.c16822d9.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_5.html.22b3e187.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_6.html.6a4a300d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_daily_CE-project.html.fb8c775b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_10.html.446c7da5.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_1.html.b58eda92.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å•è°ƒæ ˆ.html.65c2776c.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_6.html.90316726.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_4.html.15a69407.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_15.html.083892cc.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_py_numpy.html.6b59cce4.js" as="script"><link rel="prefetch" href="/assets/js/posts_aws-saa_2.html.63b9fd8e.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_py_pandas.html.83447d88.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_6.html.3681f2b0.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_3.html.42b1f4d4.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_12.html.ca965f90.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_14.html.d5372a71.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_13.html.1f2b36bf.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_javaai.html.74fdba9d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å­—ç¬¦ä¸².html.ff3d7193.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_5.html.7f4e8fb8.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_6.html.087ef28e.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_2.html.4def8772.js" as="script"><link rel="prefetch" href="/assets/js/posts_typescript_3.html.249b422e.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_2.html.0325f0d9.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_16.html.ac1e8d01.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_2.html.46e9824a.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_7.html.cbe998f9.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_3.html.f8dc6fdd.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_12.html.ba44f1e4.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_17.html.37ee66f3.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_ä½è¿ç®—.html.218c3265.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_13.html.fef35e9b.js" as="script"><link rel="prefetch" href="/assets/js/intro.html.2e98292e.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_9.html.632a787f.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_15.html.8c8188a0.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_create_mcp.html.533f660c.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_18.html.8e1ad428.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_1.html.8751908b.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_mcp.html.ed4aa6a9.js" as="script"><link rel="prefetch" href="/assets/js/posts_mybatis_1.html.4f6a9358.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_1.html.9e383813.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_7.html.95648d46.js" as="script"><link rel="prefetch" href="/assets/js/posts_istio_1.html.30859a44.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_4.html.9a08d7d3.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_15.html.3fa1eae7.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_10.html.c68171c4.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_1.html.de1e1552.js" as="script"><link rel="prefetch" href="/assets/js/zh_intro.html.3d16bbfe.js" as="script"><link rel="prefetch" href="/assets/js/posts_spark_Spark-Intro.html.d16644da.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_5.html.16d411e3.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_19.html.38712a54.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_7.html.2437ce47.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_æ•°å­¦.html.5fe6c3f9.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_3.html.7e27f56c.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_7.html.abcbe1ef.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_8.html.2569e227.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_index.html.c0edcde2.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_3.html.802f030e.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_Hive.html.eb88f001.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_7.html.d89efd0f.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_9.html.f901c68a.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_HDFS.html.91ff53ef.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_index.html.116eb444.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_good_mcp.html.68e7736e.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_2.html.aecf58f9.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_8.html.a6bfae84.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_4.html.e48b4853.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_daily_good_mcp.html.a3c0902a.js" as="script"><link rel="prefetch" href="/assets/js/posts_jd_note.html.6b67dee8.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_5.html.a2ff101c.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_3.html.69869cbb.js" as="script"><link rel="prefetch" href="/assets/js/posts_docker_1.html.377d8749.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_11.html.9ebfb3bd.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_microsvc_1.html.8ae60b3b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_index.html.8ab4401b.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_summary.html.d72e0b7d.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_6.html.76d483d6.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_6.html.7c3748ee.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_3.html.9fd07548.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_6.html.6ed2bd98.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_7.html.d245ffc7.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_8.html.5515b3e2.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_4.html.2e3e4df8.js" as="script"><link rel="prefetch" href="/assets/js/posts_elasticsearch_query-dsl.html.60aa5ed1.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_cloudflare.html.bf17ad2d.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_20.html.4de7341b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_1.html.67e91c06.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_5.html.11d820af.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_2.html.0716d1a1.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_10.html.1f4d9b9c.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_16.html.fd55f91e.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_3.html.83b7a26f.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_tools.html.1fdbd61f.js" as="script"><link rel="prefetch" href="/assets/js/posts_elasticsearch_1.html.f4e979a2.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_2.html.bb38228d.js" as="script"><link rel="prefetch" href="/assets/js/posts_docker_docker-podman.html.abacaf64.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_index.html.c331ef18.js" as="script"><link rel="prefetch" href="/assets/js/posts_dubbo_1.html.405486fb.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_4.html.046bb2ce.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_9.html.f45d605e.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_index.html.63af927c.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_index.html.b0bb4f27.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_9.html.836391d2.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_index.html.1338ad6d.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_1.html.b1996c1d.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_8.html.db9f98c6.js" as="script"><link rel="prefetch" href="/assets/js/posts_elasticsearch_2.html.22acec5f.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_genesis.html.b7e816b9.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_è¯æ±‡.html.4b433385.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_5.html.8cd4d1cf.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_GEOM90007.html.e3b372c0.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_index.html.f4e57161.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_MapReduce.html.75723559.js" as="script"><link rel="prefetch" href="/assets/js/posts_genesis.html.4e94cd83.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_12.html.9b6357a9.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_sealos.html.29198f4a.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_index.html.baea0f7a.js" as="script"><link rel="prefetch" href="/assets/js/posts_dubbo_2.html.62d5a24e.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_13.html.df726101.js" as="script"><link rel="prefetch" href="/assets/js/posts_aws-saa_index.html.b3e65945.js" as="script"><link rel="prefetch" href="/assets/js/posts_typescript_index.html.5fd62eae.js" as="script"><link rel="prefetch" href="/assets/js/posts_elasticsearch_index.html.a08b1976.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_index.html.b0a1975e.js" as="script"><link rel="prefetch" href="/assets/js/index.html.b2d0a002.js" as="script"><link rel="prefetch" href="/assets/js/posts_dubbo_index.html.42302fb2.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_Yarn.html.db1a275b.js" as="script"><link rel="prefetch" href="/assets/js/posts_nginx_index.html.350d8a38.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_index.html.0f59a711.js" as="script"><link rel="prefetch" href="/assets/js/posts_mybatis_index.html.931c43c6.js" as="script"><link rel="prefetch" href="/assets/js/posts_spark_index.html.4b085309.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_microsvc_index.html.f9c35bbc.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_9.html.71162abb.js" as="script"><link rel="prefetch" href="/assets/js/posts_nginx_2.html.3a2f1fef.js" as="script"><link rel="prefetch" href="/assets/js/zh_index.html.a165dbd7.js" as="script"><link rel="prefetch" href="/assets/js/posts_tailwind_index.html.b0d16a8c.js" as="script"><link rel="prefetch" href="/assets/js/posts_docker_index.html.a7c8c584.js" as="script"><link rel="prefetch" href="/assets/js/posts_istio_index.html.17123110.js" as="script"><link rel="prefetch" href="/assets/js/posts_note_index.html.fec20934.js" as="script"><link rel="prefetch" href="/assets/js/category_learning-records_index.html.510e9bba.js" as="script"><link rel="prefetch" href="/assets/js/tag_notes_index.html.0ac76b75.js" as="script"><link rel="prefetch" href="/assets/js/tag_nginx_index.html.e7be5f14.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_declarative-programming_index.html.a822ad65.js" as="script"><link rel="prefetch" href="/assets/js/category_index.html.768835fc.js" as="script"><link rel="prefetch" href="/assets/js/tag_ai_index.html.fe4f2152.js" as="script"><link rel="prefetch" href="/assets/js/timeline_index.html.b424f566.js" as="script"><link rel="prefetch" href="/assets/js/article_index.html.9adb921b.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_å­¦ä¹ ç¬”è®°_index.html.29a3fb96.js" as="script"><link rel="prefetch" href="/assets/js/category_internship-journal_index.html.f69799d2.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_learning-records_index.html.59568783.js" as="script"><link rel="prefetch" href="/assets/js/star_index.html.32212a7d.js" as="script"><link rel="prefetch" href="/assets/js/tag_index.html.097dea27.js" as="script"><link rel="prefetch" href="/assets/js/tag_programmer-clichÃ©_index.html.a6185911.js" as="script"><link rel="prefetch" href="/assets/js/tag_algorithm-practices_index.html.97c60e68.js" as="script"><link rel="prefetch" href="/assets/js/tag_china-merchant-bank_index.html.5b93dc3c.js" as="script"><link rel="prefetch" href="/assets/js/tag_technical-interview_index.html.b2812be8.js" as="script"><link rel="prefetch" href="/assets/js/posts_index.html.33b12a16.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_deep-learning_index.html.4a7794c4.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_å¼€å§‹_index.html.57d4c6ef.js" as="script"><link rel="prefetch" href="/assets/js/tag_tailwind-css_index.html.54d490c2.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_æ—…ç¨‹_index.html.b1e6b88d.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_ç®€å†_index.html.4e50e8ea.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_algorithm_index.html.e80eac7f.js" as="script"><link rel="prefetch" href="/assets/js/category_genesis_index.html.591bccca.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_python_index.html.d1edd527.js" as="script"><link rel="prefetch" href="/assets/js/tag_javascript_index.html.001c06ee.js" as="script"><link rel="prefetch" href="/assets/js/tag_kubernetes_index.html.eef84d75.js" as="script"><link rel="prefetch" href="/assets/js/tag_typescript_index.html.6184e840.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_review_index.html.6742583d.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_pandas_index.html.49352803.js" as="script"><link rel="prefetch" href="/assets/js/tag_leetcode_index.html.498be3e5.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_java8_index.html.28884a39.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_netty_index.html.53b52f0e.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_notes_index.html.3f741263.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_numpy_index.html.1b33f3a1.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_nginx_index.html.4491ae9e.js" as="script"><link rel="prefetch" href="/assets/js/tag_aws-saa_index.html.20911f7f.js" as="script"><link rel="prefetch" href="/assets/js/tag_mybatis_index.html.6033540a.js" as="script"><link rel="prefetch" href="/assets/js/tag_unimelb_index.html.328045e2.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_hive_index.html.9768a59d.js" as="script"><link rel="prefetch" href="/assets/js/tag_docker_index.html.b878209e.js" as="script"><link rel="prefetch" href="/assets/js/tag_hadoop_index.html.690832f8.js" as="script"><link rel="prefetch" href="/assets/js/tag_nextjs_index.html.a6285052.js" as="script"><link rel="prefetch" href="/assets/js/tag_resume_index.html.38124bb9.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_nlp_index.html.dcf160a8.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_nio_index.html.bb0f4482.js" as="script"><link rel="prefetch" href="/assets/js/tag_dubbo_index.html.abf3ebe1.js" as="script"><link rel="prefetch" href="/assets/js/tag_index_index.html.8ae4b8d4.js" as="script"><link rel="prefetch" href="/assets/js/tag_istio_index.html.858428e3.js" as="script"><link rel="prefetch" href="/assets/js/tag_react_index.html.43ba41a0.js" as="script"><link rel="prefetch" href="/assets/js/tag_spark_index.html.29181dd3.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_ai_index.html.325869d0.js" as="script"><link rel="prefetch" href="/assets/js/404.html.21f5a3fe.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_index.html.54b8bafd.js" as="script"><link rel="prefetch" href="/assets/js/zh_timeline_index.html.72e8127a.js" as="script"><link rel="prefetch" href="/assets/js/tag_es_index.html.57e41629.js" as="script"><link rel="prefetch" href="/assets/js/tag_jd_index.html.a77e5283.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_index.html.7475689f.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_declarative_index.html.af0bc0ff.js" as="script"><link rel="prefetch" href="/assets/js/zh_article_index.html.81774320.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_index.html.f4be6e27.js" as="script"><link rel="prefetch" href="/assets/js/zh_star_index.html.bba3a853.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_index.html.52fa9622.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_daily_index.html.a7f16b51.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_java8_index.html.5af50263.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_index.html.0308eef4.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nginx_index.html.cbe553ce.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_index.html.584fefbd.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_hive_index.html.40be20be.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_index.html.43c8149d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nlp_index.html.6ca94a7a.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_py_index.html.c412c1ae.js" as="script"><link rel="prefetch" href="/assets/js/posts_jd_index.html.5097556f.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/zh/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/bubu.jpg" alt><!----><span class="vp-site-name hide-in-pad">Ruochen Chen</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/zh/" aria-label="ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ç¬”è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Hive</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/hive/Hive-SQL%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8.html" aria-label="Hiveè¯­æ³•å¤§å…¨"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Hiveè¯­æ³•å¤§å…¨<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Java8ç‰¹æ€§</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/java8/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html" aria-label="å‡½æ•°å¼ç¼–ç¨‹"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->å‡½æ•°å¼ç¼–ç¨‹<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Netty</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/netty/Netty01-nio.html" aria-label="Nioä»‹ç»"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nioä»‹ç»<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/netty/Netty02-intro.html" aria-label="Nettyå…¥é—¨"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nettyå…¥é—¨<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/netty/Netty03-%E8%BF%9B%E9%98%B6.html" aria-label="Nettyè¿›é˜¶"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nettyè¿›é˜¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/netty/Netty04-%E4%BC%98%E5%8C%96%E4%B8%8E%E6%BA%90%E7%A0%81.html" aria-label="Nettyä¼˜åŒ–"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nettyä¼˜åŒ–<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">NGINX</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/nginx/1.html" aria-label="NGINX é«˜çº§"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->NGINX é«˜çº§<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="é€‰æ‹©è¯­è¨€"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" name="i18n" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/" aria-label="English"><!---->English<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/zh/posts/deep-learning/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN.html" aria-label="ç®€ä½“ä¸­æ–‡"><!---->ç®€ä½“ä¸­æ–‡<!----></a></li></ul></button></div></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/Crc011220/Crc011220.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢æ–‡æ¡£"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢æ–‡æ¡£</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/zh/" aria-label="ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->ä¸»é¡µ<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">ç¬”è®°</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Algo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Daily</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Declarative</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Deep Learning</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN.html" aria-label="å·ç§¯ç¥ç»ç½‘ç»œCNN"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->å·ç§¯ç¥ç»ç½‘ç»œCNN<!----></a></li><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/zh/posts/deep-learning/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN.html" aria-label="å¾ªç¯ç¥ç»ç½‘ç»œRNN"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->å¾ªç¯ç¥ç»ç½‘ç»œRNN<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/1.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬ä¸€ç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬ä¸€ç« èŠ‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/3.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬ä¸‰ç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬ä¸‰ç« èŠ‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/2.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬äºŒç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬äºŒç« èŠ‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/5.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬äº”ç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬äº”ç« èŠ‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/4.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬å››ç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬å››ç« èŠ‚<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Hive</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java8</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Netty</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nginx</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nlp</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Py</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Review</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/genesis.html" aria-label="å¼€å§‹"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->å¼€å§‹<!----></a></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/intro.html" aria-label="å…³äºæˆ‘"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span><!--]-->å…³äºæˆ‘<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>å¾ªç¯ç¥ç»ç½‘ç»œRNN</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">Ruochen Chen</span></span><span property="author" content="Ruochen Chen"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025å¹´12æœˆ15æ—¥</span><meta property="datePublished" content="2025-12-15T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 21 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT21M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color5 clickable" role="navigation">Learning Records</span><!--]--><meta property="articleSection" content="Learning Records"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color1 clickable" role="navigation">Deep Learning</span><!--]--><meta property="keywords" content="Deep Learning"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#rnnä»‹ç»">RNNä»‹ç»</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#rnnæ¦‚å¿µ">RNNæ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#rnnåº”ç”¨åœºæ™¯">RNNåº”ç”¨åœºæ™¯</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è‡ªç„¶è¯­è¨€å¤„ç†æ¦‚è¿°">è‡ªç„¶è¯­è¨€å¤„ç†æ¦‚è¿°</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#è¯åµŒå…¥å±‚">è¯åµŒå…¥å±‚</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯åµŒå…¥å±‚ä½œç”¨">è¯åµŒå…¥å±‚ä½œç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯åµŒå…¥å±‚å·¥ä½œæµç¨‹">è¯åµŒå…¥å±‚å·¥ä½œæµç¨‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#è¯åµŒå…¥å±‚ä½¿ç”¨">è¯åµŒå…¥å±‚ä½¿ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å¾ªç¯ç½‘ç»œå±‚">å¾ªç¯ç½‘ç»œå±‚</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#rnnç½‘ç»œå±‚åŸç†">RNNç½‘ç»œå±‚åŸç†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pytorch-rnnå±‚çš„ä½¿ç”¨">PyTorch RNNå±‚çš„ä½¿ç”¨</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#æ–‡æœ¬ç”Ÿæˆæ¡ˆä¾‹">æ–‡æœ¬ç”Ÿæˆæ¡ˆä¾‹</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¯¼å…¥å·¥å…·åŒ…">å¯¼å…¥å·¥å…·åŒ…</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ•°æ®é›†">æ•°æ®é›†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ„å»ºè¯è¡¨">æ„å»ºè¯è¡¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ„å»ºæ•°æ®é›†å¯¹è±¡">æ„å»ºæ•°æ®é›†å¯¹è±¡</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ„å»ºç½‘ç»œæ¨¡å‹">æ„å»ºç½‘ç»œæ¨¡å‹</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ„å»ºè®­ç»ƒå‡½æ•°">æ„å»ºè®­ç»ƒå‡½æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ„å»ºé¢„æµ‹å‡½æ•°">æ„å»ºé¢„æµ‹å‡½æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ€»ç»“">æ€»ç»“</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="å¾ªç¯ç¥ç»ç½‘ç»œrnn" tabindex="-1"><a class="header-anchor" href="#å¾ªç¯ç¥ç»ç½‘ç»œrnn"><span>å¾ªç¯ç¥ç»ç½‘ç»œRNN</span></a></h1><h2 id="rnnä»‹ç»" tabindex="-1"><a class="header-anchor" href="#rnnä»‹ç»"><span>RNNä»‹ç»</span></a></h2><h3 id="rnnæ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#rnnæ¦‚å¿µ"><span>RNNæ¦‚å¿µ</span></a></h3><p>å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRecurrent Neural Network, RNNï¼‰æ˜¯ä¸€ç§<strong>ä¸“é—¨å¤„ç†åºåˆ—æ•°æ®çš„ç¥ç»ç½‘ç»œ</strong>ã€‚ä¸ä¼ ç»Ÿçš„å‰é¦ˆç¥ç»ç½‘ç»œä¸åŒï¼ŒRNNå…·æœ‰â€œ<strong>å¾ªç¯</strong>â€ç»“æ„ï¼Œèƒ½å¤Ÿå¤„ç†å’Œè®°ä½å‰é¢æ—¶é—´æ­¥çš„ä¿¡æ¯ï¼Œä½¿å…¶ç‰¹åˆ«é€‚ç”¨äºæ—¶é—´åºåˆ—æ•°æ®æˆ–æœ‰æ—¶åºä¾èµ–çš„ä»»åŠ¡ã€‚</p><p>æˆ‘ä»¬è¦æ˜ç¡®ä»€ä¹ˆæ˜¯åºåˆ—æ•°æ®ï¼Œæ—¶é—´åºåˆ—æ•°æ®æ˜¯æŒ‡åœ¨ä¸åŒæ—¶é—´ç‚¹ä¸Šæ”¶é›†åˆ°çš„æ•°æ®ï¼Œè¿™ç±»æ•°æ®åæ˜ äº†æŸä¸€äº‹ç‰©ã€ç°è±¡ç­‰éšæ—¶é—´çš„å˜åŒ–çŠ¶æ€æˆ–ç¨‹åº¦ã€‚è¿™æ˜¯æ—¶é—´åºåˆ—æ•°æ®çš„å®šä¹‰ï¼Œå½“ç„¶è¿™é‡Œä¹Ÿå¯ä»¥ä¸æ˜¯æ—¶é—´ï¼Œæ¯”å¦‚æ–‡å­—åºåˆ—ï¼Œä½†æ€»å½’åºåˆ—æ•°æ®æœ‰ä¸€ä¸ªç‰¹ç‚¹â€”â€”<strong>åé¢çš„æ•°æ®è·Ÿå‰é¢çš„æ•°æ®æœ‰å…³ç³»</strong>ã€‚</p><img src="rnn/1734745895344.png" style="zoom:50%;"><h3 id="rnnåº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#rnnåº”ç”¨åœºæ™¯"><span>RNNåº”ç”¨åœºæ™¯</span></a></h3><ul><li><strong>è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNLPï¼‰</strong>ï¼šæ–‡æœ¬ç”Ÿæˆã€è¯­è¨€å»ºæ¨¡ã€æœºå™¨ç¿»è¯‘ã€æƒ…æ„Ÿåˆ†æç­‰ã€‚</li><li><strong>æ—¶é—´åºåˆ—é¢„æµ‹</strong>ï¼šè‚¡å¸‚é¢„æµ‹ã€æ°”è±¡é¢„æµ‹ã€ä¼ æ„Ÿå™¨æ•°æ®åˆ†æç­‰ã€‚</li><li><strong>è¯­éŸ³è¯†åˆ«</strong>ï¼šå°†è¯­éŸ³ä¿¡å·è½¬æ¢ä¸ºæ–‡å­—ã€‚</li><li><strong>éŸ³ä¹ç”Ÿæˆ</strong>ï¼šé€šè¿‡å­¦ä¹ éŸ³ä¹çš„æ—¶åºæ¨¡å¼æ¥ç”Ÿæˆæ–°ä¹æ›²ã€‚</li></ul><h3 id="è‡ªç„¶è¯­è¨€å¤„ç†æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#è‡ªç„¶è¯­è¨€å¤„ç†æ¦‚è¿°"><span>è‡ªç„¶è¯­è¨€å¤„ç†æ¦‚è¿°</span></a></h3><p>è‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNature language Processing, NLPï¼‰ç ”ç©¶çš„ä¸»è¦æ˜¯<strong>é€šè¿‡è®¡ç®—æœºç®—æ³•æ¥ç†è§£è‡ªç„¶è¯­è¨€</strong>ã€‚</p><p>å¯¹äºè‡ªç„¶è¯­è¨€æ¥è¯´ï¼Œå¤„ç†çš„æ•°æ®ä¸»è¦å°±æ˜¯<strong>äººç±»çš„è¯­è¨€</strong>ï¼Œä¾‹å¦‚ï¼šæ±‰è¯­ã€è‹±è¯­ã€æ³•è¯­ç­‰ï¼Œè¯¥ç±»å‹çš„æ•°æ®ä¸åƒæˆ‘ä»¬å‰é¢æ¥è§¦è¿‡çš„ç»“æ„åŒ–æ•°æ®ã€æˆ–è€…å›¾åƒæ•°æ®å¯ä»¥å¾ˆæ–¹ä¾¿çš„è¿›è¡Œæ•°å€¼åŒ–ã€‚</p><p>NLPçš„ç›®æ ‡æ˜¯è®©æœºå™¨èƒ½å¤Ÿâ€œå¬æ‡‚â€å’Œâ€œè¯»æ‡‚â€è‡ªç„¶è¯­è¨€ï¼Œå¹¶è¿›è¡Œæœ‰æ•ˆçš„äº¤æµå’Œåˆ†æã€‚</p><p>NLPæ¶µç›–äº†ä»æ–‡æœ¬åˆ°è¯­éŸ³ã€ä»è¯­éŸ³åˆ°æ–‡æœ¬çš„å„ä¸ªæ–¹é¢ï¼Œå®ƒæ¶‰åŠå¤šç§æŠ€æœ¯ï¼ŒåŒ…æ‹¬è¯­æ³•åˆ†æã€è¯­ä¹‰ç†è§£ã€æƒ…æ„Ÿåˆ†æã€æœºå™¨ç¿»è¯‘ç­‰ã€‚</p><img src="rnn/1734746204314.png" style="zoom:50%;"><h2 id="è¯åµŒå…¥å±‚" tabindex="-1"><a class="header-anchor" href="#è¯åµŒå…¥å±‚"><span>è¯åµŒå…¥å±‚</span></a></h2><blockquote><p>åœ¨ <strong>RNNï¼ˆRecurrent Neural Networkï¼‰</strong> ä¸­ï¼Œ<strong>è¯åµŒå…¥å±‚ï¼ˆWord Embedding Layerï¼‰</strong> æ˜¯å¤„ç†è‡ªç„¶è¯­è¨€æ•°æ®çš„å…³é”®ç»„æˆéƒ¨åˆ†ã€‚å®ƒå°†è¾“å…¥çš„ç¦»æ•£å•è¯ï¼ˆé€šå¸¸æ˜¯è¯æ±‡è¡¨ä¸­çš„ç´¢å¼•ï¼‰è½¬æ¢ä¸ºè¿ç»­çš„ã€ä½ç»´çš„å‘é‡è¡¨ç¤ºï¼Œä»è€Œä½¿å¾—ç¥ç»ç½‘ç»œèƒ½å¤Ÿç†è§£å’Œå¤„ç†è¿™äº›è¯æ±‡çš„è¯­ä¹‰ä¿¡æ¯ã€‚</p></blockquote><h3 id="è¯åµŒå…¥å±‚ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#è¯åµŒå…¥å±‚ä½œç”¨"><span>è¯åµŒå…¥å±‚ä½œç”¨</span></a></h3><p>è¯åµŒå…¥å±‚çš„ä¸»è¦ç›®çš„æ˜¯<strong>å°†æ¯ä¸ªè¯æ˜ å°„ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„å‘é‡ï¼ˆå°†æ–‡æœ¬è½¬æ¢ä¸ºå‘é‡ï¼‰</strong>ï¼Œè¿™äº›å‘é‡èƒ½å¤Ÿæ•æ‰è¯ä¸è¯ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ã€‚</p><p>ä¼ ç»Ÿçš„æ–‡æœ¬è¡¨ç¤ºæ–¹æ³•ï¼ˆå¦‚one-hotç¼–ç ï¼‰æ— æ³•åæ˜ å•è¯ä¹‹é—´çš„ç›¸ä¼¼æ€§ï¼Œå› ä¸ºåœ¨one-hotç¼–ç ä¸­ï¼Œæ¯ä¸ªå•è¯éƒ½è¢«è¡¨ç¤ºä¸ºä¸€ä¸ª<strong>é«˜ç»´ç¨€ç–å‘é‡</strong>ï¼Œè€Œè¯åµŒå…¥é€šè¿‡<strong>ä½ç»´ç¨ å¯†å‘é‡</strong>è¡¨ç¤ºå•è¯ï¼Œèƒ½å¤Ÿæ›´å¥½åœ°æ•æ‰è¯æ±‡ä¹‹é—´çš„è¯­ä¹‰ç›¸ä¼¼æ€§ã€‚</p><p>è¯åµŒå…¥å±‚é¦–å…ˆä¼šæ ¹æ®è¾“å…¥çš„è¯çš„æ•°é‡æ„å»ºä¸€ä¸ª<strong>è¯å‘é‡çŸ©é˜µ</strong>ï¼Œä¾‹å¦‚: æˆ‘ä»¬æœ‰ 100 ä¸ªè¯ï¼Œæ¯ä¸ªè¯å¸Œæœ›è½¬æ¢æˆ 128 ç»´åº¦çš„å‘é‡ï¼Œé‚£ä¹ˆæ„å»ºçš„çŸ©é˜µå½¢çŠ¶å³ä¸º: 100*128ï¼Œè¾“å…¥çš„æ¯ä¸ªè¯éƒ½å¯¹åº”äº†ä¸€ä¸ªè¯¥çŸ©é˜µä¸­çš„ä¸€ä¸ªå‘é‡ã€‚</p><img src="rnn/1734747074293.png" style="zoom:50%;"><p><strong>è¯åµŒå…¥å±‚åœ¨RNNä¸­çš„ä½œç”¨</strong>ï¼š</p><ul><li><strong>è¾“å…¥è¡¨ç¤º</strong>ï¼šRNNé€šå¸¸ç”¨äºå¤„ç†åºåˆ—æ•°æ®ã€‚åœ¨å¤„ç†æ–‡æœ¬æ—¶ï¼ŒRNNçš„è¾“å…¥æ˜¯ç”±å•è¯æ„æˆçš„åºåˆ—ã€‚ç”±äºç¥ç»ç½‘ç»œä¸èƒ½ç›´æ¥å¤„ç†ç¦»æ•£çš„å•è¯æ ‡è¯†ç¬¦ï¼ˆå¦‚æ•´æ•°ç´¢å¼•æˆ–å­—ç¬¦ï¼‰ï¼Œå› æ­¤éœ€è¦é€šè¿‡è¯åµŒå…¥å±‚å°†æ¯ä¸ªå•è¯è½¬æ¢ä¸ºä¸€ä¸ªå›ºå®šé•¿åº¦çš„ç¨ å¯†å‘é‡ã€‚è¿™äº›å‘é‡ä½œä¸ºRNNçš„è¾“å…¥ï¼Œå¸®åŠ©RNNç†è§£è¯è¯­çš„è¯­ä¹‰ã€‚</li><li><strong>é™ä½ç»´åº¦</strong>ï¼šè¯åµŒå…¥å±‚å°†åŸæœ¬é«˜ç»´çš„ç¨€ç–è¡¨ç¤ºï¼ˆå¦‚one-hotç¼–ç ï¼‰è½¬åŒ–ä¸ºä½ç»´çš„ç¨ å¯†å‘é‡ï¼Œå‡å°‘äº†è®¡ç®—é‡ï¼ŒåŒæ—¶ä¿æŒäº†è¯æ±‡ä¹‹é—´çš„è¯­ä¹‰å…³ç³»ã€‚</li><li><strong>æ•æ‰è¯­ä¹‰ç›¸ä¼¼æ€§</strong>ï¼šé€šè¿‡è®­ç»ƒï¼Œè¯åµŒå…¥èƒ½å¤Ÿå­¦ä¹ åˆ°è¯è¯­ä¹‹é—´çš„å…³ç³»ã€‚ä¾‹å¦‚ï¼Œè¯­ä¹‰ç›¸ä¼¼çš„è¯ï¼ˆå¦‚â€œçŒ«â€å’Œâ€œç‹—â€ï¼‰åœ¨å‘é‡ç©ºé—´ä¸­ä¼šæ¯”è¾ƒæ¥è¿‘ï¼Œè€Œè¯­ä¹‰ä¸ç›¸å…³çš„è¯ï¼ˆå¦‚â€œçŒ«â€å’Œâ€œæ±½è½¦â€ï¼‰åˆ™ä¼šè¾ƒä¸ºé¥è¿œã€‚</li></ul><h3 id="è¯åµŒå…¥å±‚å·¥ä½œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#è¯åµŒå…¥å±‚å·¥ä½œæµç¨‹"><span>è¯åµŒå…¥å±‚å·¥ä½œæµç¨‹</span></a></h3><ul><li><p><strong>åˆå§‹åŒ–è¯å‘é‡</strong>ï¼šè¯åµŒå…¥å±‚çš„åˆå§‹è¯å‘é‡é€šå¸¸ä¼šä½¿ç”¨éšæœºåˆå§‹åŒ–æˆ–è€…é€šè¿‡åŠ è½½é¢„è®­ç»ƒçš„è¯å‘é‡ï¼ˆå¦‚Word2Vecæˆ–GloVeï¼‰è¿›è¡Œåˆå§‹åŒ–ã€‚</p></li><li><p><strong>è¾“å…¥ç´¢å¼•</strong>ï¼šæ¯ä¸ªå•è¯åœ¨è¯æ±‡è¡¨ä¸­éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•ã€‚è¾“å…¥æ–‡æœ¬ï¼ˆä¾‹å¦‚ä¸€ä¸ªå¥å­ï¼‰ä¼šå…ˆè¢«åˆ†è¯ï¼Œç„¶åæ¯ä¸ªå•è¯ä¼šè¢«è½¬æ¢ä¸ºç›¸åº”çš„ç´¢å¼•ã€‚</p></li><li><p><strong>æŸ¥æ‰¾è¯å‘é‡</strong>ï¼šè¯åµŒå…¥å±‚å°†è¿™äº›å•è¯ç´¢å¼•æ˜ å°„ä¸ºå¯¹åº”çš„è¯å‘é‡ã€‚è¿™äº›è¯å‘é‡æ˜¯ä¸€ä¸ªä½ç»´ç¨ å¯†å‘é‡ï¼Œè¡¨ç¤ºè¯¥è¯çš„è¯­ä¹‰ã€‚</p></li><li><p><strong>è¾“å…¥åˆ°RNN</strong>ï¼šè¿™äº›è¯å‘é‡ä½œä¸ºRNNçš„è¾“å…¥ï¼ŒRNNå¤„ç†å®ƒä»¬å¹¶æ ¹æ®ä¸Šä¸‹æ–‡ç”Ÿæˆä¸€ä¸ªåºåˆ—çš„è¾“å‡ºã€‚</p></li></ul><h3 id="è¯åµŒå…¥å±‚ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#è¯åµŒå…¥å±‚ä½¿ç”¨"><span>è¯åµŒå…¥å±‚ä½¿ç”¨</span></a></h3><p>åœ¨PyTorchä¸­ï¼Œæˆ‘ä»¬å¯ä»¥<strong>ä½¿ç”¨ nn.Embedding è¯åµŒå…¥å±‚æ¥å®ç°è¾“å…¥è¯çš„å‘é‡åŒ–</strong>ã€‚</p><p>nn.Embedding å¯¹è±¡æ„å»ºæ—¶ï¼Œæœ€ä¸»è¦æœ‰ä¸¤ä¸ªå‚æ•°:</p><ul><li><p>num_embeddingsï¼šè¡¨ç¤º<strong>è¯çš„æ•°é‡</strong></p></li><li><p>embedding_dimï¼šè¡¨ç¤º<strong>ç”¨å¤šå°‘ç»´çš„å‘é‡æ¥è¡¨ç¤ºæ¯ä¸ªè¯</strong></p></li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Embedding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">num_embeddings</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">embedding_dim</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ å¦‚ä½•å°†è¯è½¬æ¢ä¸ºè¯å‘é‡ï¼Œå…¶æ­¥éª¤å¦‚ä¸‹:</p><ol><li>å…ˆå°†è¯­æ–™è¿›è¡Œåˆ†è¯ï¼Œæ„å»ºè¯ä¸ç´¢å¼•çš„æ˜ å°„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ˜ å°„å«åšè¯è¡¨ï¼Œè¯è¡¨ä¸­æ¯ä¸ªè¯éƒ½å¯¹åº”äº†ä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•ï¼›</li><li>ç„¶åä½¿ç”¨ nn.Embedding æ„å»ºè¯åµŒå…¥çŸ©é˜µï¼Œè¯ç´¢å¼•å¯¹åº”çš„å‘é‡å³ä¸ºè¯¥è¯å¯¹åº”çš„æ•°å€¼åŒ–åçš„å‘é‡è¡¨ç¤ºã€‚</li></ol><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„æ–‡æœ¬æ•°æ®ä¸º: &quot;åŒ—äº¬å†¬å¥¥çš„è¿›åº¦æ¡å·²ç»è¿‡åŠï¼Œä¸å°‘å¤–å›½è¿åŠ¨å‘˜åœ¨å®Œæˆè‡ªå·±çš„æ¯”èµ›åè¸ä¸Šå½’é€”ã€‚&quot;ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬çœ‹ä¸‹å¦‚ä½•ä½¿ç”¨è¯åµŒå…¥å±‚å°†å…¶è¿›è¡Œè½¬æ¢ä¸ºå‘é‡è¡¨ç¤ºï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> jieba </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># pip3 install jieba -i https://pypi.mirrors.ustc.edu.cn/simple/</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 0.æ–‡æœ¬æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    text </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;åŒ—äº¬å†¬å¥¥çš„è¿›åº¦æ¡å·²ç»è¿‡åŠï¼Œä¸å°‘å¤–å›½è¿åŠ¨å‘˜åœ¨å®Œæˆè‡ªå·±çš„æ¯”èµ›åè¸ä¸Šå½’é€”ã€‚&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 1. æ–‡æœ¬åˆ†è¯</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    words </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> jieba.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">lcut</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(text)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;æ–‡æœ¬åˆ†è¯:&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, words)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 2.åˆ†è¯å»é‡å¹¶ä¿ç•™åŸæ¥çš„é¡ºåºè·å–æ‰€æœ‰çš„è¯è¯­</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    unique_words </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> list</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">set</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(words))</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å»é‡åè¯çš„ä¸ªæ•°:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_words))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 3. æ„å»ºè¯åµŒå…¥å±‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # num_embeddings: è¡¨ç¤ºè¯çš„æ€»æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # embedding_dim: è¡¨ç¤ºè¯åµŒå…¥çš„ç»´åº¦</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    embed </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Embedding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">num_embeddings</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_words), </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">embedding_dim</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;è¯åµŒå…¥çš„ç»“æœï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,embed)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 4. è¯è¯­çš„è¯å‘é‡è¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i, word </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> enumerate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_words):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è·å¾—è¯åµŒå…¥å‘é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        word_vec </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> embed</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(i))</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%s</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\t</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> word, word_vec)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æ–‡æœ¬åˆ†è¯: [</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;åŒ—äº¬&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å†¬å¥¥&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;çš„&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;è¿›åº¦æ¡&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å·²ç»&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;è¿‡åŠ&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ï¼Œ&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ä¸å°‘&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å¤–å›½&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;è¿åŠ¨å‘˜&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;åœ¨&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å®Œæˆ&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;è‡ªå·±&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;çš„&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;æ¯”èµ›&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;è¸ä¸Š&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å½’é€”&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ã€‚&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å»é‡åè¯çš„ä¸ªæ•°:</span></span>
<span class="line"><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 18</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è¯åµŒå…¥çš„ç»“æœï¼š</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> Embedding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">18</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> åŒ—äº¬	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.8043</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.7860</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.7821</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.3167</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  çš„	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.4856</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5639</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2745</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.1087</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> å†¬å¥¥	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.6969</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5615</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.6524</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2651</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> è‡ªå·±	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.7163</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.9710</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0193</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.4562</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ä¸å°‘	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.8770</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0347</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.4939</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.6718</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> å½’é€”	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0619</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0355</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.6510</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.8121</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> æ¯”èµ›	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.7128</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0681</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2.4199</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2714</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è¿›åº¦æ¡	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.6706</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.4089</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5371</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.1093</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> å¤–å›½	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5665</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.3168</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2065</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.7682</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> å®Œæˆ	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.4640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2800</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2242</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.3790</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> è¿‡åŠ	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.8026</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.9831</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.7177</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.6779</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> è¸ä¸Š	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0745</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2610</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.5350</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.1767</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è¿åŠ¨å‘˜	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.8748</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2093</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.9471</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.3893</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ï¼Œ	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.2841</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0675</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.1263</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.6892</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  åœ¨	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.6202</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0106</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.0504</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0299</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> å·²ç»	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2.4461</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.2113</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.9387</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.1680</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  å	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.1989</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.8727</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.9484</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.0578</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  ã€‚	 </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.4020</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.7357</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.3571</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.2355</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">grad_fn</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=&lt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">EmbeddingBackward0</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å¾ªç¯ç½‘ç»œå±‚" tabindex="-1"><a class="header-anchor" href="#å¾ªç¯ç½‘ç»œå±‚"><span>å¾ªç¯ç½‘ç»œå±‚</span></a></h2><p>æ–‡æœ¬æ•°æ®æ˜¯å…·æœ‰åºåˆ—ç‰¹æ€§çš„ï¼Œä¾‹å¦‚: &quot;æˆ‘çˆ±ä½ &quot;, è¿™ä¸²æ–‡æœ¬å°±æ˜¯å…·æœ‰åºåˆ—å…³ç³»çš„ï¼Œ&quot;çˆ±&quot; éœ€è¦åœ¨ &quot;æˆ‘&quot; ä¹‹åï¼Œ&quot;ä½ &quot; éœ€è¦åœ¨ &quot;çˆ±&quot; ä¹‹å, å¦‚æœé¢ å€’äº†é¡ºåºï¼Œé‚£ä¹ˆå¯èƒ½å°±ä¼šè¡¨è¾¾ä¸åŒçš„æ„æ€ã€‚</p><p><strong>ä¸ºäº†è¡¨ç¤ºå‡ºæ•°æ®çš„åºåˆ—å…³ç³»</strong>ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨å¾ªç¯ç¥ç»ç½‘ç»œ(Recurrent Nearal Networks, RNN) æ¥å¯¹æ•°æ®è¿›è¡Œå»ºæ¨¡ï¼ŒRNN æ˜¯ä¸€ä¸ªå…·æœ‰è®°å¿†åŠŸèƒ½çš„ç½‘ç»œï¼Œå®ƒä½œç”¨äºå¤„ç†å¸¦æœ‰åºåˆ—ç‰¹ç‚¹çš„æ ·æœ¬æ•°æ®ã€‚</p><h3 id="rnnç½‘ç»œå±‚åŸç†" tabindex="-1"><a class="header-anchor" href="#rnnç½‘ç»œå±‚åŸç†"><span>RNNç½‘ç»œå±‚åŸç†</span></a></h3><p>å½“æˆ‘ä»¬å¸Œæœ›ä½¿ç”¨å¾ªç¯ç½‘ç»œæ¥å¯¹ &quot;æˆ‘çˆ±ä½ &quot; è¿›è¡Œè¯­ä¹‰æå–æ—¶ï¼ŒRNNè®¡ç®—è¿‡ç¨‹æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</p><img src="rnn/01.png" style="zoom:50%;"><p>ä¸Šå›¾ä¸­hè¡¨ç¤º<mark>éšè—çŠ¶æ€</mark>ï¼Œéšè—çŠ¶æ€ä¿å­˜äº†<strong>åºåˆ—æ•°æ®ä¸­çš„å†å²ä¿¡æ¯</strong>ï¼Œå¹¶å°†è¿™äº›ä¿¡æ¯ä¼ é€’ç»™ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œä»è€Œå…è®¸RNNå¤„ç†å’Œé¢„æµ‹åºåˆ—æ•°æ®ä¸­çš„å…ƒç´ ã€‚</p><p>æ¯ä¸€æ¬¡çš„è¾“å…¥éƒ½ä¼šåŒ…å«ä¸¤ä¸ªå€¼ï¼š<strong>ä¸Šä¸€ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€å½“å‰çŠ¶æ€çš„è¾“å…¥å€¼x</strong></p><p>æ¯ä¸€æ¬¡çš„è¾“å‡ºéƒ½ä¼šåŒ…å«ä¸¤ä¸ªå€¼ï¼š<strong>è¾“å‡ºå½“å‰æ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€å½“å‰æ—¶é—´æ­¥çš„é¢„æµ‹ç»“æœy</strong></p><p><strong>éšè—çŠ¶æ€ä½œç”¨ï¼š</strong></p><ul><li><p><strong>è®°å¿†åŠŸèƒ½</strong>ï¼šéšè—çŠ¶æ€å°±åƒRNNçš„è®°å¿†ï¼Œå®ƒèƒ½å¤Ÿåœ¨ä¸åŒçš„æ—¶é—´æ­¥ä¹‹é—´ä¼ é€’ä¿¡æ¯ã€‚å½“ä¸€ä¸ªæ–°çš„è¾“å…¥è¿›å…¥ç½‘ç»œæ—¶ï¼Œå½“å‰çš„éšè—çŠ¶æ€ä¼šç»“åˆè¿™ä¸ªæ–°è¾“å…¥æ¥ç”Ÿæˆæ–°çš„éšè—çŠ¶æ€ã€‚</p></li><li><p><strong>ä¸Šä¸‹æ–‡ç†è§£</strong>ï¼šç”±äºéšè—çŠ¶æ€æºå¸¦äº†è¿‡å»çš„ä¿¡æ¯ï¼Œå®ƒå¯ä»¥ç”¨äºç†è§£å’Œç”Ÿæˆä¸ä¸Šä¸‹æ–‡ç›¸å…³çš„è¾“å‡ºã€‚è¿™å¯¹äºè¯­è¨€æ¨¡å‹ã€æœºå™¨ç¿»è¯‘ç­‰ä»»åŠ¡å°¤å…¶é‡è¦ã€‚</p></li><li><p><strong>è¿æ¥ä¸åŒæ—¶é—´æ­¥</strong>ï¼šéšè—çŠ¶æ€é€šè¿‡ç½‘ç»œå†…éƒ¨çš„å¾ªç¯è¿æ¥å°†å„ä¸ªæ—¶é—´æ­¥è¿æ¥èµ·æ¥ï¼Œä½¿å¾—ç½‘ç»œå¯ä»¥å¤„ç†å˜é•¿çš„åºåˆ—æ•°æ®ã€‚</p></li></ul><p>ä¸Šå›¾ä¸­ï¼Œä¸ºäº†æ›´åŠ å®¹æ˜“ç†è§£ï¼Œè™½ç„¶ç”»äº† 3 ä¸ªç¥ç»å…ƒ, ä½†æ˜¯å®é™…ä¸Šåªæœ‰ä¸€ä¸ªç¥ç»å…ƒï¼Œ&quot;æˆ‘çˆ±ä½ &quot; ä¸‰ä¸ªå­—æ˜¯é‡å¤è¾“å…¥åˆ°åŒä¸€ä¸ªç¥ç»å…ƒä¸­ã€‚</p><figure><img src="/assets/img/RNN2.b483dcfe.gif" alt="RNN2" tabindex="0" loading="lazy"><figcaption>RNN2</figcaption></figure><p>æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­æ¥ç†è§£ä¸Šå›¾çš„å·¥ä½œè¿‡ç¨‹ï¼Œå‡è®¾æˆ‘ä»¬è¦å®ç°æ–‡æœ¬ç”Ÿæˆï¼Œä¹Ÿå°±æ˜¯è¾“å…¥ &quot;æˆ‘çˆ±&quot; è¿™ä¸¤ä¸ªå­—ï¼Œæ¥é¢„æµ‹å‡º &quot;ä½ &quot;ï¼Œå…¶å¦‚ä¸‹å›¾æ‰€ç¤º:</p><img src="rnn/02.png" style="zoom:50%;"><p>å°†ä¸Šå›¾å±•å¼€æˆä¸åŒæ—¶é—´æ­¥çš„å½¢å¼ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º:</p><img src="rnn/03.png" style="zoom:50%;"><p>é¦–å…ˆåˆå§‹åŒ–å‡ºç¬¬ä¸€ä¸ªéšè—çŠ¶æ€ï¼Œä¸€èˆ¬éƒ½æ˜¯å…¨0çš„ä¸€ä¸ªå‘é‡ï¼Œç„¶åå°† &quot;æˆ‘&quot; è¿›è¡Œè¯åµŒå…¥ï¼Œè½¬æ¢ä¸ºå‘é‡çš„è¡¨ç¤ºå½¢å¼ï¼Œé€å…¥åˆ°ç¬¬ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œç„¶åè¾“å‡ºéšè—çŠ¶æ€ h1ï¼Œç„¶åå°† h1 å’Œ &quot;çˆ±&quot; è¾“å…¥åˆ°ç¬¬äºŒä¸ªæ—¶é—´æ­¥ï¼Œå¾—åˆ°éšè—çŠ¶æ€ h2, å°† h2 é€å…¥åˆ°å…¨è¿æ¥ç½‘ç»œï¼Œå¾—åˆ° &quot;ä½ &quot; çš„é¢„æµ‹æ¦‚ç‡ã€‚</p><p><strong>RNNç¥ç»å…ƒå†…éƒ¨æ˜¯å¦‚ä½•è®¡ç®—çš„å‘¢ï¼Ÿ</strong></p><p>**1. è®¡ç®—éšè—çŠ¶æ€ï¼š**æ¯ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€$$h_t$$æ˜¯æ ¹æ®å½“å‰è¾“å…¥$$x_t$$å’Œå‰ä¸€æ—¶åˆ»çš„éšè—çŠ¶æ€$$h_{t-1}$$è®¡ç®—çš„ã€‚</p><img src="rnn/05.png" style="zoom:50%;"><img src="rnn/1734749643694.png" style="zoom:75%;"><p>ä¸Šè¿°å…¬å¼ä¸­:</p><ul><li>$W_{ih}$ è¡¨ç¤ºè¾“å…¥æ•°æ®çš„æƒé‡</li><li>$b_{ih}$ è¡¨ç¤ºè¾“å…¥æ•°æ®çš„åç½®</li><li>$W_{hh}$ è¡¨ç¤ºè¾“å…¥éšè—çŠ¶æ€çš„æƒé‡</li><li>$b_{hh}$ è¡¨ç¤ºè¾“å…¥éšè—çŠ¶æ€çš„åç½®</li><li>$h_{t-1}$ è¡¨ç¤ºè¾“å…¥éšè—çŠ¶æ€</li><li>$h_t$ è¡¨ç¤ºè¾“å‡ºéšè—çŠ¶æ€</li></ul><p>æœ€åå¯¹è¾“å‡ºçš„ç»“æœä½¿ç”¨tanhæ¿€æ´»å‡½æ•°è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°è¯¥ç¥ç»å…ƒä½ çš„è¾“å‡ºéšè—çŠ¶æ€ã€‚</p><p>**2. è®¡ç®—å½“å‰æ—¶åˆ»çš„è¾“å‡ºï¼š**ç½‘ç»œçš„è¾“å‡º$$y_t$$æ˜¯å½“å‰æ—¶åˆ»çš„éšè—çŠ¶æ€ç»è¿‡ä¸€ä¸ªçº¿æ€§å˜æ¢å¾—åˆ°çš„ã€‚</p><p>â€‹ $$y_t=W_{hy}h_t+b_yâ€‹$$</p><ul><li>$$y_tâ€‹$$ æ˜¯å½“å‰æ—¶åˆ»çš„è¾“å‡ºï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªå‘é‡ï¼Œè¡¨ç¤ºå½“å‰æ—¶åˆ»çš„é¢„æµ‹å€¼ï¼ŒRNNå±‚çš„é¢„æµ‹å€¼ï¼‰</li><li>$$h_tâ€‹$$ æ˜¯å½“å‰æ—¶åˆ»çš„éšè—çŠ¶æ€</li><li>$$W_{hy}$$ æ˜¯ä»éšè—çŠ¶æ€åˆ°è¾“å‡ºçš„æƒé‡çŸ©é˜µ</li><li>$$b_y$$ æ˜¯è¾“å‡ºå±‚çš„åç½®é¡¹</li></ul><p><strong>3. è¯æ±‡è¡¨æ˜ å°„</strong>ï¼šè¾“å‡º$$y_t$$æ˜¯ä¸€ä¸ª<strong>å‘é‡</strong>ï¼Œè¯¥å‘é‡ç»è¿‡<strong>å…¨è¿æ¥å±‚</strong>åè¾“å‡ºå¾—åˆ°æœ€ç»ˆé¢„æµ‹ç»“æœ$$y_{pred}$$ï¼Œ$$y_{pred}$$ä¸­æ¯ä¸ªå…ƒç´ ä»£è¡¨å½“å‰æ—¶åˆ»ç”Ÿæˆè¯æ±‡è¡¨ä¸­æŸä¸ªè¯çš„å¾—åˆ†ï¼ˆæˆ–æ¦‚ç‡ï¼Œé€šè¿‡æ¿€æ´»å‡½æ•°ï¼šå¦‚<strong>softmax</strong>ï¼‰ã€‚<mark>è¯æ±‡è¡¨æœ‰å¤šå°‘ä¸ªè¯ï¼Œ$$y_{pred}$$å°±æœ‰å¤šå°‘ä¸ªå…ƒç´ å€¼ï¼Œæœ€å¤§å…ƒç´ å€¼å¯¹åº”çš„è¯å°±æ˜¯å½“å‰æ—¶åˆ»é¢„æµ‹ç”Ÿæˆçš„è¯ã€‚</mark></p><p><strong>ç¥ç»å…ƒå·¥ä½œæœºåˆ¶æ€»ç»“ï¼š</strong></p><ul><li><p><strong>æ¥æ”¶è¾“å…¥</strong>ï¼šæ¯ä¸ªRNNç¥ç»å…ƒæ¥æ”¶æ¥è‡ªè¾“å…¥æ•°æ®$$x_t$$å’Œå‰ä¸€æ—¶åˆ»çš„éšè—çŠ¶æ€$$h_{t-1}$$ã€‚</p></li><li><p><strong>æ›´æ–°éšè—çŠ¶æ€</strong>ï¼šç¥ç»å…ƒé€šè¿‡ä¸€ä¸ªåŠ æƒå’Œï¼ˆç”±æƒé‡çŸ©é˜µå’Œåç½®é¡¹ç»„æˆï¼‰æ›´æ–°å½“å‰æ—¶åˆ»çš„éšè—çŠ¶æ€$$h_tâ€‹$$ï¼Œè¯¥éšè—çŠ¶æ€åŒ…å«äº†æ¥è‡ªè¿‡å»çš„è®°å¿†ä»¥åŠå½“å‰è¾“å…¥çš„ä¿¡æ¯ã€‚</p></li><li><p><strong>è¾“å‡ºè®¡ç®—</strong>ï¼šåŸºäºå½“å‰éšè—çŠ¶æ€$$h_tâ€‹$$ï¼Œç¥ç»å…ƒç”Ÿæˆå½“å‰æ—¶åˆ»çš„è¾“å‡º$$y_tâ€‹$$ï¼Œè¯¥è¾“å‡ºå¯ä»¥ç”¨äºä»»åŠ¡çš„æœ€ç»ˆé¢„æµ‹ã€‚</p><img src="rnn/1735401373292.png" style="zoom:75%;"></li></ul><p><strong>æ–‡æœ¬ç”Ÿæˆç¤ºä¾‹ï¼š</strong></p><p>å‡è®¾æˆ‘ä»¬ä½¿ç”¨RNNè¿›è¡Œ<strong>æ–‡æœ¬ç”Ÿæˆ</strong>ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªåˆå§‹è¯è¯­æˆ–ä¸€æ®µä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚ï¼Œâ€œmâ€ï¼‰ã€‚RNNä¼šé€šè¿‡éšè—çŠ¶æ€é€æ­¥ç”Ÿæˆä¸‹ä¸€ä¸ªè¯çš„æ¦‚ç‡åˆ†å¸ƒï¼Œç„¶åæ ¹æ®æ¦‚ç‡é€‰æ‹©æœ€å¯èƒ½çš„ä¸‹ä¸€ä¸ªè¯ã€‚</p><figure><img src="/assets/img/1735443424646.4e9dbc8c.png" alt="1735443424646" tabindex="0" loading="lazy"><figcaption>1735443424646</figcaption></figure><ol><li><p>è¾“å…¥ï¼šâ€œmâ€ â†’ è¯å‘é‡è¾“å…¥$$x_1$$ï¼ˆå¯¹åº”â€œmâ€ï¼‰</p></li><li><p>åˆå§‹åŒ–éšè—çŠ¶æ€$$h_0â€‹$$ï¼Œä¸€èˆ¬åˆå§‹å€¼ä¸º0</p></li><li><p>éšè—çŠ¶æ€æ›´æ–°$$h_1â€‹$$ï¼Œå¹¶è®¡ç®—è¾“å‡º$$y_1â€‹$$</p></li><li><p>ç»è¿‡å…¨è¿æ¥å±‚è¾“å‡ºå±‚è®¡ç®—è¾“å‡º$$y_{pred}â€‹$$ï¼Œä½¿ç”¨softmaxå‡½æ•°å°†$$y_{pred}â€‹$$è½¬æ¢ä¸ºæ¦‚ç‡åˆ†å¸ƒ</p></li><li><p>é€‰æ‹©æ¦‚ç‡æœ€é«˜çš„è¯ä½œä¸ºè¾“å‡ºè¯ï¼ˆä¾‹å¦‚â€œaâ€ï¼‰</p></li><li><p>è¾“å…¥æ–°çš„è¯â€œaâ€ï¼Œç»§ç»­å¤„ç†ä¸‹ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œç›´åˆ°ç”Ÿæˆå®Œæ•´çš„è¯æˆ–å¥å­</p></li></ol><p>**å°ç»“ï¼š**åœ¨å¾ªç¯ç¥ç»ç½‘ç»œä¸­ï¼Œ<strong>è¯ä¸è¾“å‡ºçš„å¯¹åº”å…³ç³»</strong>é€šå¸¸é€šè¿‡ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤å»ºç«‹</p><ol><li><strong>è¯åµŒå…¥</strong>ï¼šå°†è¯è½¬åŒ–ä¸ºå‘é‡è¡¨ç¤ºï¼ˆè¯å‘é‡ï¼‰ã€‚</li><li><strong>RNNå¤„ç†</strong>ï¼šé€šè¿‡RNNå±‚é€æ­¥å¤„ç†è¯å‘é‡ï¼Œç”Ÿæˆæ¯ä¸ªæ—¶é—´æ­¥çš„éšè—çŠ¶æ€ã€‚</li><li><strong>è¾“å‡ºæ˜ å°„</strong>ï¼šé€šè¿‡çº¿æ€§å˜æ¢å°†éšè—çŠ¶æ€æ˜ å°„åˆ°è¾“å‡ºï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªè¯æ±‡è¡¨ä¸­çš„è¯çš„æ¦‚ç‡åˆ†å¸ƒã€‚</li></ol><h3 id="pytorch-rnnå±‚çš„ä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#pytorch-rnnå±‚çš„ä½¿ç”¨"><span>PyTorch RNNå±‚çš„ä½¿ç”¨</span></a></h3><ul><li><p>APIä»‹ç»</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">RNN</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">RNN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(input_size, hidden_sizeï¼Œnum_layers)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>å‚æ•°æ„ä¹‰æ˜¯ï¼š</p><ul><li>input_sizeï¼šè¾“å…¥æ•°æ®çš„ç»´åº¦ï¼Œä¸€èˆ¬è®¾ä¸ºè¯å‘é‡çš„ç»´åº¦</li><li>hidden_sizeï¼šéšè—å±‚hçš„ç»´åº¦ï¼Œä¹Ÿæ˜¯å½“å‰å±‚ç¥ç»å…ƒçš„è¾“å‡ºç»´åº¦</li><li>num_layers: éšè—å±‚hçš„å±‚æ•°ï¼Œé»˜è®¤ä¸º1</li></ul></li><li><p>è¾“å…¥æ•°æ®å’Œè¾“å‡ºç»“æœ</p><p>å°†RNNå®ä¾‹åŒ–å°±å¯ä»¥å°†æ•°æ®é€å…¥å…¶ä¸­è¿›è¡Œå¤„ç†ï¼Œå¤„ç†çš„æ–¹å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">output, hn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> RNN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x, h0)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><ul><li><strong>è¾“å…¥æ•°æ®ï¼šä¸»è¦åŒ…æ‹¬è¯åµŒå…¥çš„x ã€åˆå§‹çš„éšè—å±‚h0</strong><ul><li>xçš„è¡¨ç¤ºå½¢å¼ä¸º[seq_len, batch, input_size]ï¼Œå³[å¥å­çš„é•¿åº¦ï¼Œbatchçš„å¤§å°ï¼Œè¯å‘é‡çš„ç»´åº¦]</li><li>h0çš„è¡¨ç¤ºå½¢å¼ä¸º[num_layers, batch, hidden_size]ï¼Œå³[éšè—å±‚çš„å±‚æ•°ï¼Œbatchçš„å¤§å°ï¼Œéšè—å±‚hçš„ç»´åº¦]</li></ul></li><li><strong>è¾“å‡ºç»“æœï¼šä¸»è¦åŒ…æ‹¬è¾“å‡ºç»“æœoutput,æœ€åä¸€å±‚çš„hn</strong><ul><li>outputçš„è¡¨ç¤ºå½¢å¼ä¸è¾“å…¥xç±»ä¼¼ï¼Œä¸º[seq_len, batch, input_size]ï¼Œå³[å¥å­çš„é•¿åº¦ï¼Œbatchçš„å¤§å°ï¼Œè¾“å‡ºå‘é‡çš„ç»´åº¦]</li><li>hnçš„è¡¨ç¤ºå½¢å¼ä¸è¾“å…¥h0ä¸€æ ·ï¼Œä¸º[num_layers, batch, hidden_size]ï¼Œå³[éšè—å±‚çš„å±‚æ•°ï¼Œbatchçš„å¤§ï¼Œéšè—å±‚hçš„ç»´åº¦]</li></ul></li></ul></li><li><p>APIä½¿ç”¨</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">#  RNNå±‚é€å…¥æ‰¹é‡æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è¯å‘é‡ç»´åº¦ 128, éšè—å‘é‡ç»´åº¦(å¤§è„‘èƒ½è®°ä½çš„å‰§æƒ…ä¿¡æ¯) 256</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    rnn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">RNN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">input_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">128</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">hidden_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ç¬¬ä¸€ä¸ªæ•°å­—: è¡¨ç¤ºå¥å­é•¿åº¦,ä¹Ÿå°±æ˜¯è¯è¯­ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ç¬¬äºŒä¸ªæ•°å­—: æ‰¹é‡ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯å¥å­çš„ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ç¬¬ä¸‰ä¸ªæ•°å­—: è¯å‘é‡ç»´åº¦</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    inputs </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">randn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">128</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ç¬¬ä¸€ä¸ªæ•°å­—: RNNçš„å±‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ç¬¬äºŒä¸ªæ•°å­—: å¥å­çš„ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ç¬¬ä¸‰ä¸ªæ•°å­—: éšè—çŠ¶æ€å‘é‡çº¬åº¦</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    hn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">zeros</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è·å–è¾“å‡ºç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    output, hn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> rnn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(inputs, hn)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;è¾“å‡ºå‘é‡çš„ç»´åº¦ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,output.shape)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;éšè—å±‚è¾“å‡ºçš„ç»´åº¦ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,hn.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è¾“å‡ºå‘é‡çš„ç»´åº¦ï¼š</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">éšè—å±‚è¾“å‡ºçš„ç»´åº¦ï¼š</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="æ–‡æœ¬ç”Ÿæˆæ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#æ–‡æœ¬ç”Ÿæˆæ¡ˆä¾‹"><span>æ–‡æœ¬ç”Ÿæˆæ¡ˆä¾‹</span></a></h2><p>æ–‡æœ¬ç”Ÿæˆä»»åŠ¡æ˜¯ä¸€ç§å¸¸è§çš„è‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ï¼Œè¾“å…¥ä¸€ä¸ªå¼€å§‹è¯èƒ½å¤Ÿé¢„æµ‹å‡ºåé¢çš„è¯åºåˆ—ã€‚æœ¬æ¡ˆä¾‹å°†ä¼šä½¿ç”¨å¾ªç¯ç¥ç»ç½‘ç»œæ¥å®ç°å‘¨æ°ä¼¦æ­Œè¯ç”Ÿæˆä»»åŠ¡ã€‚</p><img src="rnn/1734750013375.png" style="zoom:75%;"><h3 id="å¯¼å…¥å·¥å…·åŒ…" tabindex="-1"><a class="header-anchor" href="#å¯¼å…¥å·¥å…·åŒ…"><span>å¯¼å…¥å·¥å…·åŒ…</span></a></h3><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> jieba</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.utils.data </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> DataLoader</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.optim </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> optim</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ•°æ®é›†" tabindex="-1"><a class="header-anchor" href="#æ•°æ®é›†"><span>æ•°æ®é›†</span></a></h3><p>æˆ‘ä»¬æ”¶é›†äº†å‘¨æ°ä¼¦ä»ç¬¬ä¸€å¼ ä¸“è¾‘ã€ŠJayã€‹åˆ°ç¬¬åå¼ ä¸“è¾‘ã€Šè·¨æ—¶ä»£ã€‹ä¸­çš„æ­Œè¯ï¼Œæ¥è®­ç»ƒç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œå½“æ¨¡å‹è®­ç»ƒå¥½åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ªæ¨¡å‹æ¥åˆ›ä½œæ­Œè¯ã€‚æ•°æ®é›†å¦‚ä¸‹ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æƒ³è¦æœ‰ç›´å‡æœº</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æƒ³è¦å’Œä½ é£åˆ°å®‡å®™å»</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æƒ³è¦å’Œä½ èåŒ–åœ¨ä¸€èµ·</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">èåŒ–åœ¨å®‡å®™é‡Œ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æˆ‘æ¯å¤©æ¯å¤©æ¯å¤©åœ¨æƒ³æƒ³æƒ³æƒ³è‘—ä½ </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è¿™æ ·çš„ç”œèœœ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è®©æˆ‘å¼€å§‹ç›¸ä¿¡å‘½è¿</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æ„Ÿè°¢åœ°å¿ƒå¼•åŠ›</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è®©æˆ‘ç¢°åˆ°ä½ </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æ¼‚äº®çš„è®©æˆ‘é¢çº¢çš„å¯çˆ±å¥³äºº</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¯¥æ•°æ®é›†å…±æœ‰ 5819 è¡Œæ–‡æœ¬ã€‚</p><h3 id="æ„å»ºè¯è¡¨" tabindex="-1"><a class="header-anchor" href="#æ„å»ºè¯è¡¨"><span>æ„å»ºè¯è¡¨</span></a></h3><p>åœ¨è¿›è¡Œè‡ªç„¶è¯­è¨€å¤„ç†ä»»åŠ¡ä¹‹å‰ï¼Œé¦–è¦åšçš„å°±æ˜¯æ„å»ºè¯è¡¨ã€‚</p><p>æ‰€è°“çš„è¯è¡¨å°±æ˜¯å°†è¯­æ–™è¿›è¡Œåˆ†è¯ï¼Œç„¶åç»™æ¯ä¸€ä¸ªè¯åˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ç¼–å·ï¼Œä¾¿äºæˆ‘ä»¬é€å…¥è¯åµŒå…¥å±‚ã€‚</p><img src="rnn/1734750711996.png" style="zoom:75%;"><p>æ¥ä¸‹æ¥, æˆ‘ä»¬å¯¹å‘¨æ°ä¼¦æ­Œè¯çš„æ•°æ®è¿›è¡Œå¤„ç†æ„å»ºè¯è¡¨ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š</p><ul><li>è·å–æ–‡æœ¬æ•°æ®</li><li>åˆ†è¯ï¼Œå¹¶è¿›è¡Œå»é‡</li><li>æ„å»ºè¯è¡¨</li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è·å–æ•°æ®ï¼Œå¹¶è¿›è¡Œåˆ†è¯ï¼Œæ„å»ºè¯è¡¨</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> build_vocab</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ•°æ®é›†ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    file_name </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;data/jaychou_lyrics.txt&#39;</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # åˆ†è¯ç»“æœå­˜å‚¨ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å”¯ä¸€è¯åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    unique_words </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ¯è¡Œæ–‡æœ¬åˆ†è¯åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    all_words </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # éå†æ•°æ®é›†ä¸­çš„æ¯ä¸€è¡Œæ–‡æœ¬</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> line </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> open</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(file_name, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;r&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">encoding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;utf-8&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ä½¿ç”¨jiebaåˆ†è¯,åˆ†å‰²ç»“æœæ˜¯ä¸€ä¸ªåˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        words </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> jieba.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">lcut</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(line)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # print(words)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # æ‰€æœ‰çš„åˆ†è¯ç»“æœå­˜å‚¨åˆ°all_wordsï¼Œå…¶ä¸­åŒ…å«é‡å¤çš„è¯ç»„</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        all_words.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(words)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # éå†åˆ†è¯ç»“æœï¼Œå»é‡åå­˜å‚¨åˆ°unique_words</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> word </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> words:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> word </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">not</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> unique_words:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                unique_words.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(word)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è¯­æ–™ä¸­è¯çš„æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    word_count </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_words)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è¯åˆ°ç´¢å¼•æ˜ å°„</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    word_to_index </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {word: idx </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> idx, word </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> enumerate</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_words)}</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ­Œè¯æ–‡æœ¬ç”¨è¯è¡¨ç´¢å¼•è¡¨ç¤º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    corpus_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # éå†æ¯ä¸€è¡Œçš„åˆ†è¯ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> words </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> all_words:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        temp </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> []</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è·å–æ¯ä¸€è¡Œçš„è¯ï¼Œå¹¶è·å–ç›¸åº”çš„ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> word </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> words:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            temp.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(word_to_index[word])</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # åœ¨æ¯è¡Œè¯ä¹‹é—´æ·»åŠ ç©ºæ ¼éš”å¼€</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        temp.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(word_to_index[</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39; &#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è·å–å½“å‰æ–‡æ¡£ä¸­æ¯ä¸ªè¯å¯¹åº”çš„ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        corpus_idx.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">extend</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(temp)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> unique_words, word_to_index, word_count, corpus_idx</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è·å–æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    unique_words, word_to_index, unique_word_count, corpus_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> build_vocab</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;è¯çš„æ•°é‡ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,unique_word_count)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å»é‡åçš„è¯:</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,unique_words)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;æ¯ä¸ªè¯çš„ç´¢å¼•ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,word_to_index)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å½“å‰æ–‡æ¡£ä¸­æ¯ä¸ªè¯å¯¹åº”çš„ç´¢å¼•ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,corpus_idx)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬çš„è¯å…¸ä¸»è¦åŒ…å«äº†:</p><ul><li><p>unique_words: å­˜å‚¨äº†æ¯ä¸ªè¯</p></li><li><p>word_to_index: å­˜å‚¨äº†è¯åˆ°ç¼–å·çš„æ˜ å°„</p><img src="rnn/1734751188623.png" style="zoom:75%;"></li></ul><h3 id="æ„å»ºæ•°æ®é›†å¯¹è±¡" tabindex="-1"><a class="header-anchor" href="#æ„å»ºæ•°æ®é›†å¯¹è±¡"><span>æ„å»ºæ•°æ®é›†å¯¹è±¡</span></a></h3><p>æˆ‘ä»¬åœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œä¸ºäº†ä¾¿äºè¯»å–è¯­æ–™ï¼Œå¹¶é€å…¥ç½‘ç»œï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šæ„å»ºä¸€ä¸ªDatasetå¯¹è±¡</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> LyricsDataset</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">torch</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">utils</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">data</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Dataset</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> corpus_idx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> num_chars</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# æ–‡æ¡£æ•°æ®ä¸­è¯çš„ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.corpus_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> corpus_idx</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# æ¯ä¸ªå¥å­ä¸­è¯çš„ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.num_chars </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> num_chars</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# æ–‡æ¡£æ•°æ®ä¸­è¯çš„æ•°é‡ï¼Œä¸å»é‡</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.word_count </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.corpus_idx)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# å¥å­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.number </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.word_count </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">//</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.num_chars</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# len(obj)æ—¶è‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __len__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# è¿”å›å¥å­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.number</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# obj[idx]æ—¶è‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __getitem__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> idx</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# idxæŒ‡è¯çš„ç´¢å¼•ï¼Œå¹¶å°†å…¶ä¿®æ­£ç´¢å¼•å€¼åˆ°æ–‡æ¡£çš„èŒƒå›´é‡Œé¢</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		æˆ‘ çˆ±ä½  ä¸­å›½ , äº²çˆ± çš„ æ¯äº²</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		word_count: 7</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		num_chars: 2 ä¸€ä¸ªå¥å­ç”±num_charsä¸ªè¯ç»„æˆ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		word_count-num_chars-2: 7-2-1=4  -1:ç½‘ç»œé¢„æµ‹ç»“æœyåœ¨xä¸Šåç§»ä¸€ä¸ªè¯å–å€¼-1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		idx=5-&gt;start=4</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">		&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		start </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> min</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">max</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(idx, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.word_count </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.num_chars </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		end </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> start </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.num_chars</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# è¾“å…¥å€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.corpus_idx[start: end]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# ç½‘ç»œé¢„æµ‹ç»“æœï¼ˆç›®æ ‡å€¼ï¼‰</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		y </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.corpus_idx[start </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: end </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# è¿”å›ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x), torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(y)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# è·å–æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	unique_words, word_to_index, unique_word_count, corpus_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> build_vocab</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# æ•°æ®è·å–å®ä¾‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	dataset </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> LyricsDataset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(corpus_idx, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# æŸ¥çœ‹å¥å­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">	print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å¥å­æ•°é‡ï¼š&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(dataset))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# x, y = dataset.__getitem__(0)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	x, y </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dataset[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">	print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;ç½‘ç»œè¾“å…¥å€¼ï¼š&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, x)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">	print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;ç›®æ ‡å€¼ï¼š&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, y)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å¥å­æ•°é‡ï¼š </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">9827</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ç½‘ç»œè¾“å…¥å€¼ï¼š </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">40</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ç›®æ ‡å€¼ï¼š </span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">40</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ„å»ºç½‘ç»œæ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#æ„å»ºç½‘ç»œæ¨¡å‹"><span>æ„å»ºç½‘ç»œæ¨¡å‹</span></a></h3><p>æˆ‘ä»¬ç”¨äºå®ç°ã€Šæ­Œè¯ç”Ÿæˆã€‹çš„ç½‘ç»œæ¨¡å‹ï¼Œä¸»è¦åŒ…å«äº†ä¸‰ä¸ªå±‚:</p><ul><li><p>è¯åµŒå…¥å±‚: ç”¨äºå°†è¯­æ–™è½¬æ¢ä¸ºè¯å‘é‡</p></li><li><p>å¾ªç¯ç½‘ç»œå±‚: æå–å¥å­è¯­ä¹‰</p></li><li><p>å…¨è¿æ¥å±‚: è¾“å‡ºå¯¹è¯å…¸ä¸­æ¯ä¸ªè¯çš„é¢„æµ‹æ¦‚ç‡</p></li></ul><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¨¡å‹æ„å»º</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> TextGenerator</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">nn</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Module</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> unique_word_count</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(TextGenerator, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # åˆå§‹åŒ–è¯åµŒå…¥å±‚: è¯­æ–™ä¸­è¯çš„æ•°é‡, è¯å‘é‡çš„ç»´åº¦ä¸º128</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.ebd </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Embedding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_word_count, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">128</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å¾ªç¯ç½‘ç»œå±‚: è¯å‘é‡ç»´åº¦128, éšè—å‘é‡ç»´åº¦256, ç½‘ç»œå±‚æ•°1</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.rnn </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">RNN</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">128</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è¾“å‡ºå±‚: ç‰¹å¾å‘é‡ç»´åº¦256ä¸éšè—å‘é‡ç»´åº¦ç›¸åŒ, è¯è¡¨ä¸­è¯çš„ä¸ªæ•°</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.out </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, unique_word_count)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> forward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> inputs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> hidden</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è¾“å‡ºç»´åº¦: (batch, seq_len, è¯å‘é‡ç»´åº¦128)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # batchï¼šå¥å­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # seq_lenï¼š å¥å­é•¿åº¦ï¼Œ æ¯ä¸ªå¥å­ç”±å¤šå°‘ä¸ªè¯ è¯æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        embed </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">ebd</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(inputs)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # rnnå±‚xçš„è¡¨ç¤ºå½¢å¼ä¸º(seq_len, batch, è¯å‘é‡ç»´åº¦128)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # outputçš„è¡¨ç¤ºå½¢å¼ä¸è¾“å…¥xç±»ä¼¼ï¼Œä¸º(seq_len, batch, è¯å‘é‡ç»´åº¦256)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å‰åçš„hiddenå½¢çŠ¶è¦ä¸€æ ·, æ‰€ä»¥DataLoaderåŠ è½½å™¨çš„batchæ•°è¦èƒ½è¢«æ•´æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        output, hidden </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">rnn</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(embed.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), hidden)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å…¨è¿æ¥å±‚è¾“å…¥äºŒç»´æ•°æ®ï¼Œ è¯æ•°é‡*è¯ç»´åº¦</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è¾“å…¥ç»´åº¦: (seq_len*batch, è¯å‘é‡ç»´åº¦256) </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è¾“å‡ºç»´åº¦: (seq_len*batch, è¯­æ–™ä¸­è¯çš„æ•°é‡)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # output: æ¯ä¸ªè¯çš„åˆ†å€¼åˆ†å¸ƒï¼Œåç»­ç»“åˆsoftmaxè¾“å‡ºæ¦‚ç‡åˆ†å¸ƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        output </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">reshape</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">shape</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, output.shape[</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç½‘ç»œè¾“å‡ºç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> output, hidden</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> init_hidden</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> bs</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # éšè—å±‚çš„åˆå§‹åŒ–:[ç½‘ç»œå±‚æ•°, batch, éšè—å±‚å‘é‡ç»´åº¦]</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">zeros</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, bs, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">256</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# è·å–æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	unique_words, word_to_index, unique_word_count, corpus_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> build_vocab</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> TextGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_word_count)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> named, parameter </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">named_parameters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">		print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(named)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">		print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(parameter)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ„å»ºè®­ç»ƒå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#æ„å»ºè®­ç»ƒå‡½æ•°"><span>æ„å»ºè®­ç»ƒå‡½æ•°</span></a></h3><p>å‰é¢çš„å‡†å¤‡å·¥ä½œå®Œæˆä¹‹å, æˆ‘ä»¬å°±å¯ä»¥ç¼–å†™è®­ç»ƒå‡½æ•°ã€‚è®­ç»ƒå‡½æ•°ä¸»è¦è´Ÿè´£ç¼–å†™æ•°æ®è¿­ä»£ã€é€å…¥ç½‘ç»œã€è®¡ç®—æŸå¤±ã€åå‘ä¼ æ’­ã€æ›´æ–°å‚æ•°ï¼Œå…¶æµç¨‹åŸºæœ¬è¾ƒä¸ºå›ºå®šã€‚</p><p>ç”±äºæˆ‘ä»¬è¦å®ç°æ–‡æœ¬ç”Ÿæˆï¼Œæ–‡æœ¬ç”Ÿæˆæœ¬è´¨ä¸Šï¼Œè¾“å…¥ä¸€ä¸²æ–‡æœ¬ï¼Œé¢„æµ‹ä¸‹ä¸€ä¸ªæ–‡æœ¬ï¼Œä¹Ÿå±äºåˆ†ç±»é—®é¢˜ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬ä½¿ç”¨å¤šåˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°ã€‚ä¼˜åŒ–æ–¹æ³•æˆ‘ä»¬å­¦ä¹ è¿‡ SGBã€AdaGradã€Adam ç­‰ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬é€‰æ‹©å­¦ä¹ ç‡ã€æ¢¯åº¦è‡ªé€‚åº”çš„ Adam ç®—æ³•ä½œä¸ºæˆ‘ä»¬çš„ä¼˜åŒ–æ–¹æ³•ã€‚</p><p>è®­ç»ƒå®Œæˆä¹‹åï¼Œæˆ‘ä»¬ä½¿ç”¨ torch.save æ–¹æ³•å°†æ¨¡å‹æŒä¹…åŒ–å­˜å‚¨ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> train</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# æ„å»ºè¯å…¸</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	unique_words, word_to_index, unique_word_count, corpus_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> build_vocab</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# æ•°æ®é›† LyricsDatasetå¯¹è±¡ï¼Œå¹¶å®ç°äº† __getitem__ æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	lyrics </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> LyricsDataset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">corpus_idx</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">corpus_idx, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">num_chars</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# æŸ¥çœ‹å¥å­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# print(lyrics.number)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# åˆå§‹åŒ–æ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> TextGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_word_count)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# æ•°æ®åŠ è½½å™¨ DataLoaderå¯¹è±¡ï¼Œå¹¶å°†lyrics datasetå¯¹è±¡ä¼ é€’ç»™å®ƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	lyrics_dataloader </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> DataLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(lyrics, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">shuffle</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">batch_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# æŸå¤±å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	criterion </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">CrossEntropyLoss</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# ä¼˜åŒ–æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	optimizer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> optim.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Adam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">parameters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">lr</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1e-3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# è®­ç»ƒè½®æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	epoch </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 10</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> epoch_idx </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(epoch):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# è®­ç»ƒæ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		start </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		iter_num </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # è¿­ä»£æ¬¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# è®­ç»ƒæŸå¤±</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		total_loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# éå†æ•°æ®é›† DataLoader ä¼šåœ¨åå°è°ƒç”¨ dataset.__getitem__(index) æ¥è·å–æ¯ä¸ªæ ·æœ¬çš„æ•°æ®å’Œæ ‡ç­¾ï¼Œå¹¶å°†å®ƒä»¬ç»„åˆæˆä¸€ä¸ª batch</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x, y </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> lyrics_dataloader:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			# éšè—çŠ¶æ€çš„åˆå§‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			hidden </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">init_hidden</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">bs</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			# æ¨¡å‹è®¡ç®—</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			output, hidden </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x, hidden)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			# è®¡ç®—æŸå¤±</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">			# yå½¢çŠ¶ä¸º(batch, seq_len), éœ€è¦è½¬æ¢æˆä¸€ç»´å‘é‡-&gt;160ä¸ªè¯çš„ä¸‹æ ‡ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # outputå½¢çŠ¶ä¸º(seq_len, batch, è¯å‘é‡ç»´åº¦)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # éœ€è¦å…ˆå°†yè¿›è¡Œç»´åº¦äº¤æ¢(å’Œoutputä¿æŒä¸€è‡´)å†æ”¹å˜å½¢çŠ¶</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            y </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">transpose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(y, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">reshape</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">shape</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> criterion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output, y)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			optimizer.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">zero_grad</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			loss.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">backward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			optimizer.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">step</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			iter_num </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # è¿­ä»£æ¬¡æ•°åŠ 1</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			total_loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">item</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# æ‰“å°è®­ç»ƒä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">		print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;epoch </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%3s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%.5f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%.2f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (epoch_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, total_loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> iter_num, time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> start))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# æ¨¡å‹å­˜å‚¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">state_dict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;model/lyrics_model_</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%d</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">.pth&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> epoch)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;__main__&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">	train</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.84424</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.75</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.21154</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.91</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.12014</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.85</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.10625</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.73</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.10226</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.58</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.10009</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.65</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.09942</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.66</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.09783</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.66</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch   </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.09663</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.75</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.09568</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5.77</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ„å»ºé¢„æµ‹å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#æ„å»ºé¢„æµ‹å‡½æ•°"><span>æ„å»ºé¢„æµ‹å‡½æ•°</span></a></h3><p>ä»ç£ç›˜åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œè¿›è¡Œé¢„æµ‹ã€‚é¢„æµ‹å‡½æ•°ï¼Œè¾“å…¥ç¬¬ä¸€ä¸ªæŒ‡å®šçš„è¯ï¼Œæˆ‘ä»¬å°†è¯¥è¯è¾“å…¥ç½‘è·¯ï¼Œé¢„æµ‹å‡ºä¸‹ä¸€ä¸ªè¯ï¼Œå†å°†é¢„æµ‹çš„å‡ºçš„è¯å†æ¬¡é€å…¥ç½‘ç»œï¼Œé¢„æµ‹å‡ºä¸‹ä¸€ä¸ªè¯ï¼Œä»¥æ­¤ç±»æ¨ï¼ŒçŸ¥é“é¢„æµ‹å‡ºæˆ‘ä»¬æŒ‡å®šé•¿åº¦çš„å†…å®¹ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> predict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">start_word</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> sentence_length</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ„å»ºè¯å…¸</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    unique_words, word_to_index, unique_word_count, _ </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> build_vocab</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ„å»ºæ¨¡å‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> TextGenerator</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_word_count)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # åŠ è½½å‚æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_state_dict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;model/lyrics_model_10.pth&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # éšè—çŠ¶æ€</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    hidden </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">init_hidden</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">bs</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å°†èµ·å§‹è¯è½¬æ¢ä¸ºç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    word_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> word_to_index[start_word]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # äº§ç”Ÿçš„è¯çš„ç´¢å¼•å­˜æ”¾ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    generate_sentence </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [word_idx]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # éå†åˆ°å¥å­é•¿åº¦ï¼Œè·å–æ¯ä¸€ä¸ªè¯</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> _ </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(sentence_length):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # æ¨¡å‹é¢„æµ‹</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        output, hidden </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([[word_idx]]), hidden)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è·å–é¢„æµ‹ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        word_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">argmax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        generate_sentence.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">append</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(word_idx)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # æ ¹æ®äº§ç”Ÿçš„ç´¢å¼•è·å–å¯¹åº”çš„è¯ï¼Œå¹¶è¿›è¡Œæ‰“å°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> idx </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> generate_sentence:</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(unique_words[idx], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">end</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è°ƒç”¨é¢„æµ‹å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    predict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;åˆ†æ‰‹&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#æ€»ç»“"><span>æ€»ç»“</span></a></h3><h4 id="æ­¥éª¤" tabindex="-1"><a class="header-anchor" href="#æ­¥éª¤"><span>æ­¥éª¤</span></a></h4><ol><li>æ„å»ºè¯æ±‡è¡¨</li><li>æ„å»ºæ•°æ®å¯¹è±¡</li><li>ç¼–å†™ç½‘ç»œæ¨¡å‹</li><li>è®­ç»ƒæ¨¡å‹</li><li>é¢„æµ‹æ¨¡å‹</li></ol><h4 id="è°ƒä¼˜" tabindex="-1"><a class="header-anchor" href="#è°ƒä¼˜"><span>è°ƒä¼˜</span></a></h4><ol><li>è°ƒæ•´è¯å‘é‡ç»´åº¦</li><li>è°ƒæ•´éšè—å‘é‡ç»´åº¦</li><li>è°ƒæ•´RNNå±‚æ•°</li><li>è°ƒæ•´å­¦ä¹ ç‡</li><li>è°ƒæ•´æ‰¹æ¬¡å¤§å°</li><li>è°ƒæ•´è®­ç»ƒè½®æ•°</li><li>è°ƒæ•´é¢„æµ‹é•¿åº¦</li><li>è°ƒæ•´é¢„æµ‹è¯æ•°</li><li>è°ƒæ•´é¢„æµ‹è¯æ•°</li><li>è°ƒæ•´é¢„æµ‹è¯æ•°</li></ol></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/Crc011220/Crc011220.github.io/edit/main/src/zh/posts/deep-learning/å¾ªç¯ç¥ç»ç½‘ç»œRNN.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/12/16 06:46:11</span></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: ruocchen1220@gmail.com">Ruochen Chen</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><a class="route-link auto-link prev" href="/zh/posts/deep-learning/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN.html" aria-label="å·ç§¯ç¥ç»ç½‘ç»œCNN"><div class="hint"><span class="arrow start"></span>ä¸Šä¸€é¡µ</div><div class="link"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>å·ç§¯ç¥ç»ç½‘ç»œCNN</div></a><a class="route-link auto-link next" href="/zh/posts/deep-learning/1.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬ä¸€ç« èŠ‚"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">æ·±åº¦å­¦ä¹ ç¬¬ä¸€ç« èŠ‚<span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">å­¦æµ·æ— æ¶¯</div><div class="vp-copyright">Copyright Â© 2025 Ruochen Chen </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.ffeb7043.js" defer></script><script src="/assets/js/6312.34f20d6c.js" defer></script><script src="/assets/js/app.1d1569fd.js" defer></script>
  </body>
</html>
