<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.18" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.59" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <meta property="og:url" content="https://crc011220.github.io/zh/posts/deep-learning/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN.html"><meta property="og:site_name" content="Ruochen Chen"><meta property="og:title" content="å·ç§¯ç¥ç»ç½‘ç»œCNN"><meta property="og:description" content="å·ç§¯ç¥ç»ç½‘ç»œCNN å›¾åƒåŸºç¡€çŸ¥è¯† å›¾åƒåŸºæœ¬æ¦‚å¿µ å›¾åƒæ˜¯äººç±»è§†è§‰çš„åŸºç¡€ï¼Œæ˜¯è‡ªç„¶æ™¯ç‰©çš„å®¢è§‚åæ˜ ï¼Œæ˜¯äººç±»è®¤è¯†ä¸–ç•Œå’Œäººç±»æœ¬èº«çš„é‡è¦æºæ³‰ã€‚â€œå›¾â€æ˜¯ç‰©ä½“åå°„æˆ–é€å°„å…‰çš„åˆ†å¸ƒï¼Œâ€œåƒâ€œæ˜¯äººçš„è§†è§‰ç³»ç»Ÿæ‰€æ¥å—çš„å›¾åœ¨äººè„‘ä¸­æ‰€å½¢æˆçš„å°è±¡æˆ–è®¤è¯†ï¼Œç…§ç‰‡ã€ç»˜ç”»ã€å‰ªè´´ç”»ã€åœ°å›¾ã€ä¹¦æ³•ä½œå“ã€æ‰‹å†™æ±‰å­—ã€ä¼ çœŸã€å«æ˜Ÿäº‘å›¾ã€å½±è§†ç”»é¢ã€Xå…‰ç‰‡ã€è„‘ç”µå›¾ã€å¿ƒç”µå›¾ç­‰éƒ½æ˜¯å›¾åƒã€‚ åœ¨è®¡ç®—æœºä¸­ï¼ŒæŒ‰ç…§é¢œè‰²å’Œç°åº¦çš„..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2025-12-16T07:00:21.000Z"><meta property="article:tag" content="Deep Learning"><meta property="article:published_time" content="2025-12-04T00:00:00.000Z"><meta property="article:modified_time" content="2025-12-16T07:00:21.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"å·ç§¯ç¥ç»ç½‘ç»œCNN","image":[""],"datePublished":"2025-12-04T00:00:00.000Z","dateModified":"2025-12-16T07:00:21.000Z","author":[{"@type":"Person","name":"Ruochen Chen"}]}</script><link rel="icon" href="/mac.ico"><title>å·ç§¯ç¥ç»ç½‘ç»œCNN | Ruochen Chen</title><meta name="description" content="å·ç§¯ç¥ç»ç½‘ç»œCNN å›¾åƒåŸºç¡€çŸ¥è¯† å›¾åƒåŸºæœ¬æ¦‚å¿µ å›¾åƒæ˜¯äººç±»è§†è§‰çš„åŸºç¡€ï¼Œæ˜¯è‡ªç„¶æ™¯ç‰©çš„å®¢è§‚åæ˜ ï¼Œæ˜¯äººç±»è®¤è¯†ä¸–ç•Œå’Œäººç±»æœ¬èº«çš„é‡è¦æºæ³‰ã€‚â€œå›¾â€æ˜¯ç‰©ä½“åå°„æˆ–é€å°„å…‰çš„åˆ†å¸ƒï¼Œâ€œåƒâ€œæ˜¯äººçš„è§†è§‰ç³»ç»Ÿæ‰€æ¥å—çš„å›¾åœ¨äººè„‘ä¸­æ‰€å½¢æˆçš„å°è±¡æˆ–è®¤è¯†ï¼Œç…§ç‰‡ã€ç»˜ç”»ã€å‰ªè´´ç”»ã€åœ°å›¾ã€ä¹¦æ³•ä½œå“ã€æ‰‹å†™æ±‰å­—ã€ä¼ çœŸã€å«æ˜Ÿäº‘å›¾ã€å½±è§†ç”»é¢ã€Xå…‰ç‰‡ã€è„‘ç”µå›¾ã€å¿ƒç”µå›¾ç­‰éƒ½æ˜¯å›¾åƒã€‚ åœ¨è®¡ç®—æœºä¸­ï¼ŒæŒ‰ç…§é¢œè‰²å’Œç°åº¦çš„...">
    <link rel="stylesheet" href="/assets/css/styles.563fed46.css">
    <link rel="preload" href="/assets/js/runtime~app.b2311df6.js" as="script"><link rel="preload" href="/assets/css/styles.563fed46.css" as="style"><link rel="preload" href="/assets/js/6312.34f20d6c.js" as="script"><link rel="preload" href="/assets/js/app.d3f091b2.js" as="script">
    <link rel="prefetch" href="/assets/js/zh_posts_declarative_haskell.html.8c87b5f2.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_java8_å‡½æ•°å¼ç¼–ç¨‹.html.40d1660d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_cmb_review.html.13458b80.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_Netty01-nio.html.6b030cf9.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_Netty04-ä¼˜åŒ–ä¸æºç .html.a06bcb3d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_Netty03-è¿›é˜¶.html.10e8bde8.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_åŠ¨æ€è§„åˆ’.html.f8a6083b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_æ•°ç»„.html.8af35e83.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_Netty02-intro.html.17d2ad2a.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_äºŒå‰æ ‘.html.0252c56b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nginx_1.html.c3c98206.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_å…¶ä»–é—®é¢˜.html.1275958b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_é¢è¯•è¦ç‚¹.html.1c7f13b2.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_declarative_prolog.html.3a954dea.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_é“¾è¡¨.html.b1dfdd7a.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å…¶ä»–.html.80e868f3.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_COMP90024.html.45f38ae1.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å›¾.html.69b9a845.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_4.html.fd9ffcf6.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_å·ç§¯ç¥ç»ç½‘ç»œCNN.html.47996a3b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_æ ˆå’Œé˜Ÿåˆ—.html.af497ee4.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_hive_Hive-SQLè¯­æ³•å¤§å…¨.html.f759f418.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_5.html.76bc5477.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_14.html.9aaba6e1.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_declarative_haskellé€Ÿè®°.html.ef4f7d84.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å›æº¯.html.ecd8e9b5.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_å¾ªç¯ç¥ç»ç½‘ç»œRNN.html.27d1b54f.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_COMP90049.html.f2fdd90a.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_COMP90050.html.d392f89b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_1.html.c99a1c9b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_æ•°æ®ç»“æ„.html.4979e774.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_2.html.4f5247a4.js" as="script"><link rel="prefetch" href="/assets/js/posts_note_Coin-exchange-project-note.html.b25a336f.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_3.html.e770d362.js" as="script"><link rel="prefetch" href="/assets/js/posts_tailwind_summary.html.12cdb2f0.js" as="script"><link rel="prefetch" href="/assets/js/2664.86a91f7e.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_è®¡ç®—æœºç½‘ç»œ.html.696d6361.js" as="script"><link rel="prefetch" href="/assets/js/posts_typescript_1.html.5dc7387d.js" as="script"><link rel="prefetch" href="/assets/js/posts_typescript_2.html.bceb6a75.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_è´ªå¿ƒ.html.c6b34afe.js" as="script"><link rel="prefetch" href="/assets/js/posts_aws-saa_1.html.177e1f79.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_ml.html.788cf46b.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_æ•°æ®åº“.html.38294ea6.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_æ“ä½œç³»ç»Ÿ.html.2e1d2bbb.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nlp_1.html.91b39bb8.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_COMP90048.html.5bc76c43.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_è®¡ç®—æœºç»„æˆåŸç†.html.ccb41d2c.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_1.html.c5da541d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_declarative_prologé€Ÿè®°.html.c0c75089.js" as="script"><link rel="prefetch" href="/assets/js/8300.14894ef4.js" as="script"><link rel="prefetch" href="/assets/js/posts_mybatis_2.html.db75dcd2.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_åŒæŒ‡é’ˆ.html.dcbf74cb.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_7.html.75cd7a1b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_4.html.7b61713b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_5.html.4e640a94.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å“ˆå¸Œ.html.7191fba9.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nlp_2.html.7e627558.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_8.html.2a069622.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_2.html.28e1dffb.js" as="script"><link rel="prefetch" href="/assets/js/posts_aws-saa_3.html.982df5d0.js" as="script"><link rel="prefetch" href="/assets/js/posts_nginx_1.html.0a9ef4e3.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_SWEN90016.html.91bb292c.js" as="script"><link rel="prefetch" href="/assets/js/posts_spark_Spark-Core.html.05cb9b15.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_11.html.970906ea.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_14.html.45fbc6bb.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_8.html.002dcc85.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_4.html.ba6c0782.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_ä¿¡æ¯æ–°æŠ€æœ¯.html.be677525.js" as="script"><link rel="prefetch" href="/assets/js/posts_spark_Spark-Sql.html.0a30b882.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_21.html.4496521a.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_11.html.c16822d9.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_5.html.22b3e187.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_6.html.6a4a300d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_daily_CE-project.html.fb8c775b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_10.html.446c7da5.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_1.html.b58eda92.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å•è°ƒæ ˆ.html.65c2776c.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_6.html.90316726.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_4.html.15a69407.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_15.html.083892cc.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_py_numpy.html.6b59cce4.js" as="script"><link rel="prefetch" href="/assets/js/posts_aws-saa_2.html.63b9fd8e.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_py_pandas.html.83447d88.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_6.html.3681f2b0.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_3.html.42b1f4d4.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_12.html.ca965f90.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_14.html.d5372a71.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_13.html.1f2b36bf.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_javaai.html.74fdba9d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_å­—ç¬¦ä¸².html.ff3d7193.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_5.html.7f4e8fb8.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_6.html.087ef28e.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_2.html.4def8772.js" as="script"><link rel="prefetch" href="/assets/js/posts_typescript_3.html.249b422e.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_2.html.0325f0d9.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_16.html.ac1e8d01.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_2.html.46e9824a.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_7.html.cbe998f9.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_3.html.f8dc6fdd.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_12.html.ba44f1e4.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_17.html.37ee66f3.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_ä½è¿ç®—.html.218c3265.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_13.html.fef35e9b.js" as="script"><link rel="prefetch" href="/assets/js/intro.html.2e98292e.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_9.html.632a787f.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_15.html.8c8188a0.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_create_mcp.html.533f660c.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_18.html.8e1ad428.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_1.html.8751908b.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_mcp.html.ed4aa6a9.js" as="script"><link rel="prefetch" href="/assets/js/posts_mybatis_1.html.4f6a9358.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_1.html.9e383813.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_7.html.95648d46.js" as="script"><link rel="prefetch" href="/assets/js/posts_istio_1.html.30859a44.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_4.html.9a08d7d3.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_15.html.3fa1eae7.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_10.html.c68171c4.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_1.html.de1e1552.js" as="script"><link rel="prefetch" href="/assets/js/zh_intro.html.3d16bbfe.js" as="script"><link rel="prefetch" href="/assets/js/posts_spark_Spark-Intro.html.d16644da.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_5.html.16d411e3.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_19.html.38712a54.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_7.html.2437ce47.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_æ•°å­¦.html.5fe6c3f9.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_3.html.7e27f56c.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_7.html.abcbe1ef.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_8.html.2569e227.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_index.html.c0edcde2.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_3.html.802f030e.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_Hive.html.eb88f001.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_7.html.d89efd0f.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_9.html.f901c68a.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_HDFS.html.91ff53ef.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_index.html.116eb444.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_good_mcp.html.68e7736e.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_2.html.aecf58f9.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_8.html.a6bfae84.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_4.html.e48b4853.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_daily_good_mcp.html.a3c0902a.js" as="script"><link rel="prefetch" href="/assets/js/posts_jd_note.html.6b67dee8.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_5.html.a2ff101c.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_3.html.69869cbb.js" as="script"><link rel="prefetch" href="/assets/js/posts_docker_1.html.377d8749.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_11.html.9ebfb3bd.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_microsvc_1.html.8ae60b3b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_index.html.8ab4401b.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_summary.html.d72e0b7d.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_6.html.76d483d6.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_6.html.7c3748ee.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_3.html.9fd07548.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_6.html.6ed2bd98.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_7.html.d245ffc7.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_8.html.5515b3e2.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_4.html.2e3e4df8.js" as="script"><link rel="prefetch" href="/assets/js/posts_elasticsearch_query-dsl.html.60aa5ed1.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_cloudflare.html.bf17ad2d.js" as="script"><link rel="prefetch" href="/assets/js/posts_algorithm_20.html.4de7341b.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_1.html.67e91c06.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_5.html.11d820af.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_2.html.0716d1a1.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_10.html.1f4d9b9c.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_16.html.fd55f91e.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_practices_3.html.83b7a26f.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_tools.html.1fdbd61f.js" as="script"><link rel="prefetch" href="/assets/js/posts_elasticsearch_1.html.f4e979a2.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_2.html.bb38228d.js" as="script"><link rel="prefetch" href="/assets/js/posts_docker_docker-podman.html.abacaf64.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_index.html.c331ef18.js" as="script"><link rel="prefetch" href="/assets/js/posts_dubbo_1.html.405486fb.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_concepts_4.html.046bb2ce.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_9.html.f45d605e.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_index.html.63af927c.js" as="script"><link rel="prefetch" href="/assets/js/posts_nextjs_index.html.b0bb4f27.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_index.html.cad521ad.js" as="script"><link rel="prefetch" href="/assets/js/posts_interview_9.html.836391d2.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_1.html.b1996c1d.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_8.html.db9f98c6.js" as="script"><link rel="prefetch" href="/assets/js/posts_elasticsearch_2.html.22acec5f.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_genesis.html.b7e816b9.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_è¯æ±‡.html.4b433385.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_5.html.8cd4d1cf.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_GEOM90007.html.e3b372c0.js" as="script"><link rel="prefetch" href="/assets/js/posts_unimelb_index.html.f4e57161.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_MapReduce.html.75723559.js" as="script"><link rel="prefetch" href="/assets/js/posts_genesis.html.4e94cd83.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_12.html.9b6357a9.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_sealos.html.29198f4a.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_index.html.baea0f7a.js" as="script"><link rel="prefetch" href="/assets/js/posts_dubbo_2.html.62d5a24e.js" as="script"><link rel="prefetch" href="/assets/js/posts_clichÃ©_13.html.df726101.js" as="script"><link rel="prefetch" href="/assets/js/posts_aws-saa_index.html.b3e65945.js" as="script"><link rel="prefetch" href="/assets/js/posts_typescript_index.html.5fd62eae.js" as="script"><link rel="prefetch" href="/assets/js/posts_elasticsearch_index.html.a08b1976.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_index.html.b0a1975e.js" as="script"><link rel="prefetch" href="/assets/js/index.html.b2d0a002.js" as="script"><link rel="prefetch" href="/assets/js/posts_dubbo_index.html.42302fb2.js" as="script"><link rel="prefetch" href="/assets/js/posts_hadoop_Yarn.html.db1a275b.js" as="script"><link rel="prefetch" href="/assets/js/posts_nginx_index.html.350d8a38.js" as="script"><link rel="prefetch" href="/assets/js/posts_ai_index.html.0f59a711.js" as="script"><link rel="prefetch" href="/assets/js/posts_mybatis_index.html.931c43c6.js" as="script"><link rel="prefetch" href="/assets/js/posts_spark_index.html.4b085309.js" as="script"><link rel="prefetch" href="/assets/js/posts_kubernetes_microsvc_index.html.f9c35bbc.js" as="script"><link rel="prefetch" href="/assets/js/posts_cmb_9.html.71162abb.js" as="script"><link rel="prefetch" href="/assets/js/posts_nginx_2.html.3a2f1fef.js" as="script"><link rel="prefetch" href="/assets/js/zh_index.html.a165dbd7.js" as="script"><link rel="prefetch" href="/assets/js/posts_tailwind_index.html.b0d16a8c.js" as="script"><link rel="prefetch" href="/assets/js/posts_docker_index.html.a7c8c584.js" as="script"><link rel="prefetch" href="/assets/js/posts_istio_index.html.17123110.js" as="script"><link rel="prefetch" href="/assets/js/posts_note_index.html.fec20934.js" as="script"><link rel="prefetch" href="/assets/js/category_learning-records_index.html.510e9bba.js" as="script"><link rel="prefetch" href="/assets/js/tag_china-merchant-bank_index.html.0b9b9b12.js" as="script"><link rel="prefetch" href="/assets/js/tag_notes_index.html.0ac76b75.js" as="script"><link rel="prefetch" href="/assets/js/tag_nginx_index.html.e7be5f14.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_declarative-programming_index.html.a822ad65.js" as="script"><link rel="prefetch" href="/assets/js/category_index.html.768835fc.js" as="script"><link rel="prefetch" href="/assets/js/tag_ai_index.html.fe4f2152.js" as="script"><link rel="prefetch" href="/assets/js/timeline_index.html.b424f566.js" as="script"><link rel="prefetch" href="/assets/js/article_index.html.9adb921b.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_å­¦ä¹ ç¬”è®°_index.html.29a3fb96.js" as="script"><link rel="prefetch" href="/assets/js/category_internship-journal_index.html.f69799d2.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_china-merchant-bank_index.html.cc251181.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_learning-records_index.html.59568783.js" as="script"><link rel="prefetch" href="/assets/js/star_index.html.32212a7d.js" as="script"><link rel="prefetch" href="/assets/js/tag_index.html.097dea27.js" as="script"><link rel="prefetch" href="/assets/js/tag_programmer-clichÃ©_index.html.a6185911.js" as="script"><link rel="prefetch" href="/assets/js/tag_algorithm-practices_index.html.97c60e68.js" as="script"><link rel="prefetch" href="/assets/js/tag_technical-interview_index.html.b2812be8.js" as="script"><link rel="prefetch" href="/assets/js/posts_index.html.33b12a16.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_deep-learning_index.html.4a7794c4.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_job-journal_index.html.9683f713.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_å¼€å§‹_index.html.57d4c6ef.js" as="script"><link rel="prefetch" href="/assets/js/tag_tailwind-css_index.html.54d490c2.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_æ—…ç¨‹_index.html.b1e6b88d.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_ç®€å†_index.html.4e50e8ea.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_algorithm_index.html.e80eac7f.js" as="script"><link rel="prefetch" href="/assets/js/category_genesis_index.html.591bccca.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_python_index.html.d1edd527.js" as="script"><link rel="prefetch" href="/assets/js/tag_javascript_index.html.001c06ee.js" as="script"><link rel="prefetch" href="/assets/js/tag_kubernetes_index.html.eef84d75.js" as="script"><link rel="prefetch" href="/assets/js/tag_typescript_index.html.6184e840.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_review_index.html.6742583d.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_pandas_index.html.49352803.js" as="script"><link rel="prefetch" href="/assets/js/tag_leetcode_index.html.498be3e5.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_java8_index.html.28884a39.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_netty_index.html.53b52f0e.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_notes_index.html.3f741263.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_numpy_index.html.1b33f3a1.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_nginx_index.html.4491ae9e.js" as="script"><link rel="prefetch" href="/assets/js/tag_aws-saa_index.html.20911f7f.js" as="script"><link rel="prefetch" href="/assets/js/tag_mybatis_index.html.6033540a.js" as="script"><link rel="prefetch" href="/assets/js/tag_unimelb_index.html.328045e2.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_hive_index.html.9768a59d.js" as="script"><link rel="prefetch" href="/assets/js/tag_docker_index.html.b878209e.js" as="script"><link rel="prefetch" href="/assets/js/tag_hadoop_index.html.690832f8.js" as="script"><link rel="prefetch" href="/assets/js/tag_nextjs_index.html.a6285052.js" as="script"><link rel="prefetch" href="/assets/js/tag_resume_index.html.38124bb9.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_nlp_index.html.dcf160a8.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_nio_index.html.bb0f4482.js" as="script"><link rel="prefetch" href="/assets/js/tag_dubbo_index.html.abf3ebe1.js" as="script"><link rel="prefetch" href="/assets/js/tag_index_index.html.8ae4b8d4.js" as="script"><link rel="prefetch" href="/assets/js/tag_istio_index.html.858428e3.js" as="script"><link rel="prefetch" href="/assets/js/tag_react_index.html.43ba41a0.js" as="script"><link rel="prefetch" href="/assets/js/tag_spark_index.html.29181dd3.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_ai_index.html.325869d0.js" as="script"><link rel="prefetch" href="/assets/js/404.html.21f5a3fe.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_deep-learning_index.html.54b8bafd.js" as="script"><link rel="prefetch" href="/assets/js/zh_timeline_index.html.72e8127a.js" as="script"><link rel="prefetch" href="/assets/js/tag_es_index.html.57e41629.js" as="script"><link rel="prefetch" href="/assets/js/tag_jd_index.html.a77e5283.js" as="script"><link rel="prefetch" href="/assets/js/zh_category_index.html.7475689f.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_declarative_index.html.af0bc0ff.js" as="script"><link rel="prefetch" href="/assets/js/zh_article_index.html.81774320.js" as="script"><link rel="prefetch" href="/assets/js/zh_tag_index.html.f4be6e27.js" as="script"><link rel="prefetch" href="/assets/js/zh_star_index.html.bba3a853.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_review_index.html.52fa9622.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_daily_index.html.a7f16b51.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_java8_index.html.5af50263.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_netty_index.html.0308eef4.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nginx_index.html.cbe553ce.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_algo_index.html.584fefbd.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_hive_index.html.40be20be.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_index.html.43c8149d.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_nlp_index.html.6ca94a7a.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_cmb_index.html.08bb2469.js" as="script"><link rel="prefetch" href="/assets/js/zh_posts_py_index.html.c412c1ae.js" as="script"><link rel="prefetch" href="/assets/js/posts_jd_index.html.5097556f.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><!--[--><a class="route-link vp-brand" href="/zh/" aria-label="å¸¦æˆ‘å›å®¶"><img class="vp-nav-logo" src="/bubu.jpg" alt><!----><span class="vp-site-name hide-in-pad">Ruochen Chen</span></a><!--]--><!----></div><div class="vp-navbar-center"><!----><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/zh/" aria-label="ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->ä¸»é¡µ<!----></a></div><div class="vp-nav-item hide-in-mobile"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="ç¬”è®°"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>ç¬”è®°<!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Hive</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/hive/Hive-SQL%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8.html" aria-label="Hiveè¯­æ³•å¤§å…¨"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Hiveè¯­æ³•å¤§å…¨<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Java8ç‰¹æ€§</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/java8/%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html" aria-label="å‡½æ•°å¼ç¼–ç¨‹"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->å‡½æ•°å¼ç¼–ç¨‹<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">Netty</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/netty/Netty01-nio.html" aria-label="Nioä»‹ç»"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nioä»‹ç»<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/netty/Netty02-intro.html" aria-label="Nettyå…¥é—¨"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nettyå…¥é—¨<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/netty/Netty03-%E8%BF%9B%E9%98%B6.html" aria-label="Nettyè¿›é˜¶"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nettyè¿›é˜¶<!----></a></li><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/netty/Netty04-%E4%BC%98%E5%8C%96%E4%B8%8E%E6%BA%90%E7%A0%81.html" aria-label="Nettyä¼˜åŒ–"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->Nettyä¼˜åŒ–<!----></a></li></ul></li><li class="vp-dropdown-item"><h4 class="vp-dropdown-subtitle">NGINX</h4><ul class="vp-dropdown-subitems"><li class="vp-dropdown-subitem"><a class="route-link auto-link" href="/zh/posts/nginx/1.html" aria-label="NGINX é«˜çº§"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->NGINX é«˜çº§<!----></a></li></ul></li></ul></button></div></div></nav><!--]--><!----></div><div class="vp-navbar-end"><!----><!--[--><div class="vp-nav-item"><div class="vp-dropdown-wrapper"><button type="button" class="vp-dropdown-title" aria-label="é€‰æ‹©è¯­è¨€"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon i18n-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="i18n icon" name="i18n" style="width:1rem;height:1rem;vertical-align:middle;"><path d="M379.392 460.8 494.08 575.488l-42.496 102.4L307.2 532.48 138.24 701.44l-71.68-72.704L234.496 460.8l-45.056-45.056c-27.136-27.136-51.2-66.56-66.56-108.544h112.64c7.68 14.336 16.896 27.136 26.112 35.84l45.568 46.08 45.056-45.056C382.976 312.32 409.6 247.808 409.6 204.8H0V102.4h256V0h102.4v102.4h256v102.4H512c0 70.144-37.888 161.28-87.04 210.944L378.88 460.8zM576 870.4 512 1024H409.6l256-614.4H768l256 614.4H921.6l-64-153.6H576zM618.496 768h196.608L716.8 532.48 618.496 768z"></path></svg><!--]--><span class="arrow"></span><ul class="vp-dropdown"><li class="vp-dropdown-item"><a class="route-link auto-link" href="/" aria-label="English"><!---->English<!----></a></li><li class="vp-dropdown-item"><a class="route-link route-link-active auto-link" href="/zh/posts/deep-learning/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN.html" aria-label="ç®€ä½“ä¸­æ–‡"><!---->ç®€ä½“ä¸­æ–‡<!----></a></li></ul></button></div></div><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/Crc011220/Crc011220.github.io" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-outlook-button" tabindex="-1" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon outlook-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="outlook icon" name="outlook"><path d="M224 800c0 9.6 3.2 44.8 6.4 54.4 6.4 48-48 76.8-48 76.8s80 41.6 147.2 0 134.4-134.4 38.4-195.2c-22.4-12.8-41.6-19.2-57.6-19.2C259.2 716.8 227.2 761.6 224 800zM560 675.2l-32 51.2c-51.2 51.2-83.2 32-83.2 32 25.6 67.2 0 112-12.8 128 25.6 6.4 51.2 9.6 80 9.6 54.4 0 102.4-9.6 150.4-32l0 0c3.2 0 3.2-3.2 3.2-3.2 22.4-16 12.8-35.2 6.4-44.8-9.6-12.8-12.8-25.6-12.8-41.6 0-54.4 60.8-99.2 137.6-99.2 6.4 0 12.8 0 22.4 0 12.8 0 38.4 9.6 48-25.6 0-3.2 0-3.2 3.2-6.4 0-3.2 3.2-6.4 3.2-6.4 6.4-16 6.4-16 6.4-19.2 9.6-35.2 16-73.6 16-115.2 0-105.6-41.6-198.4-108.8-268.8C704 396.8 560 675.2 560 675.2zM224 419.2c0-28.8 22.4-51.2 51.2-51.2 28.8 0 51.2 22.4 51.2 51.2 0 28.8-22.4 51.2-51.2 51.2C246.4 470.4 224 448 224 419.2zM320 284.8c0-22.4 19.2-41.6 41.6-41.6 22.4 0 41.6 19.2 41.6 41.6 0 22.4-19.2 41.6-41.6 41.6C339.2 326.4 320 307.2 320 284.8zM457.6 208c0-12.8 12.8-25.6 25.6-25.6 12.8 0 25.6 12.8 25.6 25.6 0 12.8-12.8 25.6-25.6 25.6C470.4 233.6 457.6 220.8 457.6 208zM128 505.6C128 592 153.6 672 201.6 736c28.8-60.8 112-60.8 124.8-60.8-16-51.2 16-99.2 16-99.2l316.8-422.4c-48-19.2-99.2-32-150.4-32C297.6 118.4 128 291.2 128 505.6zM764.8 86.4c-22.4 19.2-390.4 518.4-390.4 518.4-22.4 28.8-12.8 76.8 22.4 99.2l9.6 6.4c35.2 22.4 80 12.8 99.2-25.6 0 0 6.4-12.8 9.6-19.2 54.4-105.6 275.2-524.8 288-553.6 6.4-19.2-3.2-32-19.2-32C777.6 76.8 771.2 80 764.8 86.4z"></path></svg><div class="vp-outlook-dropdown"><!----></div></button></div><!--[--><div id="docsearch-container" style="display:none;"></div><div><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢æ–‡æ¡£"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢æ–‡æ¡£</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"><svg width="15" height="15" class="DocSearch-Control-Key-Icon"><path d="M4.505 4.496h2M5.505 5.496v5M8.216 4.496l.055 5.993M10 7.5c.333.333.5.667.5 1v2M12.326 4.5v5.996M8.384 4.496c1.674 0 2.116 0 2.116 1.5s-.442 1.5-2.116 1.5M3.205 9.303c-.09.448-.277 1.21-1.241 1.203C1 10.5.5 9.513.5 8V7c0-1.57.5-2.5 1.464-2.494.964.006 1.134.598 1.24 1.342M12.553 10.5h1.953" stroke-width="1.2" stroke="currentColor" fill="none" stroke-linecap="square"></path></svg></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--><!--]--><!----><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><a class="route-link auto-link vp-sidebar-link" href="/zh/" aria-label="ä¸»é¡µ"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span><!--]-->ä¸»é¡µ<!----></a></li><li><section class="vp-sidebar-group"><p class="vp-sidebar-header active"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span><span class="vp-sidebar-title">ç¬”è®°</span><!----></p><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Algo</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Cmb</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Daily</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Declarative</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><!----><span class="vp-sidebar-title">Deep Learning</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/zh/posts/deep-learning/%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CCNN.html" aria-label="å·ç§¯ç¥ç»ç½‘ç»œCNN"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->å·ç§¯ç¥ç»ç½‘ç»œCNN<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN.html" aria-label="å¾ªç¯ç¥ç»ç½‘ç»œRNN"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->å¾ªç¯ç¥ç»ç½‘ç»œRNN<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/1.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬ä¸€ç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬ä¸€ç« èŠ‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/3.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬ä¸‰ç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬ä¸‰ç« èŠ‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/2.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬äºŒç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬äºŒç« èŠ‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/5.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬äº”ç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬äº”ç« èŠ‚<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/deep-learning/4.html" aria-label="æ·±åº¦å­¦ä¹ ç¬¬å››ç« èŠ‚"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->æ·±åº¦å­¦ä¹ ç¬¬å››ç« èŠ‚<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Hive</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Java8</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Netty</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nginx</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Nlp</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Py</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><!----><span class="vp-sidebar-title">Review</span><span class="vp-arrow end"></span></button><!----></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/posts/genesis.html" aria-label="å¼€å§‹"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span><!--]-->å¼€å§‹<!----></a></li></ul></section></li><li><a class="route-link auto-link vp-sidebar-link" href="/zh/intro.html" aria-label="å…³äºæˆ‘"><!--[--><span class="font-icon icon fa-fw fa-sm fas fa-circle-info" style=""></span><!--]-->å…³äºæˆ‘<!----></a></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>å·ç§¯ç¥ç»ç½‘ç»œCNN</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="page-author-item">Ruochen Chen</span></span><span property="author" content="Ruochen Chen"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025å¹´12æœˆ4æ—¥</span><meta property="datePublished" content="2025-12-04T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 29 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT29M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color5 clickable" role="navigation">Learning Records</span><!--]--><meta property="articleSection" content="Learning Records"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color1 clickable" role="navigation">Deep Learning</span><!--]--><meta property="keywords" content="Deep Learning"></span></div><hr></div><div class="vp-toc-placeholder"><aside id="toc" vp-toc><!----><div class="vp-toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon" name="print"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button><div class="arrow end"></div></div><div class="vp-toc-wrapper"><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å›¾åƒåŸºç¡€çŸ¥è¯†">å›¾åƒåŸºç¡€çŸ¥è¯†</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å›¾åƒåŸºæœ¬æ¦‚å¿µ">å›¾åƒåŸºæœ¬æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å›¾åƒåŠ è½½">å›¾åƒåŠ è½½</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å·ç§¯ç¥ç»ç½‘ç»œ-cnn-æ¦‚è¿°">å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æ¦‚è¿°</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ä»€ä¹ˆæ˜¯å·ç§¯ç¥ç»ç½‘ç»œ">ä»€ä¹ˆæ˜¯å·ç§¯ç¥ç»ç½‘ç»œ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å·ç§¯ç¥ç»ç½‘ç»œåº”ç”¨">å·ç§¯ç¥ç»ç½‘ç»œåº”ç”¨</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cnnä¸­çš„ç»å…¸ç®—æ³•-ç½‘ç»œæ¶æ„">CNNä¸­çš„ç»å…¸ç®—æ³•/ç½‘ç»œæ¶æ„</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å·ç§¯å±‚">å·ç§¯å±‚</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å·ç§¯è®¡ç®—">å·ç§¯è®¡ç®—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#padding-å¡«å……">Paddingï¼ˆå¡«å……ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stride-æ­¥é•¿">Strideï¼ˆæ­¥é•¿ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¤šé€šé“å·ç§¯è®¡ç®—">å¤šé€šé“å·ç§¯è®¡ç®—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¤šå·ç§¯æ ¸å·ç§¯è®¡ç®—">å¤šå·ç§¯æ ¸å·ç§¯è®¡ç®—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç‰¹å¾å›¾å¤§å°">ç‰¹å¾å›¾å¤§å°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pytorchå·ç§¯å±‚api">PyTorchå·ç§¯å±‚API</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#æ± åŒ–å±‚">æ± åŒ–å±‚</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ± åŒ–å±‚è®¡ç®—">æ± åŒ–å±‚è®¡ç®—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#padding-å¡«å……-1">Paddingï¼ˆå¡«å……ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#stride-æ­¥é•¿-1">Strideï¼ˆæ­¥é•¿ï¼‰</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#å¤šé€šé“æ± åŒ–è®¡ç®—">å¤šé€šé“æ± åŒ–è®¡ç®—</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#pytorchæ± åŒ–å±‚api">PyTorchæ± åŒ–å±‚API</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level2" href="#å›¾åƒåˆ†ç±»æ¡ˆä¾‹">å›¾åƒåˆ†ç±»æ¡ˆä¾‹</a></li><li><ul class="vp-toc-list"><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#cifar10-æ•°æ®é›†">CIFAR10 æ•°æ®é›†</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ­å»ºå›¾åƒåˆ†ç±»ç½‘ç»œ">æ­å»ºå›¾åƒåˆ†ç±»ç½‘ç»œ</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¼–å†™è®­ç»ƒå‡½æ•°">ç¼–å†™è®­ç»ƒå‡½æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#ç¼–å†™é¢„æµ‹å‡½æ•°">ç¼–å†™é¢„æµ‹å‡½æ•°</a></li><!----><!--]--><!--[--><li class="vp-toc-item"><a class="route-link vp-toc-link level3" href="#æ¨¡å‹ä¼˜åŒ–">æ¨¡å‹ä¼˜åŒ–</a></li><!----><!--]--></ul></li><!--]--></ul><div class="vp-toc-marker" style="top:-1.7rem;"></div></div><!----></aside></div><!----><div class="theme-hope-content" vp-content><h1 id="å·ç§¯ç¥ç»ç½‘ç»œcnn" tabindex="-1"><a class="header-anchor" href="#å·ç§¯ç¥ç»ç½‘ç»œcnn"><span>å·ç§¯ç¥ç»ç½‘ç»œCNN</span></a></h1><h2 id="å›¾åƒåŸºç¡€çŸ¥è¯†" tabindex="-1"><a class="header-anchor" href="#å›¾åƒåŸºç¡€çŸ¥è¯†"><span>å›¾åƒåŸºç¡€çŸ¥è¯†</span></a></h2><h3 id="å›¾åƒåŸºæœ¬æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#å›¾åƒåŸºæœ¬æ¦‚å¿µ"><span>å›¾åƒåŸºæœ¬æ¦‚å¿µ</span></a></h3><p>å›¾åƒæ˜¯äººç±»è§†è§‰çš„åŸºç¡€ï¼Œæ˜¯è‡ªç„¶æ™¯ç‰©çš„å®¢è§‚åæ˜ ï¼Œæ˜¯äººç±»<strong>è®¤è¯†ä¸–ç•Œå’Œäººç±»æœ¬èº«</strong>çš„é‡è¦æºæ³‰ã€‚<strong>â€œå›¾â€æ˜¯ç‰©ä½“åå°„æˆ–é€å°„å…‰çš„åˆ†å¸ƒï¼Œâ€œåƒâ€œæ˜¯äººçš„è§†è§‰ç³»ç»Ÿæ‰€æ¥å—çš„å›¾åœ¨äººè„‘ä¸­æ‰€å½¢æˆçš„å°è±¡æˆ–è®¤è¯†</strong>ï¼Œ<a href="https://baike.baidu.com/item/%E7%85%A7%E7%89%87/1465692?fromModule=lemma_inlink" target="_blank" rel="noopener noreferrer">ç…§ç‰‡</a>ã€ç»˜ç”»ã€å‰ªè´´ç”»ã€åœ°å›¾ã€ä¹¦æ³•ä½œå“ã€æ‰‹å†™æ±‰å­—ã€ä¼ çœŸã€å«æ˜Ÿäº‘å›¾ã€å½±è§†ç”»é¢ã€Xå…‰ç‰‡ã€è„‘ç”µå›¾ã€<a href="https://baike.baidu.com/item/%E5%BF%83%E7%94%B5%E5%9B%BE/399200?fromModule=lemma_inlink" target="_blank" rel="noopener noreferrer">å¿ƒç”µå›¾</a>ç­‰éƒ½æ˜¯å›¾åƒã€‚</p><p>åœ¨è®¡ç®—æœºä¸­ï¼ŒæŒ‰ç…§é¢œè‰²å’Œç°åº¦çš„å¤šå°‘å¯ä»¥å°†å›¾åƒåˆ†ä¸ºå››ç§åŸºæœ¬ç±»å‹ã€‚</p><ul><li><p><strong>äºŒå€¼å›¾åƒ</strong></p><p>ä¸€å¹…äºŒå€¼å›¾åƒçš„äºŒç»´<a href="https://so.csdn.net/so/search?q=%E7%9F%A9%E9%98%B5&amp;spm=1001.2101.3001.7020" target="_blank" rel="noopener noreferrer">çŸ©é˜µ</a>ä»…ç”±0ã€1ä¸¤ä¸ªå€¼æ„æˆï¼Œ<strong>â€œ0â€ä»£è¡¨é»‘è‰²ï¼Œâ€œ1â€ä»£ç™½è‰²</strong>ã€‚ç”±äºæ¯ä¸€åƒç´ ï¼ˆçŸ©é˜µä¸­æ¯ä¸€å…ƒç´ ï¼‰å–å€¼ä»…æœ‰0ã€1ä¸¤ç§å¯èƒ½ï¼Œæ‰€ä»¥è®¡ç®—æœºä¸­äºŒå€¼å›¾åƒçš„æ•°æ®ç±»å‹é€šå¸¸ä¸º1ä¸ªäºŒè¿›åˆ¶ä½ã€‚äºŒå€¼å›¾åƒé€šå¸¸ç”¨äºæ–‡å­—ã€çº¿æ¡å›¾çš„æ‰«æè¯†åˆ«ï¼ˆOCRï¼‰å’Œæ©è†œå›¾åƒçš„å­˜å‚¨ã€‚</p><img src="assets/1737263836325.png" style="zoom:50%;"></li><li><p><strong>ç°åº¦å›¾åƒ</strong></p><p><strong>ç°åº¦å›¾åƒçŸ©é˜µå…ƒç´ çš„å–å€¼èŒƒå›´é€šå¸¸ä¸º[0ï¼Œ255]</strong>ã€‚å› æ­¤å…¶æ•°æ®ç±»å‹ä¸€èˆ¬ä¸º<strong>8ä½æ— ç¬¦å·æ•´æ•°çš„ï¼ˆint8ï¼‰</strong>ï¼Œè¿™å°±æ˜¯äººä»¬ç»å¸¸æåˆ°çš„256ç°åº¦å›¾åƒã€‚**â€œ0â€è¡¨ç¤ºçº¯é»‘è‰²ï¼Œâ€œ255â€è¡¨ç¤ºçº¯ç™½è‰²ï¼Œä¸­é—´çš„æ•°å­—ä»å°åˆ°å¤§è¡¨ç¤ºç”±é»‘åˆ°ç™½çš„è¿‡æ¸¡è‰²ã€‚**äºŒå€¼å›¾åƒå¯ä»¥çœ‹æˆæ˜¯ç°åº¦å›¾åƒçš„ä¸€ä¸ªç‰¹ä¾‹ã€‚</p></li><li><p><strong>ç´¢å¼•å›¾åƒ</strong></p><p>ç´¢å¼•å›¾åƒçš„æ–‡ä»¶ç»“æ„æ¯”è¾ƒå¤æ‚ï¼Œé™¤äº†<strong>å­˜æ”¾å›¾åƒçš„äºŒç»´çŸ©é˜µ</strong>å¤–ï¼Œè¿˜åŒ…æ‹¬ä¸€ä¸ªç§°ä¹‹ä¸º<strong>é¢œè‰²ç´¢å¼•çŸ©é˜µMAPçš„äºŒç»´æ•°ç»„</strong>ã€‚MAPçš„å¤§å°ç”±å­˜æ”¾å›¾åƒçš„çŸ©é˜µå…ƒç´ å€¼åŸŸå†³å®šï¼Œå¦‚çŸ©é˜µå…ƒç´ å€¼åŸŸä¸º[0ï¼Œ255]ï¼Œåˆ™MAPçŸ©é˜µçš„å¤§å°ä¸º256â…©3ï¼Œ<strong>ç”¨MAP=[RGB]è¡¨ç¤º</strong>ã€‚<strong>MAPä¸­æ¯ä¸€è¡Œçš„ä¸‰ä¸ªå…ƒç´ åˆ†åˆ«æŒ‡å®šè¯¥è¡Œå¯¹åº”é¢œè‰²çš„çº¢ã€ç»¿ã€è“å•è‰²å€¼ï¼ŒMAPä¸­æ¯ä¸€è¡Œå¯¹åº”å›¾åƒçŸ©é˜µåƒç´ çš„ä¸€ä¸ªç°åº¦å€¼</strong>ï¼Œå¦‚æŸä¸€åƒç´ çš„ç°åº¦å€¼ä¸º64ï¼Œåˆ™è¯¥åƒç´ å°±ä¸MAPä¸­çš„ç¬¬64è¡Œå»ºç«‹äº†æ˜ å°„å…³ç³»ï¼Œè¯¥åƒç´ åœ¨å±å¹•ä¸Šçš„å®é™…é¢œè‰²ç”±ç¬¬64è¡Œçš„[RGB]ç»„åˆå†³å®šã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå›¾åƒåœ¨å±å¹•ä¸Šæ˜¾ç¤ºæ—¶ï¼Œæ¯ä¸€åƒç´ çš„é¢œè‰²ç”±å­˜æ”¾åœ¨çŸ©é˜µä¸­è¯¥åƒç´ çš„ç°åº¦å€¼ä½œä¸ºç´¢å¼•é€šè¿‡æ£€ç´¢é¢œè‰²ç´¢å¼•çŸ©é˜µMAPå¾—åˆ°ã€‚</p><img src="assets/1737263684063.png" style="zoom:50%;"></li><li><p><strong>çœŸå½©è‰²RGBå›¾åƒ</strong></p><p>RGBå›¾åƒä¸ç´¢å¼•å›¾åƒä¸€æ ·éƒ½å¯ä»¥ç”¨æ¥è¡¨ç¤ºå½©è‰²å›¾åƒã€‚ä¸ç´¢å¼•å›¾åƒä¸€æ ·ï¼Œå®ƒåˆ†åˆ«ç”¨çº¢ï¼ˆRï¼‰ã€ç»¿ï¼ˆGï¼‰ã€è“ï¼ˆBï¼‰ä¸‰åŸè‰²çš„ç»„åˆæ¥è¡¨ç¤ºæ¯ä¸ªåƒç´ çš„é¢œè‰²ã€‚ä½†ä¸ç´¢å¼•å›¾åƒä¸åŒçš„æ˜¯ï¼Œ<strong>RGBå›¾åƒæ¯ä¸€ä¸ªåƒç´ çš„é¢œè‰²å€¼ï¼ˆç”±RGBä¸‰åŸè‰²è¡¨ç¤ºï¼‰ç›´æ¥å­˜æ”¾åœ¨å›¾åƒçŸ©é˜µä¸­</strong>ï¼Œç”±äºæ¯ä¸€åƒç´ çš„é¢œè‰²éœ€ç”±Rã€Gã€Bä¸‰ä¸ªåˆ†é‡æ¥è¡¨ç¤ºï¼Œ**Mã€Nåˆ†åˆ«è¡¨ç¤ºå›¾åƒçš„è¡Œåˆ—æ•°ï¼Œä¸‰ä¸ªM x Nçš„äºŒç»´çŸ©é˜µåˆ†åˆ«è¡¨ç¤ºå„ä¸ªåƒç´ çš„Rã€Gã€Bä¸‰ä¸ªé¢œè‰²åˆ†é‡ã€‚**RGBå›¾åƒçš„æ•°æ®ç±»å‹ä¸€èˆ¬ä¸º8ä½æ— ç¬¦å·æ•´å½¢ã€‚<strong>æ³¨æ„ï¼šé€šé“çš„é¡ºåºæ˜¯ BGR è€Œä¸æ˜¯ RGBã€‚</strong></p><img src="assets/562c11dfa9ec8a132677b97cfd03918fa0ecc039.jpg" style="zoom:75%;"><table><thead><tr><th>å›¾åƒç±»å‹</th><th>é€šé“æ•°</th><th>åƒç´ å€¼èŒƒå›´</th><th>ä¸»è¦ç‰¹ç‚¹</th><th>å¸¸è§ç”¨é€”</th></tr></thead><tbody><tr><td><strong>äºŒå€¼å›¾åƒ</strong></td><td>1é€šé“</td><td>0 æˆ– 1</td><td>æ¯ä¸ªåƒç´ åªæœ‰é»‘ä¸ç™½ä¸¤ç§å€¼</td><td>å½¢æ€å­¦æ“ä½œã€äºŒå€¼åŒ–ã€è½®å»“æ£€æµ‹</td></tr><tr><td><strong>ç°åº¦å›¾åƒ</strong></td><td>1é€šé“</td><td>0 åˆ° 255</td><td>æ¯ä¸ªåƒç´ è¡¨ç¤ºç°åº¦ï¼ˆäº®åº¦ï¼‰</td><td>å›¾åƒé¢„å¤„ç†ã€ç‰©ä½“æ£€æµ‹ã€äººè„¸è¯†åˆ«</td></tr><tr><td><strong>ç´¢å¼•å›¾åƒ</strong></td><td>1é€šé“</td><td>0 åˆ° 255ï¼ˆç´¢å¼•ï¼‰</td><td>åƒç´ å€¼ä¸ºé¢œè‰²è¡¨çš„ç´¢å¼•ï¼Œé¢œè‰²è¡¨å†³å®šå®é™…é¢œè‰²</td><td>å­˜å‚¨å‹ç¼©ã€è¾ƒå°‘é¢œè‰²çš„å›¾åƒè¡¨ç¤º</td></tr><tr><td><strong>RGBå›¾åƒ</strong></td><td>3é€šé“ï¼ˆRã€Gã€Bï¼‰</td><td>0 åˆ° 255</td><td>æ¯ä¸ªåƒç´ ç”±çº¢ã€ç»¿ã€è“ä¸‰ä¸ªé€šé“ç»„æˆ</td><td>æ™®é€šå½©è‰²å›¾åƒæ˜¾ç¤ºã€å›¾åƒå¤„ç†ä¸åˆ†æ</td></tr></tbody></table><p>ç®€å•çš„è®²ï¼š<strong>å›¾åƒæ˜¯ç”±åƒç´ ç‚¹ç»„æˆçš„ï¼Œæ¯ä¸ªåƒç´ ç‚¹çš„å–å€¼èŒƒå›´ä¸º: [0, 255] ã€‚åƒç´ å€¼è¶Šæ¥è¿‘äº0ï¼Œé¢œè‰²è¶Šæš—ï¼Œæ¥è¿‘äºé»‘è‰²ï¼›åƒç´ å€¼è¶Šæ¥è¿‘äº255ï¼Œé¢œè‰²è¶Šäº®ï¼Œæ¥è¿‘äºç™½è‰²ã€‚</strong></p><p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„å›¾åƒå¤§å¤šæ˜¯å½©è‰²å›¾ï¼Œå½©è‰²å›¾ç”±RGB3ä¸ªé€šé“ç»„æˆï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="assets/image-20220518101738866-2840262.png" style="zoom:50%;"></li></ul><h3 id="å›¾åƒåŠ è½½" tabindex="-1"><a class="header-anchor" href="#å›¾åƒåŠ è½½"><span>å›¾åƒåŠ è½½</span></a></h3><p>ä½¿ç”¨ matplotlib åº“æ¥å®é™…ç†è§£ä¸‹ä¸Šé¢è®²è§£çš„å›¾åƒçŸ¥è¯†ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> numpy </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> np</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> matplotlib.pyplot </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> plt</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åƒç´ å€¼çš„ç†è§£</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test01</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å…¨0æ•°ç»„æ˜¯é»‘è‰²çš„å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # H, W, C -&gt; é«˜, å®½, é€šé“</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">zeros</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">shape</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å±•ç¤ºå›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å¯¹åæ ‡è½´è¿›è¡Œè®¾ç½®</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # off:å…³é—­åæ ‡è½´</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">axis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;off&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å…¨255æ•°ç»„æ˜¯ç™½è‰²çš„å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> np.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">full</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">shape</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">200</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">fill_value</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">255</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å±•ç¤ºå›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å›¾åƒçš„åŠ è½½</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test02</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è¯»å–å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;data/img.jpg&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ä¿å­˜å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imsave</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;data/img1.jpg&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ‰“å°å›¾åƒå½¢çŠ¶ é«˜,å®½,é€šé“</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å›¾åƒçš„å½¢çŠ¶(H, W, C):</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img.shape)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å±•ç¤ºå›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">axis</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;off&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    test01</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    test02</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœ:</strong></p><p>å…¨é»‘å’Œå…¨ç™½å›¾åƒï¼š</p><img src="assets/image-20220518104734551.png" style="zoom:50%;"><p>å›¾åƒçš„å½¢çŠ¶ä¸ºï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å›¾åƒçš„å½¢çŠ¶ï¼ˆHï¼ŒWï¼ŒCï¼‰:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><img src="assets/image-20220518104441645-2841883.png" style="zoom:50%;"><h2 id="å·ç§¯ç¥ç»ç½‘ç»œ-cnn-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#å·ç§¯ç¥ç»ç½‘ç»œ-cnn-æ¦‚è¿°"><span>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰æ¦‚è¿°</span></a></h2><h3 id="ä»€ä¹ˆæ˜¯å·ç§¯ç¥ç»ç½‘ç»œ" tabindex="-1"><a class="header-anchor" href="#ä»€ä¹ˆæ˜¯å·ç§¯ç¥ç»ç½‘ç»œ"><span>ä»€ä¹ˆæ˜¯å·ç§¯ç¥ç»ç½‘ç»œ</span></a></h3><p><strong>å·ç§¯ç¥ç»ç½‘ç»œæ˜¯æ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„çªç ´æ€§æˆæœï¼Œä¸“é—¨ç”¨äºå¤„ç†å›¾åƒã€è§†é¢‘ã€è¯­éŸ³ç­‰æ•°æ®çš„ç¥ç»ç½‘ç»œ</strong></p><p>åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸ, å¾€å¾€æˆ‘ä»¬è¾“å…¥çš„å›¾åƒéƒ½å¾ˆå¤§ï¼Œä½¿ç”¨å…¨è¿æ¥ç½‘ç»œçš„è¯ï¼Œè®¡ç®—çš„ä»£ä»·è¾ƒé«˜ã€‚å¦å¤–å›¾åƒä¹Ÿå¾ˆéš¾ä¿ç•™åŸæœ‰çš„ç‰¹å¾ï¼Œå¯¼è‡´å›¾åƒå¤„ç†çš„å‡†ç¡®ç‡ä¸é«˜ã€‚</p><p>å·ç§¯ç¥ç»ç½‘ç»œï¼ˆConvolutional Neural Networkï¼‰æ˜¯<strong>å«æœ‰å·ç§¯å±‚çš„ç¥ç»ç½‘ç»œ</strong>ã€‚å·ç§¯å±‚çš„<strong>ä½œç”¨å°±æ˜¯ç”¨æ¥è‡ªåŠ¨å­¦ä¹ ã€æå–å›¾åƒçš„ç‰¹å¾</strong>ã€‚</p><p>CNNç½‘ç»œä¸»è¦ç”±ä¸‰éƒ¨åˆ†æ„æˆï¼š<strong>å·ç§¯å±‚ã€æ± åŒ–å±‚å’Œå…¨è¿æ¥å±‚</strong>æ„æˆï¼š</p><p>ï¼ˆ1ï¼‰å·ç§¯å±‚è´Ÿè´£æå–å›¾åƒä¸­çš„å±€éƒ¨ç‰¹å¾</p><p>ï¼ˆ2ï¼‰æ± åŒ–å±‚ç”¨æ¥å¤§å¹…é™ä½å‚æ•°é‡çº§(é™ç»´)</p><p>ï¼ˆ3ï¼‰å…¨è¿æ¥å±‚ç±»ä¼¼äººå·¥ç¥ç»ç½‘ç»œçš„éƒ¨åˆ†ï¼Œç”¨æ¥è¾“å‡ºæƒ³è¦çš„ç»“æœ</p><img src="assets/image-20220518095605390.png" style="zoom:50%;"><p>ä¸Šå›¾ä¸­CNNè¦åšçš„äº‹æƒ…æ˜¯ï¼šç»™å®šä¸€å¼ å›¾ç‰‡ï¼Œæ˜¯è½¦è¿˜æ˜¯é©¬æœªçŸ¥ï¼Œæ˜¯ä»€ä¹ˆè½¦ä¹ŸæœªçŸ¥ï¼Œç°åœ¨éœ€è¦æ¨¡å‹åˆ¤æ–­è¿™å¼ å›¾ç‰‡é‡Œå…·ä½“æ˜¯ä¸€ä¸ªä»€ä¹ˆä¸œè¥¿ï¼Œæ€»ä¹‹è¾“å‡ºä¸€ä¸ªç»“æœï¼šå¦‚æœæ˜¯è½¦ï¼Œé‚£æ˜¯ä»€ä¹ˆè½¦</p><ul><li>æœ€å·¦è¾¹æ˜¯ <ul><li>æ•°æ®è¾“å…¥å±‚ï¼šå¯¹æ•°æ®åšä¸€äº›å¤„ç†ï¼Œæ¯”å¦‚å»å‡å€¼ï¼ˆå„ç»´åº¦éƒ½å‡å¯¹åº”ç»´åº¦çš„å‡å€¼ï¼Œä½¿å¾—è¾“å…¥æ•°æ®å„ä¸ªç»´åº¦éƒ½ä¸­å¿ƒåŒ–ä¸º0ï¼Œé¿å…æ•°æ®è¿‡å¤šåå·®ï¼Œå½±å“è®­ç»ƒæ•ˆæœï¼‰ã€å½’ä¸€åŒ–ï¼ˆæŠŠæ‰€æœ‰çš„æ•°æ®éƒ½å½’ä¸€åˆ°åŒæ ·çš„èŒƒå›´ï¼‰ã€PCAç­‰ç­‰ã€‚CNNåªå¯¹è®­ç»ƒé›†åšâ€œå»å‡å€¼â€è¿™ä¸€æ­¥ã€‚</li></ul></li><li>ä¸­é—´æ˜¯ <ul><li>å·ç§¯å±‚(CONV)ï¼šçº¿æ€§ä¹˜ç§¯æ±‚å’Œï¼Œæå–å›¾åƒä¸­çš„å±€éƒ¨ç‰¹å¾</li><li>æ¿€åŠ±å±‚(RELU)ï¼šReLUæ¿€æ´»å‡½æ•°,è¾“å…¥æ•°æ®è½¬æ¢æˆè¾“å‡ºæ•°æ®</li><li>æ± åŒ–å±‚(POOL)ï¼šå–åŒºåŸŸå¹³å‡å€¼æˆ–æœ€å¤§å€¼ï¼Œå¤§å¹…é™ä½å‚æ•°é‡çº§(é™ç»´)</li></ul></li><li>æœ€å³è¾¹æ˜¯ <ul><li>å…¨è¿æ¥å±‚(FC)ï¼šæ¥æ”¶äºŒç»´æ•°æ®é›†ï¼Œè¾“å‡ºCNNæ¨¡å‹é¢„æµ‹ç»“æœ</li></ul></li></ul><h3 id="å·ç§¯ç¥ç»ç½‘ç»œåº”ç”¨" tabindex="-1"><a class="header-anchor" href="#å·ç§¯ç¥ç»ç½‘ç»œåº”ç”¨"><span>å·ç§¯ç¥ç»ç½‘ç»œåº”ç”¨</span></a></h3><p><strong>å›¾åƒåˆ†ç±»</strong>ï¼šæœ€å¸¸è§çš„åº”ç”¨ï¼Œä¾‹å¦‚è¯†åˆ«å›¾ç‰‡ä¸­çš„ç‰©ä½“ç±»åˆ«</p><p><strong>ç›®æ ‡æ£€æµ‹</strong>ï¼šæ£€æµ‹å›¾åƒä¸­ç‰©ä½“çš„ä½ç½®å’Œç±»åˆ«</p><p><strong>å›¾åƒåˆ†å‰²</strong>ï¼šå°†å›¾åƒåˆ†æˆå¤šä¸ªåŒºåŸŸï¼Œç”¨äºè¯­ä¹‰åˆ†å‰²</p><p><strong>äººè„¸è¯†åˆ«</strong>ï¼šè¯†åˆ«å›¾åƒä¸­çš„äººè„¸</p><p><strong>åŒ»å­¦å›¾åƒåˆ†æ</strong>ï¼šç”¨äºæ£€æµ‹åŒ»å­¦å›¾åƒä¸­çš„å¼‚å¸¸ï¼ˆå¦‚ç™Œç—‡æ£€æµ‹ã€éª¨æŠ˜æ£€æµ‹ç­‰ï¼‰</p><p><strong>è‡ªåŠ¨é©¾é©¶</strong>ï¼šç”¨äºè¯†åˆ«äº¤é€šæ ‡å¿—ã€è½¦è¾†ã€è¡Œäºº</p><h3 id="cnnä¸­çš„ç»å…¸ç®—æ³•-ç½‘ç»œæ¶æ„" tabindex="-1"><a class="header-anchor" href="#cnnä¸­çš„ç»å…¸ç®—æ³•-ç½‘ç»œæ¶æ„"><span><strong>CNNä¸­çš„ç»å…¸ç®—æ³•/ç½‘ç»œæ¶æ„</strong></span></a></h3><p>**LeNet-5:**ä½œä¸ºæœ€æ—©çš„CNNæ¶æ„ä¹‹ä¸€ï¼Œè¯æ˜äº†CNNåœ¨å›¾åƒè¯†åˆ«ä»»åŠ¡ä¸Šçš„æœ‰æ•ˆæ€§ï¼Œä¸ºåç»­çš„CNNå‘å±•å¥ å®šäº†åŸºç¡€</p><ul><li><strong>å·ç§¯å±‚:</strong> æå–å›¾åƒçš„è¾¹ç¼˜ã€è§’ç‚¹ç­‰åŸºæœ¬ç‰¹å¾</li><li><strong>æ± åŒ–å±‚ (å­é‡‡æ ·å±‚):</strong> é™ä½ç‰¹å¾å›¾çš„ç»´åº¦ï¼Œå‡å°‘è®¡ç®—é‡ï¼Œå¹¶æé«˜æ¨¡å‹å¯¹è¾“å…¥å›¾åƒå¾®å°å˜åŒ–çš„é²æ£’æ€§</li><li><strong>å…¨è¿æ¥å±‚:</strong> å°†å·ç§¯å±‚å’Œæ± åŒ–å±‚æå–çš„ç‰¹å¾è¿›è¡Œç»„åˆï¼Œç”¨äºæœ€ç»ˆçš„åˆ†ç±»</li></ul><p>**AlexNet:**æ˜¾è‘—æå‡äº†ImageNetå›¾åƒåˆ†ç±»çš„å‡†ç¡®ç‡ï¼Œè¯æ˜äº†æ·±åº¦å­¦ä¹ åœ¨è®¡ç®—æœºè§†è§‰é¢†åŸŸçš„æ½œåŠ›ï¼Œå¹¶æ¨åŠ¨äº†æ·±åº¦å­¦ä¹ çš„å¿«é€Ÿå‘å±•</p><ul><li><strong>å·ç§¯å±‚:</strong> ä½¿ç”¨æ›´å¤§çš„å·ç§¯æ ¸å’Œæ›´å¤šçš„å·ç§¯æ ¸ï¼Œæå–æ›´ä¸°å¯Œçš„å›¾åƒç‰¹å¾</li><li><strong>ReLUæ¿€æ´»å‡½æ•°:</strong> åŠ é€Ÿè®­ç»ƒè¿‡ç¨‹ï¼Œå¹¶æé«˜æ¨¡å‹çš„æ€§èƒ½</li><li><strong>æœ€å¤§æ± åŒ–å±‚:</strong> é™ä½ç‰¹å¾å›¾çš„ç»´åº¦</li><li><strong>Dropoutå±‚:</strong> é˜²æ­¢è¿‡æ‹Ÿåˆ</li><li><strong>å…¨è¿æ¥å±‚:</strong> ç”¨äºæœ€ç»ˆçš„åˆ†ç±»</li></ul><p>**VGGNet:**æ¢ç´¢äº†ç½‘ç»œæ·±åº¦å¯¹æ€§èƒ½çš„å½±å“ï¼Œè¯æ˜äº†æ›´æ·±çš„ç½‘ç»œå¯ä»¥æå–æ›´æŠ½è±¡å’Œæ›´å…·è¡¨è¾¾åŠ›çš„ç‰¹å¾</p><ul><li><strong>å·ç§¯å±‚:</strong> ä½¿ç”¨æ›´å°çš„å·ç§¯æ ¸ (3x3)ï¼Œå¹¶å †å å¤šä¸ªå·ç§¯å±‚ï¼Œå¢åŠ äº†ç½‘ç»œçš„æ·±åº¦ï¼Œæå–æ›´å¤æ‚çš„ç‰¹å¾</li><li><strong>æœ€å¤§æ± åŒ–å±‚:</strong> é™ä½ç‰¹å¾å›¾çš„ç»´åº¦</li><li><strong>å…¨è¿æ¥å±‚:</strong> ç”¨äºæœ€ç»ˆçš„åˆ†ç±»</li></ul><p>**GoogLeNet (Inception)ğŸ˜—*æå‡ºäº† Inception æ¨¡å—ï¼Œåœ¨æé«˜æ€§èƒ½çš„åŒæ—¶å‡å°‘äº†è®¡ç®—é‡ï¼Œä¸ºåç»­çš„ç½‘ç»œæ¶æ„è®¾è®¡æä¾›äº†æ–°çš„æ€è·¯</p><ul><li><strong>Inception æ¨¡å—:</strong> å¹¶è¡Œä½¿ç”¨ä¸åŒå¤§å°çš„å·ç§¯æ ¸å’Œæ± åŒ–æ“ä½œï¼Œç„¶åå°†å®ƒä»¬çš„è¾“å‡ºè¿æ¥èµ·æ¥ï¼Œå¢åŠ äº†ç½‘ç»œçš„å®½åº¦ï¼Œæé«˜äº†ç½‘ç»œçš„æ•ˆç‡</li></ul><p>**ResNet:**è§£å†³äº†æ·±åº¦ç½‘ç»œè®­ç»ƒå›°éš¾çš„é—®é¢˜ï¼Œä½¿å¾—å¯ä»¥è®­ç»ƒæ›´æ·±çš„ç½‘ç»œï¼Œä»è€Œæ˜¾è‘—æé«˜äº†æ¨¡å‹çš„æ€§èƒ½</p><ul><li><strong>æ®‹å·®å— (Residual Block):</strong> å¼•å…¥è·³è·ƒè¿æ¥ (Shortcut Connection)ï¼Œå…è®¸æ¢¯åº¦ç›´æ¥åå‘ä¼ æ’­åˆ°æµ…å±‚ï¼Œè§£å†³äº†æ·±åº¦ç½‘ç»œçš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œä½¿å¾—è®­ç»ƒéå¸¸æ·±çš„ç½‘ç»œæˆä¸ºå¯èƒ½</li></ul><p><strong>DenseNet:</strong></p><ul><li><strong>å¯†é›†å— (Dense Block):</strong> å°†æ¯ä¸€å±‚éƒ½ä¸ä¹‹å‰çš„æ‰€æœ‰å±‚è¿æ¥ï¼Œç‰¹å¾é‡ç”¨æ›´åŠ å……åˆ†ï¼Œè¿›ä¸€æ­¥æé«˜äº†ç½‘ç»œçš„æ€§èƒ½å’Œå‚æ•°æ•ˆç‡</li><li>DenseNeté€šè¿‡å¯†é›†è¿æ¥ï¼ˆDense Connectivityï¼‰åœ¨ç½‘ç»œä¸­å„å±‚ä¹‹é—´å»ºç«‹äº†ç›´æ¥çš„è¿æ¥ï¼Œå³æ¯ä¸€å±‚éƒ½æ¥æ”¶å‰é¢æ‰€æœ‰å±‚çš„è¾“å‡ºä½œä¸ºè¾“å…¥ã€‚è¿™ç§è®¾è®¡å¢å¼ºäº†ç‰¹å¾ä¼ é€’å’Œæ¢¯åº¦æµåŠ¨ï¼Œé¿å…äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ï¼Œå¹¶æé«˜äº†ä¿¡æ¯çš„åˆ©ç”¨ç‡</li></ul><h2 id="å·ç§¯å±‚" tabindex="-1"><a class="header-anchor" href="#å·ç§¯å±‚"><span>å·ç§¯å±‚</span></a></h2><blockquote><p>å·ç§¯å±‚ï¼ˆConvolutional Layerï¼‰é€šè¿‡å·ç§¯æ“ä½œæå–è¾“å…¥æ•°æ®ä¸­çš„ç‰¹å¾ï¼ˆä¾‹å¦‚å›¾åƒä¸­çš„è¾¹ç¼˜ã€çº¹ç†ã€å½¢çŠ¶ç­‰ï¼‰ã€‚</p><p>å·ç§¯å±‚åˆ©ç”¨å·ç§¯æ ¸ï¼ˆæ»¤æ³¢å™¨ï¼‰å¯¹è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œä»è€Œç”Ÿæˆç‰¹å¾å›¾ï¼ˆfeature mapï¼‰ï¼Œå¹¶ä¸”æ¯ä¸ªå·ç§¯å±‚èƒ½å¤Ÿæå–ä¸åŒå±‚æ¬¡çš„ç‰¹å¾ï¼Œä»ä½çº§ç‰¹å¾ï¼ˆå¦‚è¾¹ç¼˜ï¼‰åˆ°é«˜çº§ç‰¹å¾ï¼ˆå¦‚ç‰©ä½“çš„å½¢çŠ¶ï¼‰ã€‚</p><p><strong>å·ç§¯å±‚çš„ä¸»è¦ä½œç”¨å¦‚ä¸‹ï¼š</strong></p><ul><li><p><strong>ç‰¹å¾æå–</strong>ï¼šå·ç§¯å±‚çš„ä¸»è¦ä½œç”¨æ˜¯ä»è¾“å…¥å›¾åƒä¸­æå–ä½çº§ç‰¹å¾ï¼ˆå¦‚è¾¹ç¼˜ã€è§’ç‚¹ã€çº¹ç†ç­‰ï¼‰ã€‚é€šè¿‡å¤šä¸ªå·ç§¯å±‚çš„å †å ï¼Œç½‘ç»œèƒ½å¤Ÿé€æ¸ä»ä½çº§ç‰¹å¾åˆ°é«˜çº§ç‰¹å¾ï¼ˆå¦‚ç‰©ä½“çš„å½¢çŠ¶ã€åŒºåŸŸç­‰ï¼‰è¿›è¡Œå­¦ä¹ ã€‚</p></li><li><p><strong>æƒé‡å…±äº«</strong>ï¼šåœ¨å·ç§¯å±‚ä¸­ï¼ŒåŒä¸€ä¸ªå·ç§¯æ ¸åœ¨æ•´ä¸ªè¾“å…¥å›¾åƒä¸Šå…±äº«æƒé‡ï¼Œè¿™ä½¿å¾—å·ç§¯å±‚çš„å‚æ•°æ•°é‡å¤§å¤§å‡å°‘ï¼Œå‡å°‘äº†è®¡ç®—é‡å¹¶æé«˜äº†è®­ç»ƒæ•ˆç‡ã€‚</p></li><li><p><strong>å±€éƒ¨è¿æ¥</strong>ï¼šå·ç§¯å±‚ä¸­çš„æ¯ä¸ªç¥ç»å…ƒä»…ä¸è¾“å…¥å›¾åƒçš„ä¸€ä¸ªå°å±€éƒ¨åŒºåŸŸç›¸è¿ï¼Œè¿™ç§°ä¸º<strong>å±€éƒ¨æ„Ÿå—é‡</strong>ï¼Œè¿™ç§å±€éƒ¨è¿æ¥æ–¹å¼æ›´ç¬¦åˆå›¾åƒçš„ç©ºé—´ç»“æ„ï¼Œæœ‰åŠ©äºæ•æ‰å›¾åƒä¸­çš„å±€éƒ¨ç‰¹å¾ã€‚</p></li><li><p><strong>ç©ºé—´ä¸å˜æ€§</strong>ï¼šç”±äºå·ç§¯æ“ä½œæ˜¯å±€éƒ¨çš„å¹¶ä¸”é‡‡ç”¨æƒé‡å…±äº«ï¼Œå·ç§¯å±‚åœ¨å¤„ç†å›¾åƒæ—¶å…·æœ‰<strong>å¹³ç§»ä¸å˜æ€§</strong>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸è®ºç‰©ä½“å‡ºç°åœ¨å›¾åƒçš„å“ªä¸ªä½ç½®ï¼Œå·ç§¯å±‚éƒ½èƒ½æœ‰æ•ˆåœ°æ£€æµ‹åˆ°è¿™äº›ç‰©ä½“çš„ç‰¹å¾ã€‚</p></li></ul></blockquote><h3 id="å·ç§¯è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#å·ç§¯è®¡ç®—"><span>å·ç§¯è®¡ç®—</span></a></h3><img src="assets/01.png" style="zoom:50%;"><ol><li><p>input è¡¨ç¤ºè¾“å…¥çš„å›¾åƒ</p></li><li><p>filter è¡¨ç¤ºå·ç§¯æ ¸, ä¹Ÿå«åšæ»¤æ³¢å™¨(æ»¤æ³¢çŸ©é˜µ)</p><ul><li>ä¸€ç»„å›ºå®šçš„æƒé‡ï¼Œå› ä¸ºæ¯ä¸ªç¥ç»å…ƒçš„å¤šä¸ªæƒé‡å›ºå®šï¼Œæ‰€ä»¥åˆå¯ä»¥çœ‹åšä¸€ä¸ªæ’å®šçš„æ»¤æ³¢å™¨filter</li><li>éä¸¥æ ¼æ„ä¹‰ä¸Šæ¥è®²ï¼Œä¸‹å›¾ä¸­çº¢æ¡†æ¡†èµ·æ¥çš„éƒ¨åˆ†ä¾¿å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ»¤æ³¢å™¨ï¼Œå³å¸¦ç€<strong>ä¸€ç»„å›ºå®šæƒé‡çš„ç¥ç»å…ƒ</strong>ã€‚å¤šä¸ªæ»¤æ³¢å™¨å åŠ ä¾¿æˆäº†å·ç§¯å±‚</li><li>ä¸€ä¸ªå·ç§¯æ ¸å°±æ˜¯ä¸€ä¸ªç¥ç»å…ƒ</li></ul><figure><img src="/assets/img/20160822134955264.7fe2dc14.png" alt="img" tabindex="0" loading="lazy"><figcaption>img</figcaption></figure></li><li><p>input ç»è¿‡ filter å¾—åˆ°è¾“å‡ºä¸ºæœ€å³ä¾§çš„å›¾åƒï¼Œè¯¥å›¾å«åšç‰¹å¾å›¾</p></li></ol><p>é‚£ä¹ˆ, å®ƒæ˜¯å¦‚ä½•è¿›è¡Œè®¡ç®—çš„å‘¢ï¼Ÿ<strong>å·ç§¯è¿ç®—æœ¬è´¨ä¸Šå°±æ˜¯åœ¨æ»¤æ³¢å™¨å’Œè¾“å…¥æ•°æ®çš„å±€éƒ¨åŒºåŸŸé—´åšç‚¹ç§¯ã€‚</strong></p><img src="assets/02.png" style="zoom:50%;"><p>å·¦ä¸Šè§’çš„ç‚¹è®¡ç®—æ–¹æ³•ï¼š</p><img src="assets/03.png" style="zoom:50%;"><p>æŒ‰ç…§ä¸Šé¢çš„è®¡ç®—æ–¹æ³•å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„ç‰¹å¾å›¾ä¸º:</p><img src="assets/04.png" style="zoom:50%;"><p>å›¾åƒä¸Šçš„å·ç§¯:</p><p>åœ¨ä¸‹å›¾å¯¹åº”çš„è®¡ç®—è¿‡ç¨‹ä¸­ï¼Œè¾“å…¥æ˜¯ä¸€å®šåŒºåŸŸå¤§å°(width*height)çš„æ•°æ®ï¼Œå’Œæ»¤æ³¢å™¨filterï¼ˆå¸¦ç€ä¸€ç»„å›ºå®šæƒé‡çš„ç¥ç»å…ƒï¼‰åšå†…ç§¯åå¾—åˆ°æ–°çš„äºŒç»´æ•°æ®ã€‚</p><img src="assets/20160702214116669" style="zoom:50%;"><p>å…·ä½“æ¥è¯´ï¼Œå·¦è¾¹æ˜¯å›¾åƒè¾“å…¥ï¼Œä¸­é—´éƒ¨åˆ†å°±æ˜¯æ»¤æ³¢å™¨filterï¼ˆå¸¦ç€ä¸€ç»„å›ºå®šæƒé‡çš„ç¥ç»å…ƒï¼‰ï¼Œä¸åŒçš„æ»¤æ³¢å™¨filterä¼šå¾—åˆ°ä¸åŒçš„è¾“å‡ºæ•°æ®ï¼Œæ¯”å¦‚é¢œè‰²æ·±æµ…ã€è½®å»“ã€‚ç›¸å½“äºå¦‚æœæƒ³æå–å›¾åƒçš„ä¸åŒç‰¹å¾ï¼Œåˆ™ç”¨ä¸åŒçš„æ»¤æ³¢å™¨filterï¼Œæå–æƒ³è¦çš„å…³äºå›¾åƒçš„ç‰¹å®šä¿¡æ¯ï¼šé¢œè‰²æ·±æµ…æˆ–è½®å»“ã€‚</p><h3 id="padding-å¡«å……" tabindex="-1"><a class="header-anchor" href="#padding-å¡«å……"><span>Paddingï¼ˆå¡«å……ï¼‰</span></a></h3><p>é€šè¿‡ä¸Šé¢çš„å·ç§¯è®¡ç®—è¿‡ç¨‹ï¼Œæœ€ç»ˆçš„ç‰¹å¾å›¾æ¯”åŸå§‹å›¾åƒå°å¾ˆå¤šï¼Œå¦‚æœæƒ³è¦ä¿æŒç»è¿‡å·ç§¯åçš„å›¾åƒå¤§å°ä¸å˜, å¯ä»¥åœ¨<strong>åŸå›¾å‘¨å›´</strong>æ·»åŠ  Padding æ¥å®ç°ã€‚</p><p>Paddingï¼ˆå¡«å……ï¼‰æ“ä½œæ˜¯ä¸€ç§ç”¨äº<mark>åœ¨è¾“å…¥ç‰¹å¾å›¾çš„è¾¹ç•Œå‘¨å›´æ·»åŠ é¢å¤–åƒç´ ï¼ˆé€šå¸¸æ˜¯é›¶ï¼‰</mark>ã€‚</p><p><strong>Paddingçš„ä¸»è¦ä½œç”¨ï¼š</strong></p><ul><li>**ä¿æŒç©ºé—´ç»´åº¦ï¼š**å¦‚æœä¸ä½¿ç”¨ paddingï¼Œæ¯æ¬¡å·ç§¯æ“ä½œåï¼Œç‰¹å¾å›¾çš„å°ºå¯¸éƒ½ä¼šç¼©å°ã€‚å¤šæ¬¡å·ç§¯åï¼Œç‰¹å¾å›¾ä¼šå˜å¾—éå¸¸å°ï¼Œå¯èƒ½ä¼šä¸¢å¤±é‡è¦çš„è¾¹ç¼˜ä¿¡æ¯ã€‚Paddingå¯ä»¥å¸®åŠ©ç»´æŒè¾“å‡ºç‰¹å¾å›¾çš„å°ºå¯¸ä¸è¾“å…¥ç›¸åŒæˆ–æ¥è¿‘ç›¸åŒã€‚</li><li>**ä¿ç•™è¾¹ç¼˜ä¿¡æ¯ï¼š**å›¾åƒè¾¹ç¼˜çš„åƒç´ åœ¨å·ç§¯è¿‡ç¨‹ä¸­å‚ä¸çš„è®¡ç®—æ¬¡æ•°è¾ƒå°‘ï¼Œè¿™æ„å‘³ç€è¾¹ç¼˜ä¿¡æ¯åœ¨ç‰¹å¾æå–è¿‡ç¨‹ä¸­å®¹æ˜“ä¸¢å¤±ã€‚Paddingé€šè¿‡åœ¨è¾¹ç¼˜æ·»åŠ é¢å¤–çš„åƒç´ ï¼Œå¢åŠ äº†è¾¹ç¼˜åƒç´ çš„å‚ä¸åº¦ï¼Œä»è€Œæ›´å¥½åœ°ä¿ç•™äº†è¾¹ç¼˜ä¿¡æ¯ã€‚</li><li>**æé«˜æ€§èƒ½ï¼š**Paddingæœ‰åŠ©äºé¿å…ç”±äºç‰¹å¾å›¾å°ºå¯¸å¿«é€Ÿç¼©å°è€Œå¯¼è‡´çš„ä¿¡æ¯ä¸¢å¤±ï¼Œä»è€Œæé«˜æ¨¡å‹çš„æ€§èƒ½ï¼Œå°¤å…¶æ˜¯åœ¨å¤„ç†è¾ƒå°çš„å›¾åƒæˆ–éœ€è¦è¿›è¡Œå¤šå±‚å·ç§¯æ—¶ã€‚</li></ul><p><strong>Paddingçš„ç±»å‹ï¼š</strong></p><ul><li><strong>Valid Padding (No Padding):</strong> ä¸è¿›è¡Œä»»ä½•å¡«å……ã€‚å·ç§¯æ ¸åªåœ¨è¾“å…¥å›¾åƒçš„æœ‰æ•ˆåŒºåŸŸå†…æ»‘åŠ¨ã€‚è¾“å‡ºå°ºå¯¸ä¼šç¼©å°ã€‚</li><li><strong>Same Padding:</strong> æ·»åŠ è¶³å¤Ÿçš„å¡«å……ï¼Œä½¿å¾—è¾“å‡ºç‰¹å¾å›¾çš„å°ºå¯¸ä¸è¾“å…¥ç›¸åŒã€‚</li><li><strong>Full Padding:</strong> å°½å¯èƒ½å¤šåœ°æ·»åŠ å¡«å……ï¼Œä½¿å¾—å·ç§¯æ ¸çš„æ¯ä¸ªå…ƒç´ éƒ½è‡³å°‘åœ¨è¾“å…¥å›¾åƒä¸Šæ»‘åŠ¨ä¸€æ¬¡ã€‚è¾“å‡ºå°ºå¯¸ä¼šå¢å¤§ã€‚</li></ul><p>**Paddingçš„é€‰æ‹©ï¼š**å–å†³äºå…·ä½“çš„åº”ç”¨åœºæ™¯å’Œç½‘ç»œæ¶æ„</p><ul><li><strong>Valid Padding:</strong> é€‚ç”¨äºä¸éœ€è¦ä¿æŒè¾“å‡ºå°ºå¯¸çš„åœºæ™¯ï¼Œæˆ–è€…è¾“å…¥å›¾åƒè¶³å¤Ÿå¤§ï¼Œè¾¹ç¼˜ä¿¡æ¯ä¸¢å¤±ä¸é‡è¦çš„æƒ…å†µã€‚</li><li><strong>Same Padding:</strong> å¹¿æ³›åº”ç”¨äºå„ç§CNNæ¶æ„ä¸­ï¼Œå› ä¸ºå®ƒå¯ä»¥ä¿æŒç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œæ–¹ä¾¿ç½‘ç»œè®¾è®¡å’Œè®¡ç®—ã€‚</li><li><strong>Full Padding:</strong> è¾ƒå°‘ä½¿ç”¨ï¼Œå› ä¸ºå®ƒä¼šå¢åŠ è®¡ç®—é‡ï¼Œå¹¶ä¸”å¯èƒ½ä¼šåœ¨è¾¹ç¼˜å¼•å…¥ä¸€äº›ä¼ªå½±ã€‚</li></ul><img src="assets/05.png" style="zoom:50%;"><img src="assets/1663574693963.png" style="zoom:50%;"><h3 id="stride-æ­¥é•¿" tabindex="-1"><a class="header-anchor" href="#stride-æ­¥é•¿"><span>Strideï¼ˆæ­¥é•¿ï¼‰</span></a></h3><p>Strideï¼ˆæ­¥é•¿ï¼‰æŒ‡çš„æ˜¯<strong>å·ç§¯æ ¸åœ¨å›¾åƒä¸Šæ»‘åŠ¨æ—¶çš„æ­¥ä¼å¤§å°</strong>ï¼Œå³æ¯æ¬¡å·ç§¯æ—¶å·ç§¯æ ¸åœ¨å›¾åƒä¸­å‘å³ï¼ˆæˆ–å‘ä¸‹ï¼‰ç§»åŠ¨çš„åƒç´ æ•°ã€‚æ­¥é•¿ç›´æ¥å½±å“å·ç§¯æ“ä½œåè¾“å‡ºç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œä»¥åŠè®¡ç®—é‡å’Œæ¨¡å‹çš„ç‰¹å¾æå–èƒ½åŠ›ã€‚</p><p><strong>Strideçš„ä½œç”¨:</strong></p><ul><li>**é™ä½è®¡ç®—å¤æ‚åº¦ï¼š**æ›´å¤§çš„æ­¥é•¿æ„å‘³ç€å·ç§¯æ ¸ç§»åŠ¨çš„æ¬¡æ•°æ›´å°‘ï¼Œä»è€Œå‡å°‘äº†è®¡ç®—é‡ï¼Œå¹¶åŠ å¿«äº†è®­ç»ƒå’Œæ¨ç†é€Ÿåº¦ã€‚</li><li>**å‡1é•¿è¶Šå¤§ï¼Œç”Ÿæˆçš„ç‰¹å¾å›¾å°ºå¯¸è¶Šå°ã€‚è¿™ç±»ä¼¼äºæ± åŒ–çš„é™ç»´æ•ˆæœã€‚</li><li>**å¢å¤§æ„Ÿå—é‡ï¼š**è™½ç„¶æ›´å¤§çš„æ­¥é•¿ä¼šå‡å°ç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œä½†å®ƒåŒæ—¶ä¹Ÿä¼šå¢å¤§æ¯ä¸ªç¥ç»å…ƒåœ¨è¾“å…¥æ•°æ®ä¸Šçš„æ„Ÿå—é‡ã€‚è¿™æ„å‘³ç€æ¯ä¸ªç¥ç»å…ƒèƒ½å¤Ÿæ•æ‰åˆ°æ›´å¤§èŒƒå›´çš„è¾“å…¥ä¿¡æ¯ã€‚</li></ul><p>**Strideçš„é€‰æ‹©ï¼š**å–å†³äºå…·ä½“çš„åº”ç”¨åœºæ™¯å’Œç½‘ç»œæ¶æ„</p><ul><li><strong>Stride = 1:</strong> è¿™æ˜¯æœ€å¸¸è§çš„è®¾ç½®ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œçš„æ—©æœŸå±‚ã€‚å®ƒå…è®¸ä¿ç•™æ›´å¤šçš„ç©ºé—´ç»†èŠ‚ã€‚</li><li><strong>Stride &gt; 1:</strong> é€šå¸¸ç”¨äºå‡å°ç‰¹å¾å›¾çš„å°ºå¯¸å’Œå¢å¤§æ„Ÿå—é‡ï¼Œä¾‹å¦‚åœ¨ç½‘ç»œçš„åæœŸå±‚æˆ–éœ€è¦è¿›è¡Œå¿«é€Ÿé™ç»´æ—¶ã€‚ å¸¸è§çš„è®¾ç½®åŒ…æ‹¬ stride=2 æˆ– stride=4ã€‚</li></ul><p>æŒ‰ç…§æ­¥é•¿ä¸º1æ¥ç§»åŠ¨å·ç§¯æ ¸ï¼Œè®¡ç®—ç‰¹å¾å›¾å¦‚ä¸‹æ‰€ç¤ºï¼š</p><img src="assets/06.png" style="zoom:50%;"><p>å¦‚æœæŠŠStrideå¢å¤§ä¸º2ï¼Œä¹Ÿæ˜¯å¯ä»¥æå–ç‰¹å¾å›¾çš„ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="assets/07.png" style="zoom:50%;"><h3 id="å¤šé€šé“å·ç§¯è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#å¤šé€šé“å·ç§¯è®¡ç®—"><span>å¤šé€šé“å·ç§¯è®¡ç®—</span></a></h3><p>å®é™…ä¸­çš„å›¾åƒéƒ½æ˜¯å¤šä¸ªé€šé“ç»„æˆçš„ï¼Œæˆ‘ä»¬æ€ä¹ˆè®¡ç®—å·ç§¯å‘¢ï¼Ÿ</p><img src="assets/08.png" style="zoom:50%;"><p>è®¡ç®—æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li>å½“è¾“å…¥æœ‰å¤šä¸ªé€šé“(Channel), ä¾‹å¦‚ RGB ä¸‰ä¸ªé€šé“, æ­¤æ—¶è¦æ±‚å·ç§¯æ ¸éœ€è¦æ‹¥æœ‰ç›¸åŒçš„é€šé“æ•°ï¼ˆå›¾åƒæœ‰å¤šå°‘é€šé“ï¼Œæ¯ä¸ªå·ç§¯æ ¸å°±æœ‰å¤šå°‘é€šé“ï¼‰.</li><li>æ¯ä¸ªå·ç§¯æ ¸é€šé“ä¸å¯¹åº”çš„è¾“å…¥å›¾åƒçš„å„ä¸ªé€šé“è¿›è¡Œå·ç§¯.</li><li>å°†æ¯ä¸ªé€šé“çš„å·ç§¯ç»“æœæŒ‰ä½ç›¸åŠ å¾—åˆ°æœ€ç»ˆçš„ç‰¹å¾å›¾.</li></ol><p>å¦‚ä¸‹å›¾æ‰€ç¤º:</p><img src="assets/1734662691092.png" style="zoom:50%;"><h3 id="å¤šå·ç§¯æ ¸å·ç§¯è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#å¤šå·ç§¯æ ¸å·ç§¯è®¡ç®—"><span>å¤šå·ç§¯æ ¸å·ç§¯è®¡ç®—</span></a></h3><p>ä¸Šé¢çš„ä¾‹å­é‡Œæˆ‘ä»¬åªä½¿ç”¨ä¸€ä¸ªå·ç§¯æ ¸è¿›è¡Œç‰¹å¾æå–, å®é™…å¯¹å›¾åƒè¿›è¡Œç‰¹å¾æå–æ—¶, æˆ‘ä»¬éœ€è¦ä½¿ç”¨å¤šä¸ªå·ç§¯æ ¸è¿›è¡Œç‰¹å¾æå–. è¿™ä¸ªå¤šä¸ªå·ç§¯æ ¸å¯ä»¥ç†è§£ä¸ºä»ä¸åŒåˆ°çš„è§†è§’ã€ä¸åŒçš„è§’åº¦å¯¹å›¾åƒç‰¹å¾è¿›è¡Œæå–.</p><p>é‚£ä¹ˆ, å½“ä½¿ç”¨å¤šä¸ªå·ç§¯æ ¸æ—¶, åº”è¯¥æ€ä¹ˆè¿›è¡Œç‰¹å¾æå–å‘¢?</p><img src="assets/10.png" style="zoom:50%;"><p>é€šè¿‡ä»¥ä¸‹ä¾‹å­æŸ¥çœ‹å¤šå·ç§¯æ ¸å·ç§¯è®¡ç®—æµç¨‹:</p><img src="assets/20160707204048899" style="zoom:75%;"><p>å¯ä»¥çœ‹åˆ°ï¼š</p><ul><li>ä¸¤ä¸ªç¥ç»å…ƒï¼Œæ„å‘³ç€æœ‰ä¸¤ä¸ªæ»¤æ³¢å™¨</li><li>æ•°æ®çª—å£æ¯æ¬¡ç§»åŠ¨ä¸¤ä¸ªæ­¥é•¿å–3*3çš„å±€éƒ¨æ•°æ®ï¼Œå³stride=2</li><li>zero-padding=1ã€‚è¾“å…¥æ•°æ®ç”±<code>5*5*3</code>å˜ä¸º<code>7*7*3</code></li><li>å·¦è¾¹æ˜¯è¾“å…¥ï¼ˆ<strong>7*7*3</strong>ä¸­ï¼Œ7*7ä»£è¡¨å›¾åƒçš„åƒç´ /é•¿å®½ï¼Œ3ä»£è¡¨Rã€Gã€B ä¸‰ä¸ªé¢œè‰²é€šé“ï¼‰</li><li>ä¸­é—´éƒ¨åˆ†æ˜¯ä¸¤ä¸ªä¸åŒçš„æ»¤æ³¢å™¨Filter w0ã€Filter w1</li><li>æœ€å³è¾¹åˆ™æ˜¯ä¸¤ä¸ªä¸åŒçš„è¾“å‡º</li></ul><h3 id="ç‰¹å¾å›¾å¤§å°" tabindex="-1"><a class="header-anchor" href="#ç‰¹å¾å›¾å¤§å°"><span>ç‰¹å¾å›¾å¤§å°</span></a></h3><p>è¾“å‡ºç‰¹å¾å›¾çš„å¤§å°ä¸ä»¥ä¸‹å‚æ•°æ¯æ¯ç›¸å…³:</p><ol><li>size: å·ç§¯æ ¸/è¿‡æ»¤å™¨å¤§å°ï¼Œä¸€èˆ¬ä¼šé€‰æ‹©ä¸ºå¥‡æ•°ï¼Œæ¯”å¦‚æœ‰ <code>1*1</code>, <code>3*3</code>ï¼Œ <code>5*5</code></li><li>Padding: é›¶å¡«å……çš„æ–¹å¼</li><li>Stride: æ­¥é•¿</li></ol><p>é‚£è®¡ç®—æ–¹æ³•å¦‚ä¸‹å›¾æ‰€ç¤º:</p><ol><li>è¾“å…¥å›¾åƒå¤§å°: W x W</li><li>å·ç§¯æ ¸å¤§å°: F x F</li><li>Strideæ­¥é•¿: S</li><li>Paddingå¡«å……: P</li><li>è¾“å‡ºå›¾åƒå¤§å°: N x N</li></ol><img src="assets/11.png"><p>ä»¥ä¸‹å›¾ä¸ºä¾‹:</p><ol><li>å›¾åƒå¤§å°: 5 x 5</li><li>å·ç§¯æ ¸å¤§å°: 3 x 3</li><li>Stride: 1</li><li>Padding: 1</li><li>(5 - 3 + 2) / 1 + 1 = 5ï¼ˆå¦‚æœé™¤ä¸å°½å‘ä¸‹å–æ•´ï¼‰, å³å¾—åˆ°çš„ç‰¹å¾å›¾å¤§å°ä¸º: 5 x 5</li></ol><img src="assets/05.png" style="zoom:75%;"><h3 id="pytorchå·ç§¯å±‚api" tabindex="-1"><a class="header-anchor" href="#pytorchå·ç§¯å±‚api"><span>PyTorchå·ç§¯å±‚API</span></a></h3><p>åœ¨PyTorchä¸­è¿›è¡Œå·ç§¯çš„APIæ˜¯ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">conv </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Conv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(in_channels, out_channels, kernel_size, stride, padding)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">å‚æ•°è¯´æ˜ï¼š</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">in_channels: è¾“å…¥é€šé“æ•°ï¼ŒRGBå›¾ç‰‡ä¸€èˆ¬æ˜¯3</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">out_channels: è¾“å‡ºé€šé“ï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºå·ç§¯æ ¸kernelçš„æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">kernel_sizeï¼šå·ç§¯æ ¸çš„é«˜å’Œå®½è®¾ç½®ï¼Œä¸€èˆ¬ä¸º3,5,7...</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">strideï¼šå·ç§¯æ ¸ç§»åŠ¨çš„æ­¥é•¿</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	æ•´æ•°strideï¼šè¡¨ç¤ºåœ¨æ‰€æœ‰ç»´åº¦ä¸Šä½¿ç”¨ç›¸åŒçš„æ­¥é•¿ stride=2 è¡¨ç¤ºåœ¨æ°´å¹³å’Œå‚ç›´æ–¹å‘ä¸Šæ¯æ¬¡ç§»åŠ¨2ä¸ªåƒç´ </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	å…ƒç»„stride: å…è®¸åœ¨ä¸åŒç»´åº¦ä¸Šè®¾ç½®ä¸åŒçš„æ­¥é•¿ stride=(2, 1) è¡¨ç¤ºåœ¨æ°´å¹³æ–¹å‘ä¸Šæ­¥é•¿ä¸º2ï¼Œåœ¨å‚ç›´æ–¹å‘ä¸Šæ­¥é•¿ä¸º1</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">paddingï¼šåœ¨å››å‘¨åŠ å…¥paddingçš„æ•°é‡ï¼Œé»˜è®¤è¡¥0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	padding=0ï¼šä¸è¿›è¡Œå¡«å……ã€‚</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	padding=1ï¼šåœ¨æ¯ä¸ªç»´åº¦ä¸Šå¡«å…… 1 ä¸ªåƒç´ ï¼ˆå¸¸ç”¨äºä¿æŒè¾“å‡ºå°ºå¯¸ä¸è¾“å…¥ç›¸åŒ padding=è¾“å…¥å½¢çŠ¶å¤§å°-è¾“å‡ºå½¢çŠ¶å¤§å°ï¼‰ã€‚</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	padding=&#39;same&#39;ï¼ˆä» PyTorch 1.9+ å¼€å§‹æ”¯æŒï¼‰ï¼šè®©è¾“å‡ºç‰¹å¾å›¾çš„å°ºå¯¸ä¸è¾“å…¥ä¿æŒä¸€è‡´ã€‚PyTorchä¼šè‡ªåŠ¨è®¡ç®—éœ€è¦çš„å¡«å……é‡ã€‚strideå¿…é¡»ç­‰äº1ï¼Œä¸æ”¯æŒè·¨è¡Œï¼Œå› ä¸ºè®¡ç®—paddingæ—¶å¯èƒ½å‡ºç°å°æ•°</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">	padding=kernel_size-1ï¼šFull Padding å®Œå…¨å¡«å……</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æˆ‘ä»¬æ¥ä¸‹æ¥å¯¹ä¸‹é¢çš„å›¾ç‰‡è¿›è¡Œç‰¹å¾æå–:</p><img src="assets/12.png" style="zoom:50%;"><p>ä¸‹é¢æ¼”ç¤ºå¤šé€šé“å¤šå·ç§¯æ ¸å·ç§¯:</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> matplotlib.pyplot </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> plt</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¯¹å›¾åƒè¿›è¡Œå·ç§¯</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1 è¯»å–å›¾åƒ æ˜¾ç¤ºå›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2 å®šä¹‰å·ç§¯å±‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 3 å˜æ¢æ•°æ®å½¢çŠ¶ 1-è½¬æˆtensor 2-é€šé“è¦æ±‚[C H W] 3-æ‰¹æ¬¡æ•°è¦æ±‚ [batch, C, H, W]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 4 ç»™å·ç§¯å±‚å–‚æ•°æ® [1, 3, 640, 640] ---&gt; [1, 4, 319, 319])</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># (H-F+2p)/s +1 = (640-3+0)/2 + 1 = 319.5å‘ä¸‹å–æ•´319</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test01</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 1 è¯»å–å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;./data/img.jpg&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;img.shape&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 2 å®šä¹‰å·ç§¯å±‚</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    myconv2d </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Conv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">in_channels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">out_channels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">padding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;myconv2d---&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, myconv2d)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 3 å˜æ¢æ•°æ®å½¢çŠ¶ </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# â‘ è½¬æ¢æˆtensor</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # â‘¡é€šé“è¦æ±‚[C, H, W], é»˜è®¤[H, W, C]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # â‘¢æ‰¹æ¬¡æ•°è¦æ±‚[batch, C, H, W],å¤šå°‘ä¸ªå›¾åƒ(ä¸€ä¸ªå›¾åƒæ˜¯ä¸‰ç»´æ•°ç»„,å››ç»´æœ‰å¤šå°‘ä¸ªä¸‰ç»´å°±æ˜¯å¤šå°‘ä¸ªå›¾åƒ)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # [0, 1, 2] --&gt; [2, 0, 1]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">permute</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;img2.shape---&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img2.shape)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# å›¾åƒæ•°ä¸º1,å˜ä¸º4ç»´å¼ é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img3 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> img2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">unsqueeze</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;img3.shape---&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img3.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 4 ç»™å·ç§¯å±‚å–‚æ•°æ® [1, 3, 640, 640] ---&gt; [1, 4, 319, 319])</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # (H-F+2p)/s + 1 = (640-3+0)/2 + 1 = 319.5å‘ä¸‹å–æ•´319</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img4 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> myconv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img3.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(torch.float32))</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;img4--&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img4.shape)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    test01</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœ:</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">img.shape</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">---&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">myconv2d</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">---&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> Conv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">img2.shape</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">---&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">img3.shape</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">---&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">640</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">img4</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">--</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">319</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">319</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¯¹ç”Ÿæˆçš„ç‰¹å¾å›¾è¿›è¡Œæ˜¾ç¤º:</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¯¹å›¾åƒå·ç§¯ å¹¶æ˜¾ç¤ºå·ç§¯ä»¥åçš„ç‰¹å¾å›¾</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ€è·¯ï¼šå»æ‰æ‰¹æ¬¡æ•° -&gt; è½¬æˆ[HWC] --&gt;æŒ‰ç…§é€šé“æ‹¿æ•°æ®[:,:,0123]</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test02</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 1 è¯»å–å›¾åƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;./data/img.jpg&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;img.shape&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 2 å®šä¹‰å·ç§¯å±‚</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    myconv2d </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Conv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">in_channels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">out_channels</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">padding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;myconv2d---&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, myconv2d)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 3 å˜æ¢æ•°æ®å½¢çŠ¶ 1-è½¬æˆtensor 2-é€šé“è¦æ±‚[C H W] 3-æ‰¹æ¬¡æ•°è¦æ±‚ [batch, C, H, W]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # [0, 1, 2] --&gt; [2, 0, 1]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">permute</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;img2.shape---&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img2.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img3 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> img2.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">unsqueeze</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;img3.shape---&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img3.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 4 ç»™å·ç§¯å±‚å–‚æ•°æ® [1, 3, 640, 640] ---&gt; [1, 4, 319, 319])</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # (H-F+2p)/s +1 = (640-3+0)/2 + 1 = 319.5å‘ä¸‹å–æ•´319</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img4 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> myconv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(img3.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">type</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(torch.float32))</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;img4--&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img4.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # 5 æŸ¥çœ‹ç‰¹å¾å›¾æ€è·¯ï¼šå»æ‰æ‰¹æ¬¡æ•° -&gt; è½¬æˆ[HWC] --&gt;æŒ‰ç…§é€šé“æ‹¿æ•°æ®[:,:,0123]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img5 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> img4[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">] </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å»æ‰æ‰¹æ¬¡æ•°</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å»æ‰æ‰¹æ¬¡æ•°img5.shape--&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img5.shape)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    img6 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> img5.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">permute</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;å»æ‰æ‰¹æ¬¡æ•°ä»¥åï¼Œå†è¿›è¡ŒHWC img6.shape--&gt;&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, img6.shape)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    feature1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> img6[:, :, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">detach</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    feature2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> img6[:, :, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">detach</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    feature3 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> img6[:, :, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">detach</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    feature4 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> img6[:, :, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">].</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">detach</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">numpy</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(feature1)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(feature2)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(feature3)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(feature4)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    test02</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>ç”Ÿæˆç‰¹å¾å›¾æ˜¾ç¤º:</strong></p><figure><img src="/assets/img/image-20220706160149097.16555640.png" alt="image-20220706160149097" tabindex="0" loading="lazy"><figcaption>image-20220706160149097</figcaption></figure><h2 id="æ± åŒ–å±‚" tabindex="-1"><a class="header-anchor" href="#æ± åŒ–å±‚"><span>æ± åŒ–å±‚</span></a></h2><blockquote><p>æ± åŒ–å±‚ï¼ˆPooling Layerï¼‰æ˜¯ç”¨äºé™ä½è¾“å…¥æ•°æ®çš„ç©ºé—´ç»´åº¦ï¼ˆä¾‹å¦‚å›¾åƒçš„é«˜åº¦å’Œå®½åº¦ï¼‰ï¼Œä»è€Œå‡å°‘è®¡ç®—é‡ã€å‡å°‘å†…å­˜æ¶ˆè€—ï¼Œå¹¶æé«˜æ¨¡å‹çš„é²æ£’æ€§ã€‚</p><p>æ± åŒ–å±‚é€šå¸¸ä½äºå·ç§¯å±‚ä¹‹åï¼Œå®ƒé€šè¿‡å¯¹å·ç§¯å±‚è¾“å‡ºçš„ç‰¹å¾å›¾è¿›è¡Œä¸‹é‡‡æ ·ï¼Œä¿ç•™æœ€é‡è¦çš„ç‰¹å¾ä¿¡æ¯ï¼ŒåŒæ—¶ä¸¢å¼ƒä¸€äº›ä¸é‡è¦çš„ç»†èŠ‚ã€‚</p><p><strong>æ± åŒ–å±‚çš„ä¸»è¦ä½œç”¨å¦‚ä¸‹:</strong></p><ul><li><p><strong>é™ç»´å’Œè®¡ç®—é‡å‡å°‘</strong>ï¼šæ± åŒ–å±‚é€šè¿‡å‡å°‘ç‰¹å¾å›¾çš„å°ºå¯¸ï¼Œä»è€Œé™ä½äº†è®¡ç®—é‡ï¼Œç‰¹åˆ«æ˜¯åœ¨å¤šå±‚ç½‘ç»œä¸­ï¼Œéšç€å±‚æ•°çš„å¢åŠ ï¼Œæ± åŒ–èƒ½å¤Ÿæ˜¾è‘—å‡å°‘è®¡ç®—èµ„æºçš„æ¶ˆè€—ã€‚</p></li><li><p><strong>æé«˜é²æ£’æ€§</strong>ï¼šæ± åŒ–æ“ä½œå¯ä»¥ä½¿å¾—ç‰¹å¾å¯¹å°çš„å˜æ¢ã€å¹³ç§»å’Œæ—‹è½¬å˜å¾—æ›´åŠ ä¸æ•æ„Ÿã€‚è¿™æ ·ï¼Œæ¨¡å‹åœ¨é¢å¯¹å™ªå£°æˆ–å›¾åƒçš„è½»å¾®å˜åŒ–æ—¶ï¼Œä¾ç„¶èƒ½å¤Ÿç¨³å®šå·¥ä½œã€‚</p></li><li><p><strong>é˜²æ­¢è¿‡æ‹Ÿåˆ</strong>ï¼šé€šè¿‡æ± åŒ–å‡å°‘äº†ç‰¹å¾å›¾çš„å¤§å°ï¼Œå‡å°‘äº†æ¨¡å‹çš„å¤æ‚åº¦ï¼Œä»è€Œæœ‰åŠ©äºé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œå°¤å…¶æ˜¯åœ¨è¾ƒå°çš„æ•°æ®é›†ä¸Šã€‚</p></li><li><p><strong>æŠ½è±¡ç‰¹å¾</strong>ï¼šé€šè¿‡æ± åŒ–å±‚çš„æ“ä½œï¼Œå¯ä»¥æå–æ›´ä¸ºæŠ½è±¡å’Œé«˜å±‚æ¬¡çš„ç‰¹å¾ï¼Œä½¿å¾—ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ åˆ°æ›´å…·æ³›åŒ–èƒ½åŠ›çš„è¡¨ç¤ºã€‚</p></li></ul></blockquote><h3 id="æ± åŒ–å±‚è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#æ± åŒ–å±‚è®¡ç®—"><span>æ± åŒ–å±‚è®¡ç®—</span></a></h3><ul><li><p>æœ€å¤§æ± åŒ–(Max Pooling) ï¼šé€šè¿‡æ± åŒ–çª—å£è¿›è¡Œæœ€å¤§æ± åŒ–ï¼Œ<strong>å–çª—å£ä¸­çš„æœ€å¤§å€¼ä½œä¸ºè¾“å‡º</strong></p><img src="assets/1663589028409.png" style="zoom:50%;"></li><li><p>å¹³å‡æ± åŒ–(Avg Pooling) ï¼š<strong>å–çª—å£å†…çš„æ‰€æœ‰å€¼çš„å‡å€¼ä½œä¸ºè¾“å‡º</strong></p><img src="assets/1663589040380.png" style="zoom:50%;"></li></ul><h3 id="padding-å¡«å……-1" tabindex="-1"><a class="header-anchor" href="#padding-å¡«å……-1"><span>Paddingï¼ˆå¡«å……ï¼‰</span></a></h3><img src="assets/1734674337777.png" style="zoom:75%;"><h3 id="stride-æ­¥é•¿-1" tabindex="-1"><a class="header-anchor" href="#stride-æ­¥é•¿-1"><span>Strideï¼ˆæ­¥é•¿ï¼‰</span></a></h3><img src="assets/1734674385856.png" style="zoom:75%;"><h3 id="å¤šé€šé“æ± åŒ–è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#å¤šé€šé“æ± åŒ–è®¡ç®—"><span>å¤šé€šé“æ± åŒ–è®¡ç®—</span></a></h3><p>åœ¨å¤„ç†å¤šé€šé“è¾“å…¥æ•°æ®æ—¶ï¼Œæ± åŒ–å±‚å¯¹æ¯ä¸ªè¾“å…¥é€šé“åˆ†åˆ«æ± åŒ–ï¼Œè€Œä¸æ˜¯åƒå·ç§¯å±‚é‚£æ ·å°†å„ä¸ªé€šé“çš„è¾“å…¥ç›¸åŠ ã€‚è¿™æ„å‘³ç€<mark>æ± åŒ–å±‚çš„è¾“å‡ºå’Œè¾“å…¥çš„é€šé“æ•°æ˜¯ç›¸ç­‰ã€‚</mark></p><p><strong>æ± åŒ–åªåœ¨å®½é«˜ç»´åº¦ä¸Šæ± åŒ–</strong>ï¼Œ<strong>åœ¨é€šé“ä¸Šæ˜¯ä¸å‘ç”Ÿæ± åŒ–</strong>ï¼ˆæ± åŒ–å‰åï¼Œå¤šå°‘ä¸ªé€šé“è¿˜æ˜¯å¤šå°‘ä¸ªé€šé“ï¼‰</p><img src="assets/1734674742627.png" style="zoom:75%;"><h3 id="pytorchæ± åŒ–å±‚api" tabindex="-1"><a class="header-anchor" href="#pytorchæ± åŒ–å±‚api"><span>PyTorchæ± åŒ–å±‚API</span></a></h3><p>åœ¨PyTorchä¸­è¿›è¡Œæ± åŒ–çš„APIæ˜¯ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æœ€å¤§æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">MaxPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">padding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¹³å‡æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">AvgPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">padding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">å‚æ•°è¯´æ˜ï¼š</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">kernel_sizeï¼šæ ¸çš„é«˜å’Œå®½è®¾ç½®ï¼Œä¸€èˆ¬ä¸º3,5,7...</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">strideï¼šæ ¸ç§»åŠ¨çš„æ­¥é•¿</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">paddingï¼šåœ¨å››å‘¨åŠ å…¥paddingçš„æ•°é‡ï¼Œé»˜è®¤è¡¥0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;&quot;&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p>å•é€šé“æ± åŒ–</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. å•é€šé“æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å®šä¹‰è¾“å…¥æ•°æ® [1,3,3]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">inputs </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([[[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]]], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">dtype</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">torch.float)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ä¿®æ”¹strideï¼Œpaddingè§‚å¯Ÿæ•ˆæœ</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. æœ€å¤§æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pooling </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">MaxPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">padding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">output </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> pooling</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(inputs)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;æœ€å¤§æ± åŒ–ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, output)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. å¹³å‡æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pooling </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">AvgPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">padding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">output </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> pooling</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(inputs)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å¹³å‡æ± åŒ–ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, output)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœ:</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æœ€å¤§æ± åŒ–ï¼š</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([[[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">., </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">., </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.]]])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å¹³å‡æ± åŒ–ï¼š</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([[[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">., </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">., </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.]]])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å¤šé€šé“æ± åŒ–</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 2. å¤šé€šé“æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å®šä¹‰è¾“å…¥æ•°æ® [3,3,3]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">inputs </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([[[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                       [[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">20</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">40</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">60</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">70</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">                       [[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">11</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">22</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">33</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">44</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">55</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">], [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">77</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">88</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">99</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">]]], </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">dtype</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">torch.float)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æœ€å¤§æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">pooling </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">MaxPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">padding</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">output </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> pooling</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(inputs)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;å¤šé€šé“æ± åŒ–ï¼š</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">\n</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, output)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœ:</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">å¤šé€šé“æ± åŒ–ï¼š</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> tensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">([[[ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         [ </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.,  </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.]],</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        [[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">., </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">60</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">80</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">., </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.]],</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        [[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">55</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">., </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">66</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.],</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">         [</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">88</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">., </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">99</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.]]])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="å›¾åƒåˆ†ç±»æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#å›¾åƒåˆ†ç±»æ¡ˆä¾‹"><span>å›¾åƒåˆ†ç±»æ¡ˆä¾‹</span></a></h2><blockquote><p>å’±ä»¬ä½¿ç”¨å‰é¢å­¦ä¹ åˆ°çš„çŸ¥è¯†æ¥æ„å»ºä¸€ä¸ªå·ç§¯ç¥ç»ç½‘ç»œ, å¹¶è®­ç»ƒè¯¥ç½‘ç»œå®ç°å›¾åƒåˆ†ç±»ã€‚è¦å®Œæˆè¿™ä¸ªæ¡ˆä¾‹ï¼Œå’±ä»¬éœ€è¦å­¦ä¹ çš„å†…å®¹å¦‚ä¸‹: äº†è§£ CIFAR10 æ•°æ®é›† æ­å»ºå·ç§¯ç¥ç»ç½‘ç»œ ç¼–å†™è®­ç»ƒå‡½æ•° ç¼–å†™é¢„æµ‹å‡½æ•°</p></blockquote><p>å¯¼å…¥å·¥å…·åŒ…</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.nn </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torchvision.datasets </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;"> CIFAR10</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torchvision.transforms </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ToTensor  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># pip install torchvision -i https://mirrors.aliyun.com/pypi/simple/</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.optim </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> optim</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.utils.data </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> DataLoader</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> matplotlib.pyplot </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">as</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> plt</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">from</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torchsummary </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">import</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> summary</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¯æ‰¹æ¬¡æ ·æœ¬æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">BATCH_SIZE</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 8</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="cifar10-æ•°æ®é›†" tabindex="-1"><a class="header-anchor" href="#cifar10-æ•°æ®é›†"><span>CIFAR10 æ•°æ®é›†</span></a></h3><p>CIFAR-10æ•°æ®é›†5ä¸‡å¼ è®­ç»ƒå›¾åƒã€1ä¸‡å¼ æµ‹è¯•å›¾åƒã€10ä¸ªç±»åˆ«ã€æ¯ä¸ªç±»åˆ«æœ‰6kä¸ªå›¾åƒï¼Œå›¾åƒå¤§å°32Ã—32Ã—3ã€‚ä¸‹å›¾åˆ—ä¸¾äº†10ä¸ªç±»ï¼Œæ¯ä¸€ç±»éšæœºå±•ç¤ºäº†10å¼ å›¾ç‰‡ï¼š</p><img src="assets/1663596223425.png" style="zoom:50%;"><p>PyTorch ä¸­çš„ torchvision.datasets è®¡ç®—æœºè§†è§‰æ¨¡å—å°è£…äº† CIFAR10 æ•°æ®é›†, ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹:</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># 1. æ•°æ®é›†åŸºæœ¬ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> create_dataset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">():</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # åŠ è½½æ•°æ®é›†:è®­ç»ƒé›†æ•°æ®å’Œæµ‹è¯•æ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # ToTensor: å°†imageï¼ˆä¸€ä¸ªPIL.Imageå¯¹è±¡ï¼‰è½¬æ¢ä¸ºä¸€ä¸ªTensor</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    train </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> CIFAR10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;data&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">train</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">transform</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">ToTensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    valid </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> CIFAR10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">root</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;data&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">train</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">transform</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">ToTensor</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">())</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è¿”å›æ•°æ®é›†ç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> train, valid</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ•°æ®é›†åŠ è½½</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    train_dataset, valid_dataset </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> create_dataset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ•°æ®é›†ç±»åˆ«</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;æ•°æ®é›†ç±»åˆ«:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, train_dataset.class_to_idx)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ•°æ®é›†ä¸­çš„å›¾åƒæ•°æ®</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;è®­ç»ƒé›†æ•°æ®é›†:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, train_dataset.data.shape)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;æµ‹è¯•é›†æ•°æ®é›†:&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, valid_dataset.data.shape)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å›¾åƒå±•ç¤º</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">figure</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">figsize</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">imshow</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(train_dataset.data[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">title</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(train_dataset.targets[</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">])</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    plt.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">show</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æ•°æ®é›†ç±»åˆ«: {</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;airplane&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;automobile&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;bird&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;cat&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;deer&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;dog&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;frog&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;horse&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">7</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;ship&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">8</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;truck&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">9</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">} </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">è®­ç»ƒé›†æ•°æ®é›†: (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">50000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">æµ‹è¯•é›†æ•°æ®é›†: (</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10000</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="assets/1734675588681.png" style="zoom:50%;"><h3 id="æ­å»ºå›¾åƒåˆ†ç±»ç½‘ç»œ" tabindex="-1"><a class="header-anchor" href="#æ­å»ºå›¾åƒåˆ†ç±»ç½‘ç»œ"><span>æ­å»ºå›¾åƒåˆ†ç±»ç½‘ç»œ</span></a></h3><p>æ­å»ºçš„CNNç½‘ç»œç»“æ„å¦‚ä¸‹:</p><img src="assets/1663596553400.png" style="zoom:75%;"><p>æˆ‘ä»¬è¦æ­å»ºçš„ç½‘ç»œç»“æ„å¦‚ä¸‹:</p><ol><li>è¾“å…¥å½¢çŠ¶: 32x32</li><li>ç¬¬ä¸€ä¸ªå·ç§¯å±‚è¾“å…¥ 3 ä¸ª Channel, è¾“å‡º 6 ä¸ª Channel, Kernel Size ä¸º: 3x3</li><li>ç¬¬ä¸€ä¸ªæ± åŒ–å±‚è¾“å…¥ 30x30, è¾“å‡º 15x15, Kernel Size ä¸º: 2x2, Stride ä¸º: 2</li><li>ç¬¬äºŒä¸ªå·ç§¯å±‚è¾“å…¥ 6 ä¸ª Channel, è¾“å‡º 16 ä¸ª Channel, Kernel Size ä¸º 3x3</li><li>ç¬¬äºŒä¸ªæ± åŒ–å±‚è¾“å…¥ 13x13, è¾“å‡º 6x6, Kernel Size ä¸º: 2x2, Stride ä¸º: 2</li><li>ç¬¬ä¸€ä¸ªå…¨è¿æ¥å±‚è¾“å…¥ 576 ç»´, è¾“å‡º 120 ç»´</li><li>ç¬¬äºŒä¸ªå…¨è¿æ¥å±‚è¾“å…¥ 120 ç»´, è¾“å‡º 84 ç»´</li><li>æœ€åçš„è¾“å‡ºå±‚è¾“å…¥ 84 ç»´, è¾“å‡º 10 ç»´</li></ol><p>æˆ‘ä»¬åœ¨æ¯ä¸ªå·ç§¯è®¡ç®—ä¹‹ååº”ç”¨ relu æ¿€æ´»å‡½æ•°æ¥ç»™ç½‘ç»œå¢åŠ éçº¿æ€§å› ç´ ã€‚</p><p><strong>æ„å»ºç½‘ç»œä»£ç å®ç°å¦‚ä¸‹:</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¨¡å‹æ„å»º</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ImageClassification</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">nn</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Module</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # å®šä¹‰ç½‘ç»œç»“æ„</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(ImageClassification, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å®šä¹‰ç½‘ç»œå±‚ï¼šå·ç§¯å±‚+æ± åŒ–å±‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç¬¬ä¸€ä¸ªå·ç§¯å±‚, è¾“å…¥å›¾åƒä¸º3é€šé“,è¾“å‡ºç‰¹å¾å›¾ä¸º6é€šé“,å·ç§¯æ ¸3*3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.conv1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Conv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç¬¬ä¸€ä¸ªæ± åŒ–å±‚, æ ¸å®½é«˜2*2</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.pool1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">MaxPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç¬¬äºŒä¸ªå·ç§¯å±‚, è¾“å…¥å›¾åƒä¸º6é€šé“,è¾“å‡ºç‰¹å¾å›¾ä¸º16é€šé“,å·ç§¯æ ¸3*3</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.conv2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Conv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">16</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç¬¬äºŒä¸ªæ± åŒ–å±‚, æ ¸å®½é«˜2*2</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.pool2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">MaxPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å…¨è¿æ¥å±‚</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç¬¬ä¸€ä¸ªéšè—å±‚ è¾“å…¥ç‰¹å¾576ä¸ª(ä¸€å¼ å›¾åƒä¸º16*6*6), è¾“å‡ºç‰¹å¾120ä¸ª</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.linear1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">576</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">120</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç¬¬äºŒä¸ªéšè—å±‚</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.linear2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">120</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">84</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è¾“å‡ºå±‚</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.out </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">84</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        </span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">	# å®šä¹‰å‰å‘ä¼ æ’­</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> forward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> x</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å·ç§¯+relu+æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">relu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">conv1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">pool1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å·ç§¯+relu+æ± åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">relu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">conv2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">pool2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å°†ç‰¹å¾å›¾åšæˆä»¥ä¸ºå‘é‡çš„å½¢å¼ï¼šç›¸å½“äºç‰¹å¾å‘é‡ å…¨è¿æ¥å±‚åªèƒ½æ¥æ”¶äºŒç»´æ•°æ®é›†</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # ç”±äºæœ€åä¸€ä¸ªæ‰¹æ¬¡å¯èƒ½ä¸å¤Ÿ8ï¼Œæ‰€ä»¥éœ€è¦æ ¹æ®æ‰¹æ¬¡æ•°é‡æ¥æ”¹å˜å½¢çŠ¶</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # x[8, 16, 6, 6] --&gt; [8, 576] --&gt;8ä¸ªæ ·æœ¬,576ä¸ªç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # x.size(0): ç¬¬1ä¸ªå€¼æ˜¯æ ·æœ¬æ•° è¡Œæ•°</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # -1ï¼šç¬¬2ä¸ªå€¼ç”±åŸå§‹xå‰©ä½™3ä¸ªç»´åº¦å€¼ç›¸ä¹˜è®¡ç®—å¾—åˆ° åˆ—æ•°(ç‰¹å¾ä¸ªæ•°)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">reshape</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # å…¨è¿æ¥å±‚</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">relu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">linear1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">relu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">linear2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # è¿”å›è¾“å‡ºç»“æœ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ¨¡å‹å®ä¾‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> ImageClassification</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    summary</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(model, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">input_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">batch_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><img src="assets/1734675868165.png" style="zoom:75%;"><h3 id="ç¼–å†™è®­ç»ƒå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™è®­ç»ƒå‡½æ•°"><span>ç¼–å†™è®­ç»ƒå‡½æ•°</span></a></h3><p>åœ¨è®­ç»ƒæ—¶ï¼Œä½¿ç”¨å¤šåˆ†ç±»äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ŒAdam ä¼˜åŒ–å™¨ã€‚å…·ä½“å®ç°ä»£ç å¦‚ä¸‹:</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> train</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> train_dataset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ„å»ºæ•°æ®åŠ è½½å™¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    dataloader </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> DataLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(train_dataset, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">batch_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">BATCH_SIZE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">shuffle</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">True</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    criterion </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">CrossEntropyLoss</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ„å»ºæŸå¤±å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    optimizer </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> optim.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Adam</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">parameters</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">lr</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1e-3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ„å»ºä¼˜åŒ–æ–¹æ³•</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    epoch </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 100</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # è®­ç»ƒè½®æ•°</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> epoch_idx </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> range</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(epoch):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        sum_num </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">   # æ ·æœ¬æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        total_loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0.0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # æŸå¤±æ€»å’Œ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        correct </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  # é¢„æµ‹æ­£ç¡®æ ·æœ¬æ•°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        start </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å¼€å§‹æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">        # éå†æ•°æ®è¿›è¡Œç½‘ç»œè®­ç»ƒ</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x, y </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dataloader:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">train</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¨¡å‹åˆ‡æ¢è®­ç»ƒæ¨¡å¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            output </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x) </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¨¡å‹é¢„æµ‹ yé¢„æµ‹å€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> criterion</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output, y)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¡ç®—æŸå¤±</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            optimizer.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">zero_grad</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># æ¢¯åº¦æ¸…é›¶</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            loss.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">backward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># åå‘ä¼ æ’­</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            optimizer.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">step</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># å‚æ•°æ›´æ–°</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            correct </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">argmax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> y).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># è®¡ç®—é¢„æµ‹æ­£ç¡®æ ·æœ¬æ•°</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">            # è®¡ç®—æ¯æ¬¡è®­ç»ƒæ¨¡å‹çš„æ€»æŸå¤±å€¼ lossæ˜¯æ¯æ‰¹æ ·æœ¬å¹³å‡æŸå¤±å€¼</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            total_loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">item</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">*</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(y)  </span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"># ç»Ÿè®¡æŸå¤±å’Œ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            sum_num </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(y)</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">        print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;epoch:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%2s</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%.5f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%.2f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%.2f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">s&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(epoch_idx </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,total_loss </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sum_num,correct </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> sum_num,time.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">time</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">() </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> start))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ¨¡å‹ä¿å­˜</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">save</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">state_dict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(), </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;model/image_classification.pth&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">            </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ•°æ®é›†åŠ è½½</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    train_dataset, valid_dataset </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> create_dataset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ¨¡å‹å®ä¾‹åŒ–</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> ImageClassification</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ¨¡å‹è®­ç»ƒ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    train</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(model,train_dataset)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.59926</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.41</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">28.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">97s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.32861</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.52</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">29.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">98s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.22957</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.56</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">29.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">44s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">4</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.15541</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.59</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">30.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">45s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1.09832</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.61</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">29.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">69s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">96</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.30592</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.89</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">37.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">28s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">97</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.29255</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">37.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">11s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">98</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.29470</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">36.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">98s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">99</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.29472</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">36.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">79s</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">epoch:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">100</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> loss:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.29903</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> acc:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.90</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> time:</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">37.</span><span style="--shiki-light:white;--shiki-dark:#FFFFFF;">66s</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ç¼–å†™é¢„æµ‹å‡½æ•°" tabindex="-1"><a class="header-anchor" href="#ç¼–å†™é¢„æµ‹å‡½æ•°"><span>ç¼–å†™é¢„æµ‹å‡½æ•°</span></a></h3><p>åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹ï¼Œå¯¹æµ‹è¯•é›†ä¸­çš„1ä¸‡æ¡æ ·æœ¬è¿›è¡Œé¢„æµ‹ï¼ŒæŸ¥çœ‹æ¨¡å‹åœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡ã€‚</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;">valid_dataset</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ„å»ºæ•°æ®åŠ è½½å™¨</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    dataloader </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> DataLoader</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(valid_dataset, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">batch_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#D19A66;">BATCH_SIZE</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">shuffle</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">False</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # åŠ è½½æ¨¡å‹å¹¶åŠ è½½è®­ç»ƒå¥½çš„æƒé‡</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    model </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> ImageClassification</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load_state_dict</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">load</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;model/image_classification.pth&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ¨¡å‹åˆ‡æ¢è¯„ä¼°æ¨¡å¼, å¦‚æœç½‘ç»œæ¨¡å‹ä¸­æœ‰dropout/BNç­‰å±‚, è¯„ä¼°é˜¶æ®µä¸è¿›è¡Œç›¸åº”æ“ä½œ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    model.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">eval</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # è®¡ç®—ç²¾åº¦</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    total_correct </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    total_samples </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 0</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # éå†æ¯ä¸ªbatchçš„æ•°æ®ï¼Œè·å–é¢„æµ‹ç»“æœï¼Œè®¡ç®—ç²¾åº¦</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    for</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x, y </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">in</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> dataloader:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        output </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;"> model</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        total_correct </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">argmax</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(output, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">dim</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">==</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> y).</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">sum</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        total_samples </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+=</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> len</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(y)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">    # æ‰“å°ç²¾åº¦</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    print</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;Acc: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">%.2f</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> %</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (total_correct </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">/</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> total_samples))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">if</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> __name__</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> ==</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &#39;__main__&#39;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">    test</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(valid_dataset)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>è¾“å‡ºç»“æœï¼š</strong></p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Acc: </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.57</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="æ¨¡å‹ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ¨¡å‹ä¼˜åŒ–"><span>æ¨¡å‹ä¼˜åŒ–</span></a></h3><p>CNNç½‘ç»œæ¨¡å‹åœ¨è®­ç»ƒé›†æ ·æœ¬ä¸Šçš„å‡†ç¡®ç‡è¿œè¿œé«˜äºæµ‹è¯•é›†,è¯´æ˜æ¨¡å‹äº§ç”Ÿäº†è¿‡æ‹Ÿåˆé—®é¢˜,æˆ‘ä»¬æŠŠå­¦ä¹ ç‡ç”±1e-3ä¿®æ”¹ä¸º1e-4ã€å¢åŠ ç½‘ç»œå‚æ•°é‡å’Œå¢åŠ dropoutæ­£åˆ™åŒ–</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" data-title="python" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">class</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> ImageClassification</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">nn</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Module</span><span style="--shiki-light:#C18401;--shiki-dark:#ABB2BF;">)</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">:</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	def</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;"> __init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">		super</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(ImageClassification, </span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">).</span><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">__init__</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.conv1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Conv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.pool1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">MaxPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.conv2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Conv2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">32</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">128</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">3</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.pool2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">MaxPool2d</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">kernel_size</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">stride</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.linear1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">128</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> *</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 6</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.linear2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.out </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Linear</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">2048</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">, </span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">10</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# Dropoutå±‚ï¼Œpè¡¨ç¤ºç¥ç»å…ƒè¢«ä¸¢å¼ƒçš„æ¦‚ç‡</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">		self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.dropout </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> nn.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">Dropout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E06C75;--shiki-dark-font-style:italic;">p</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0.5</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">	def</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> forward</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#E5C07B;--shiki-dark-font-style:italic;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">,</span><span style="--shiki-light:#986801;--shiki-light-font-style:inherit;--shiki-dark:#D19A66;--shiki-dark-font-style:italic;"> x</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">):</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">relu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">conv1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">pool1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">relu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">conv2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">pool2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# ç”±äºæœ€åä¸€ä¸ªæ‰¹æ¬¡å¯èƒ½ä¸å¤Ÿ 32ï¼Œæ‰€ä»¥éœ€è¦æ ¹æ®æ‰¹æ¬¡æ•°é‡æ¥ flatten</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> x.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">reshape</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">size</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">0</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">), </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">-</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;">1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">relu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">linear1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# dropoutæ­£åˆ™åŒ–</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">		# è®­ç»ƒé›†å‡†ç¡®ç‡è¿œè¿œé«˜äºæµ‹è¯•å‡†ç¡®ç‡,æ¨¡å‹äº§ç”Ÿäº†è¿‡æ‹Ÿåˆ</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">dropout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> torch.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">relu</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">linear2</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x))</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		x </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">dropout</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">		return</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> self</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#383A42;--shiki-dark:#61AFEF;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(x)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ç»è¿‡è®­ç»ƒï¼Œæ¨¡å‹åœ¨æµ‹è¯•é›†çš„å‡†ç¡®ç‡ç”± 0.57ï¼Œæå‡åˆ°äº† 0.93ï¼ŒåŒå­¦ä»¬ä¹Ÿå¯ä»¥è‡ªå·±ä¿®æ”¹ç›¸åº”çš„ç½‘ç»œç»“æ„ã€è®­ç»ƒå‚æ•°ç­‰æ¥æå‡æ¨¡å‹çš„æ€§èƒ½ã€‚</p></div><!----><footer class="vp-page-meta"><div class="vp-meta-item edit-link"><a class="auto-link external-link vp-meta-label" href="https://github.com/Crc011220/Crc011220.github.io/edit/main/src/zh/posts/deep-learning/å·ç§¯ç¥ç»ç½‘ç»œCNN.md" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" rel="noopener noreferrer" target="_blank"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon" name="edit"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<!----></a></div><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="vp-meta-info" data-allow-mismatch="text">2025/12/16 07:00:21</span></div><div class="contributors"><span class="vp-meta-label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="vp-meta-info" title="email: ruocchen1220@gmail.com">Ruochen Chen</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link auto-link next" href="/zh/posts/deep-learning/%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9CRNN.html" aria-label="å¾ªç¯ç¥ç»ç½‘ç»œRNN"><div class="hint">ä¸‹ä¸€é¡µ<span class="arrow end"></span></div><div class="link">å¾ªç¯ç¥ç»ç½‘ç»œRNN<span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">å­¦æµ·æ— æ¶¯</div><div class="vp-copyright">Copyright Â© 2026 Ruochen Chen </div></footer></div><!--]--><!--[--><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script src="/assets/js/runtime~app.b2311df6.js" defer></script><script src="/assets/js/6312.34f20d6c.js" defer></script><script src="/assets/js/app.d3f091b2.js" defer></script>
  </body>
</html>
